

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>hy 0.13.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  

  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="None" href="index.html#document-index"/> 

  
  <script src="_static/js/modernizr.min.js"></script>


<!-- RTD Extra Head -->

<!-- 
Always link to the latest version, as canonical.
http://docs.readthedocs.org/en/latest/canonical.html
-->
<link rel="canonical" href="http://docs.hylang.org/en/stable/" />

<link rel="stylesheet" href="https://media.readthedocs.org/css/readthedocs-doc-embed.css" type="text/css" />

<script type="text/javascript" src="_static/readthedocs-data.js"></script>

<!-- Add page-specific data, which must exist in the page js, not global -->
<script type="text/javascript">
READTHEDOCS_DATA['page'] = 'index'
</script>

<script type="text/javascript" src="_static/readthedocs-dynamic-include.js"></script>

<!-- end RTD <extrahead> --></head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html#document-index" class="icon icon-home"> hy
          

          
          </a>

          
            
            
            
              <div class="version">
                stable
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
            
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-quickstart">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-tutorial">Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#basic-intro-to-lisp-for-pythonistas">Basic intro to Lisp for Pythonistas</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#hy-is-a-lisp-flavored-python">Hy is a Lisp-flavored Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#macros">Macros</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#hy-python-interop">Hy &lt;-&gt; Python interop</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#using-hy-from-python">Using Hy from Python</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#using-python-from-hy">Using Python from Hy</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#protips">Protips!</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-style-guide">Hy Style Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#prelude">Prelude</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#the-tao-of-hy">The Tao of Hy</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#layout-indentation">Layout &amp; Indentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#coding-style">Coding Style</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#conclusion">Conclusion</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#thanks">Thanks</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-language/index">Documentation Index</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-language/cli">Command Line Interface</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#hy">hy</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#hyc">hyc</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#hy2py">hy2py</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-language/interop">Hy &lt;-&gt; Python interop</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#using-python-from-hy">Using Python from Hy</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#using-hy-from-python">Using Hy from Python</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-language/api">Hy (the language)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#theory-of-hy">Theory of Hy</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#notes-on-syntax">Notes on Syntax</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#built-ins">Built-Ins</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-language/core">Hy Core</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#core-functions">Core Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#sequence-functions">Sequence Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#included-itertools">Included itertools</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-language/internals">Internal Hy Documentation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#hy-models">Hy Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#cons-cells">Cons Cells</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#hy-internal-theory">Hy Internal Theory</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#hy-macros">Hy Macros</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#hy-compiler-built-ins">Hy Compiler Built-Ins</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-extra/index">Extra Modules Index</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-extra/anaphoric">Anaphoric Macros</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#ap-if">ap-if</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#ap-each">ap-each</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#ap-each-while">ap-each-while</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#ap-map">ap-map</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#ap-map-when">ap-map-when</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#ap-filter">ap-filter</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#ap-reject">ap-reject</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#ap-dotimes">ap-dotimes</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#ap-first">ap-first</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#ap-last">ap-last</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#ap-reduce">ap-reduce</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#ap-pipe">ap-pipe</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#ap-compose">ap-compose</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#xi">xi</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-extra/reserved">Reserved Names</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#names">names</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-contrib/index">Contributor Modules Index</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-contrib/loop">loop/recur</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#macros">Macros</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-contrib/multi">defmulti</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#defn">defn</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#id1">defmulti</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-contrib/profile">Profile</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#macros">Macros</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-contrib/sequences">Lazy sequences</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#seq">seq</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#defseq">defseq</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#end-sequence">end-sequence</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-contrib/walk">walk</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#functions">Functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document-contrib/hy_repr">Hy representations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#hy-repr">hy-repr</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-hacking">Hacking on Hy</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#join-our-hyve">Join our Hyve!</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#hack">Hack!</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#test">Test!</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#document">Document!</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#contributor-guidelines">Contributor Guidelines</a><ul>
<li class="toctree-l3"><a class="reference internal" href="index.html#issues">Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="index.html#pull-requests">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#contributor-code-of-conduct">Contributor Code of Conduct</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#core-team">Core Team</a></li>
</ul>
</li>
</ul>
</div>
            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html#document-index">hy</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html#document-index">Docs</a> &raquo;</li>
        
      <li>hy 0.13.0 documentation</li>
    
    
  <li style="margin-left: 1em">Hy version 0.13.0</li>
  
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/hylang/hy/blob/807b0b6d248fd341cbf87bf8bfa55caf5b83d655/docs/index.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    

  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="welcome-to-hy-s-documentation">
<h1>Welcome to Hy's documentation!<a class="headerlink" href="#welcome-to-hy-s-documentation" title="Permalink to this headline">¶</a></h1>
<img alt="Hy" class="align-left" src="_images/hy-logo-small.png" />
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Try Hy:</th><td class="field-body"><p class="first"><a class="reference external" href="https://try-hy.appspot.com">https://try-hy.appspot.com</a></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">PyPI:</th><td class="field-body"><p class="first"><a class="reference external" href="https://pypi.python.org/pypi/hy">https://pypi.python.org/pypi/hy</a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Source:</th><td class="field-body"><p class="first"><a class="reference external" href="https://github.com/hylang/hy">https://github.com/hylang/hy</a></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">List:</th><td class="field-body"><p class="first"><a class="reference external" href="https://groups.google.com/forum/#!forum/hylang-discuss">hylang-discuss</a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">IRC:</th><td class="field-body"><p class="first"><code class="docutils literal"><span class="pre">#hy</span></code> on Freenode</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Build status:</th><td class="field-body"><a class="first last reference external image-reference" href="http://travis-ci.org/hylang/hy"><img alt="Travis CI" src="https://secure.travis-ci.org/hylang/hy.png" /></a>
</td>
</tr>
</tbody>
</table>
<p>Hy is a wonderful dialect of Lisp that's embedded in Python.</p>
<p>Since Hy transforms its Lisp code into the Python Abstract Syntax
Tree, you have the whole beautiful world of Python at your fingertips,
in Lisp form!</p>
</div>
<div class="section" id="documentation-index">
<h1>Documentation Index<a class="headerlink" href="#documentation-index" title="Permalink to this headline">¶</a></h1>
<p>Contents:</p>
<div class="toctree-wrapper compound">
<span id="document-quickstart"></span><div class="section" id="quickstart">
<h2>Quickstart<a class="headerlink" href="#quickstart" title="Permalink to this headline">¶</a></h2>
<img alt="Karen Rustard's Cuddles" src="_images/cuddles-transparent-small.png" />
<p>(Thanks to Karen Rustad for Cuddles!)</p>
<p><strong>HOW TO GET HY REAL FAST</strong>:</p>
<ol class="arabic">
<li><p class="first">Create a <a class="reference external" href="https://pypi.python.org/pypi/virtualenv">Virtual Python Environment</a>.</p>
</li>
<li><p class="first">Activate your Virtual Python Environment.</p>
</li>
<li><p class="first">Install <a class="reference external" href="https://github.com/hylang/hy">hy from GitHub</a> with <code class="docutils literal"><span class="pre">$</span> <span class="pre">pip</span> <span class="pre">install</span> <span class="pre">git+https://github.com/hylang/hy.git</span></code>.</p>
</li>
<li><p class="first">Start a REPL with <code class="docutils literal"><span class="pre">hy</span></code>.</p>
</li>
<li><p class="first">Type stuff in the REPL:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>=&gt; (print &quot;Hy!&quot;)
Hy!
=&gt; (defn salutationsnm [name] (print (+ &quot;Hy &quot; name &quot;!&quot;)))
=&gt; (salutationsnm &quot;YourName&quot;)
Hy YourName!

etc
</pre></div>
</div>
</li>
<li><p class="first">Hit CTRL-D when you're done.</p>
</li>
</ol>
<p><em>OMG! That's amazing! I want to write a Hy program.</em></p>
<ol class="arabic" start="7">
<li><p class="first">Open up an elite programming editor and type:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="ch">#! /usr/bin/env hy</span>
<span class="p">(</span><span class="nb">print</span> <span class="s2">&quot;I was going to code in Python syntax, but then I got Hy.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first">Save as <code class="docutils literal"><span class="pre">awesome.hy</span></code>.</p>
</li>
<li><p class="first">Make it executable:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">chmod</span> <span class="o">+</span><span class="n">x</span> <span class="n">awesome</span><span class="o">.</span><span class="n">hy</span>
</pre></div>
</div>
</li>
<li><p class="first">And run your first Hy program:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">awesome</span><span class="o">.</span><span class="n">hy</span>
</pre></div>
</div>
</li>
<li><p class="first">Take a deep breath so as to not hyperventilate.</p>
</li>
<li><p class="first">Smile villainously and sneak off to your hydeaway and do
unspeakable things.</p>
</li>
</ol>
</div>
<span id="document-tutorial"></span><div class="section" id="tutorial">
<h2>Tutorial<a class="headerlink" href="#tutorial" title="Permalink to this headline">¶</a></h2>
<p>Welcome to the Hy tutorial!</p>
<p>In a nutshell, Hy is a Lisp dialect, but one that converts its
structure into Python ... literally a conversion into Python's abstract
syntax tree!  (Or to put it in more crude terms, Hy is lisp-stick on a
Python!)</p>
<p>This is pretty cool because it means Hy is several things:</p>
<blockquote>
<div><ul class="simple">
<li>A Lisp that feels very Pythonic</li>
<li>For Lispers, a great way to use Lisp's crazy powers but in the wide
world of Python's libraries (why yes, you now can write a Django
application in Lisp!)</li>
<li>For Pythonistas, a great way to start exploring Lisp, from the
comfort of Python!</li>
<li>For everyone: a pleasant language that has a lot of neat ideas!</li>
</ul>
</div></blockquote>
<div class="section" id="basic-intro-to-lisp-for-pythonistas">
<h3>Basic intro to Lisp for Pythonistas<a class="headerlink" href="#basic-intro-to-lisp-for-pythonistas" title="Permalink to this headline">¶</a></h3>
<p>Okay, maybe you've never used Lisp before, but you've used Python!</p>
<p>A &quot;hello world&quot; program in Hy is actually super simple. Let's try it:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">print </span><span class="s">&quot;hello world&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>See?  Easy!  As you may have guessed, this is the same as the Python
version of:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="nb">print</span> <span class="s2">&quot;hello world&quot;</span>
</pre></div>
</div>
<p>To add up some super simple math, we could do:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">+ </span><span class="mi">1</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>Which would return 4 and would be the equivalent of:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="nb">+ </span><span class="mi">3</span>
</pre></div>
</div>
<p>What you'll notice is that the first item in the list is the function
being called and the rest of the arguments are the arguments being
passed in.  In fact, in Hy (as with most Lisps) we can pass in
multiple arguments to the plus operator:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">+ </span><span class="mi">1</span> <span class="mi">3</span> <span class="mi">55</span><span class="p">)</span>
</pre></div>
</div>
<p>Which would return 59.</p>
<p>Maybe you've heard of Lisp before but don't know much about it.  Lisp
isn't as hard as you might think, and Hy inherits from Python, so Hy
is a great way to start learning Lisp.  The main thing that's obvious
about Lisp is that there's a lot of parentheses.  This might seem
confusing at first, but it isn't so hard.  Let's look at some simple
math that's wrapped in a bunch of parentheses that we could enter into
the Hy interpreter:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">setv</span> <span class="nv">result</span> <span class="p">(</span><span class="nb">- </span><span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nb">+ </span><span class="mi">1</span> <span class="mi">3</span> <span class="mi">88</span><span class="p">)</span> <span class="mi">2</span><span class="p">)</span> <span class="mi">8</span><span class="p">))</span>
</pre></div>
</div>
<p>This would return 38.  But why?  Well, we could look at the equivalent
expression in python:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">88</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">8</span>
</pre></div>
</div>
<p>If you were to try to figure out how the above were to work in python,
you'd of course figure out the results by solving each inner
parenthesis.  That's the same basic idea in Hy.  Let's try this
exercise first in Python:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">88</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">8</span>
<span class="c1"># simplified to...</span>
<span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="mi">92</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">8</span>
<span class="c1"># simplified to...</span>
<span class="n">result</span> <span class="o">=</span> <span class="mi">46</span> <span class="o">-</span> <span class="mi">8</span>
<span class="c1"># simplified to...</span>
<span class="n">result</span> <span class="o">=</span> <span class="mi">38</span>
</pre></div>
</div>
<p>Now let's try the same thing in Hy:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">setv</span> <span class="nv">result</span> <span class="p">(</span><span class="nb">- </span><span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nb">+ </span><span class="mi">1</span> <span class="mi">3</span> <span class="mi">88</span><span class="p">)</span> <span class="mi">2</span><span class="p">)</span> <span class="mi">8</span><span class="p">))</span>
<span class="c1">; simplified to...</span>
<span class="p">(</span><span class="nf">setv</span> <span class="nv">result</span> <span class="p">(</span><span class="nb">- </span><span class="p">(</span><span class="nb">/ </span><span class="mi">92</span> <span class="mi">2</span><span class="p">)</span> <span class="mi">8</span><span class="p">))</span>
<span class="c1">; simplified to...</span>
<span class="p">(</span><span class="nf">setv</span> <span class="nv">result</span> <span class="p">(</span><span class="nb">- </span><span class="mi">46</span> <span class="mi">8</span><span class="p">))</span>
<span class="c1">; simplified to...</span>
<span class="p">(</span><span class="nf">setv</span> <span class="nv">result</span> <span class="mi">38</span><span class="p">)</span>
</pre></div>
</div>
<p>As you probably guessed, this last expression with <code class="docutils literal"><span class="pre">setv</span></code> means to
assign the variable &quot;result&quot; to 38.</p>
<p>See?  Not too hard!</p>
<p>This is the basic premise of Lisp. Lisp stands for &quot;list
processing&quot;; this means that the structure of the program is
actually lists of lists.  (If you're familiar with Python lists,
imagine the entire same structure as above but with square brackets
instead, any you'll be able to see the structure above as both a
program and a data structure.)  This is easier to understand with more
examples, so let's write a simple Python program, test it, and then
show the equivalent Hy program:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">simple_conversation</span><span class="p">():</span>
    <span class="nb">print</span> <span class="s2">&quot;Hello!  I&#39;d like to get to know you.  Tell me about yourself!&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">raw_input</span><span class="p">(</span><span class="s2">&quot;What is your name? &quot;</span><span class="p">)</span>
    <span class="n">age</span> <span class="o">=</span> <span class="n">raw_input</span><span class="p">(</span><span class="s2">&quot;What is your age? &quot;</span><span class="p">)</span>
    <span class="nb">print</span> <span class="s2">&quot;Hello &quot;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;!  I see you are &quot;</span> <span class="o">+</span> <span class="n">age</span> <span class="o">+</span> <span class="s2">&quot; years old.&quot;</span>

<span class="n">simple_conversation</span><span class="p">()</span>
</pre></div>
</div>
<p>If we ran this program, it might go like:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>Hello!  I&#39;d like to get to know you.  Tell me about yourself!
What is your name? Gary
What is your age? 38
Hello Gary!  I see you are 38 years old.
</pre></div>
</div>
<p>Now let's look at the equivalent Hy program:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="kd">defn </span><span class="nv">simple-conversation</span> <span class="p">[]</span>
   <span class="p">(</span><span class="nb">print </span><span class="s">&quot;Hello!  I&#39;d like to get to know you.  Tell me about yourself!&quot;</span><span class="p">)</span>
   <span class="p">(</span><span class="nf">setv</span> <span class="nb">name </span><span class="p">(</span><span class="nf">raw-input</span> <span class="s">&quot;What is your name? &quot;</span><span class="p">))</span>
   <span class="p">(</span><span class="nf">setv</span> <span class="nv">age</span> <span class="p">(</span><span class="nf">raw-input</span> <span class="s">&quot;What is your age? &quot;</span><span class="p">))</span>
   <span class="p">(</span><span class="nb">print </span><span class="p">(</span><span class="nb">+ </span><span class="s">&quot;Hello &quot;</span> <span class="nb">name </span><span class="s">&quot;!  I see you are &quot;</span>
              <span class="nv">age</span> <span class="s">&quot; years old.&quot;</span><span class="p">)))</span>

<span class="p">(</span><span class="nf">simple-conversation</span><span class="p">)</span>
</pre></div>
</div>
<p>If you look at the above program, as long as you remember that the
first element in each list of the program is the function (or
macro... we'll get to those later) being called and that the rest are
the arguments, it's pretty easy to figure out what this all means.
(As you probably also guessed, <code class="docutils literal"><span class="pre">defn</span></code> is the Hy method of defining
methods.)</p>
<p>Still, lots of people find this confusing at first because there's so
many parentheses, but there are plenty of things that can help make
this easier: keep indentation nice and use an editor with parenthesis
matching (this will help you figure out what each parenthesis pairs up
with) and things will start to feel comfortable.</p>
<p>There are some advantages to having a code structure that's actually a
very simple data structure as the core of Lisp is based on.  For one
thing, it means that your programs are easy to parse and that the
entire actual structure of the program is very clearly exposed to you.
(There's an extra step in Hy where the structure you see is converted
to Python's own representations ... in &quot;purer&quot; Lisps such as Common
Lisp or Emacs Lisp, the data structure you see in the code and the
data structure that is executed is much more literally close.)</p>
<p>Another implication of this is macros: if a program's structure is a
simple data structure, that means you can write code that can write
code very easily, meaning that implementing entirely new language
features can be very fast.  Previous to Hy, this wasn't very possible
for Python programmers ... now you too can make use of macros'
incredible power (just be careful to not aim them footward)!</p>
</div>
<div class="section" id="hy-is-a-lisp-flavored-python">
<h3>Hy is a Lisp-flavored Python<a class="headerlink" href="#hy-is-a-lisp-flavored-python" title="Permalink to this headline">¶</a></h3>
<p>Hy converts to Python's own abstract syntax tree, so you'll soon start
to find that all the familiar power of python is at your fingertips.</p>
<p>You have full access to Python's data types and standard library in
Hy.  Let's experiment with this in the hy interpreter:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="o">=&gt;</span> <span class="p">{</span><span class="s2">&quot;dog&quot;</span> <span class="s2">&quot;bark&quot;</span>
<span class="o">...</span> <span class="s2">&quot;cat&quot;</span> <span class="s2">&quot;meow&quot;</span><span class="p">}</span>
<span class="p">{</span><span class="s1">&#39;dog&#39;</span><span class="p">:</span> <span class="s1">&#39;bark&#39;</span><span class="p">,</span> <span class="s1">&#39;cat&#39;</span><span class="p">:</span> <span class="s1">&#39;meow&#39;</span><span class="p">}</span>
<span class="o">=&gt;</span> <span class="p">(,</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">)</span>
<span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="o">=&gt;</span> <span class="c1">#{3 1 2}</span>
<span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">}</span>
<span class="o">=&gt;</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span>
<span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Notice the last two lines: Hy has a fraction literal like Clojure.</p>
<p>If you start Hy like this (a shell alias might be helpful):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ hy --repl-output-fn=hy.contrib.hy-repr.hy-repr
</pre></div>
</div>
<p>the interactive mode will use <a class="reference internal" href="index.html#hy-repr-fn"><span class="std std-ref">hy-repr</span></a> instead of Python's
native <code class="docutils literal"><span class="pre">repr</span></code> function to print out values, so you'll see values in
Hy syntax rather than Python syntax:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">]</span>
<span class="o">=&gt;</span> <span class="p">{</span><span class="s2">&quot;dog&quot;</span> <span class="s2">&quot;bark&quot;</span>
<span class="o">...</span> <span class="s2">&quot;cat&quot;</span> <span class="s2">&quot;meow&quot;</span><span class="p">}</span>
<span class="p">{</span><span class="s2">&quot;dog&quot;</span> <span class="s2">&quot;bark&quot;</span> <span class="s2">&quot;cat&quot;</span> <span class="s2">&quot;meow&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>If you are familiar with other Lisps, you may be interested that Hy
supports the Common Lisp method of quoting:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">)</span>
<span class="p">(</span><span class="mi">1</span><span class="nv">L</span> <span class="mi">2</span><span class="nv">L</span> <span class="mi">3</span><span class="nv">L</span><span class="p">)</span>
</pre></div>
</div>
<p>You also have access to all the built-in types' nice methods:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="p">(</span><span class="o">.</span><span class="n">strip</span> <span class="s2">&quot; fooooo   &quot;</span><span class="p">)</span>
<span class="s2">&quot;fooooo&quot;</span>
</pre></div>
</div>
<p>What's this?  Yes indeed, this is precisely the same as:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="s2">&quot; fooooo   &quot;</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</pre></div>
</div>
<p>That's right---Lisp with dot notation!  If we have this string
assigned as a variable, we can also do the following:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">setv</span> <span class="nv">this-string</span> <span class="s">&quot; fooooo   &quot;</span><span class="p">)</span>
<span class="p">(</span><span class="nf">this-string.strip</span><span class="p">)</span>
</pre></div>
</div>
<p>What about conditionals?:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">try-some-thing</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">print </span><span class="s">&quot;this is if true&quot;</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">print </span><span class="s">&quot;this is if false&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>As you can tell above, the first argument to <code class="docutils literal"><span class="pre">if</span></code> is a truth test, the
second argument is the body if true, and the third argument (optional!)
is if false (ie. <code class="docutils literal"><span class="pre">else</span></code>).</p>
<p>If you need to do more complex conditionals, you'll find that you
don't have <code class="docutils literal"><span class="pre">elif</span></code> available in Hy.  Instead, you should use something
called <code class="docutils literal"><span class="pre">cond</span></code>.  In Python, you might do something like:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">somevar</span> <span class="o">=</span> <span class="mi">33</span>
<span class="k">if</span> <span class="n">somevar</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">:</span>
    <span class="nb">print</span> <span class="s2">&quot;That variable is too big!&quot;</span>
<span class="k">elif</span> <span class="n">somevar</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
    <span class="nb">print</span> <span class="s2">&quot;That variable is too small!&quot;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span> <span class="s2">&quot;That variable is jussssst right!&quot;</span>
</pre></div>
</div>
<p>In Hy, you would do:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">setv</span> <span class="nv">somevar</span> <span class="mi">33</span><span class="p">)</span>
<span class="p">(</span><span class="nf">cond</span>
 <span class="p">[(</span><span class="nb">&gt; </span><span class="nv">somevar</span> <span class="mi">50</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">print </span><span class="s">&quot;That variable is too big!&quot;</span><span class="p">)]</span>
 <span class="p">[(</span><span class="nb">&lt; </span><span class="nv">somevar</span> <span class="mi">10</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">print </span><span class="s">&quot;That variable is too small!&quot;</span><span class="p">)]</span>
 <span class="p">[</span><span class="nv">True</span>
  <span class="p">(</span><span class="nb">print </span><span class="s">&quot;That variable is jussssst right!&quot;</span><span class="p">)])</span>
</pre></div>
</div>
<p>What you'll notice is that <code class="docutils literal"><span class="pre">cond</span></code> switches off between a statement
that is executed and checked conditionally for true or falseness, and
then a bit of code to execute if it turns out to be true.  You'll also
notice that the <code class="docutils literal"><span class="pre">else</span></code> is implemented at the end simply by checking
for <code class="docutils literal"><span class="pre">True</span></code> -- that's because <code class="docutils literal"><span class="pre">True</span></code> will always be true, so if we get
this far, we'll always run that one!</p>
<p>You might notice above that if you have code like:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">if </span><span class="nv">some-condition</span>
  <span class="p">(</span><span class="nf">body-if-true</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">body-if-false</span><span class="p">))</span>
</pre></div>
</div>
<p>But wait!  What if you want to execute more than one statement in the
body of one of these?</p>
<p>You can do the following:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">try-some-thing</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">do</span>
    <span class="p">(</span><span class="nb">print </span><span class="s">&quot;this is if true&quot;</span><span class="p">)</span>
    <span class="p">(</span><span class="nb">print </span><span class="s">&quot;and why not, let&#39;s keep talking about how true it is!&quot;</span><span class="p">))</span>
  <span class="p">(</span><span class="nb">print </span><span class="s">&quot;this one&#39;s still simply just false&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>You can see that we used <code class="docutils literal"><span class="pre">do</span></code> to wrap multiple statements.  If you're
familiar with other Lisps, this is the equivalent of <code class="docutils literal"><span class="pre">progn</span></code>
elsewhere.</p>
<p>Comments start with semicolons:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">print </span><span class="s">&quot;this will run&quot;</span><span class="p">)</span>
<span class="c1">; (print &quot;but this will not&quot;)</span>
<span class="p">(</span><span class="nb">+ </span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1">; we&#39;ll execute the addition, but not this comment!</span>
</pre></div>
</div>
<p>Hashbang (<code class="docutils literal"><span class="pre">#!</span></code>) syntax is supported:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="o">#</span><span class="nv">!</span> <span class="nv">/usr/bin/env</span> <span class="nv">hy</span>
<span class="p">(</span><span class="nb">print </span><span class="s">&quot;Make me executable, and run me!&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Looping is not hard but has a kind of special structure.  In Python,
we might do:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="nb">print</span> <span class="s2">&quot;&#39;i&#39; is now at &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
<p>The equivalent in Hy would be:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">for </span><span class="p">[</span><span class="nv">i</span> <span class="p">(</span><span class="nb">range </span><span class="mi">10</span><span class="p">)]</span>
  <span class="p">(</span><span class="nb">print </span><span class="p">(</span><span class="nb">+ </span><span class="s">&quot;&#39;i&#39; is now at &quot;</span> <span class="p">(</span><span class="nb">str </span><span class="nv">i</span><span class="p">))))</span>
</pre></div>
</div>
<p>You can also import and make use of various Python libraries.  For
example:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">import </span><span class="nv">os</span><span class="p">)</span>

<span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">os.path.isdir</span> <span class="s">&quot;/tmp/somedir&quot;</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">os.mkdir</span> <span class="s">&quot;/tmp/somedir/anotherdir&quot;</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">print </span><span class="s">&quot;Hey, that path isn&#39;t there!&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>Python's context managers (<code class="docutils literal"><span class="pre">with</span></code> statements) are used like this:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">with</span> <span class="p">[</span><span class="nv">f</span> <span class="p">(</span><span class="nf">open</span> <span class="s">&quot;/tmp/data.in&quot;</span><span class="p">)]</span>
  <span class="p">(</span><span class="nb">print </span><span class="p">(</span><span class="nf">.read</span> <span class="nv">f</span><span class="p">)))</span>
</pre></div>
</div>
<p>which is equivalent to:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;/tmp/data.in&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="nb">print</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</pre></div>
</div>
<p>And yes, we do have List comprehensions!  In Python you might do:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">odds_squared</span> <span class="o">=</span> <span class="p">[</span>
  <span class="nb">pow</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">num</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>In Hy, you could do these like:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">setv</span> <span class="nv">odds-squared</span>
  <span class="p">(</span><span class="nf">list-comp</span>
    <span class="p">(</span><span class="nf">pow</span> <span class="nv">num</span> <span class="mi">2</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">num</span> <span class="p">(</span><span class="nb">range </span><span class="mi">100</span><span class="p">))</span>
    <span class="p">(</span><span class="nb">= </span><span class="p">(</span><span class="nf">%</span> <span class="nv">num</span> <span class="mi">2</span><span class="p">)</span> <span class="mi">1</span><span class="p">)))</span>
</pre></div>
</div>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="c1">; And, an example stolen shamelessly from a Clojure page:</span>
<span class="c1">; Let&#39;s list all the blocks of a Chessboard:</span>

<span class="p">(</span><span class="nf">list-comp</span>
  <span class="p">(</span>, <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">x</span> <span class="p">(</span><span class="nb">range </span><span class="mi">8</span><span class="p">)</span>
   <span class="nv">y</span> <span class="s">&quot;ABCDEFGH&quot;</span><span class="p">))</span>

<span class="c1">; [(0, &#39;A&#39;), (0, &#39;B&#39;), (0, &#39;C&#39;), (0, &#39;D&#39;), (0, &#39;E&#39;), (0, &#39;F&#39;), (0, &#39;G&#39;), (0, &#39;H&#39;),</span>
<span class="c1">;  (1, &#39;A&#39;), (1, &#39;B&#39;), (1, &#39;C&#39;), (1, &#39;D&#39;), (1, &#39;E&#39;), (1, &#39;F&#39;), (1, &#39;G&#39;), (1, &#39;H&#39;),</span>
<span class="c1">;  (2, &#39;A&#39;), (2, &#39;B&#39;), (2, &#39;C&#39;), (2, &#39;D&#39;), (2, &#39;E&#39;), (2, &#39;F&#39;), (2, &#39;G&#39;), (2, &#39;H&#39;),</span>
<span class="c1">;  (3, &#39;A&#39;), (3, &#39;B&#39;), (3, &#39;C&#39;), (3, &#39;D&#39;), (3, &#39;E&#39;), (3, &#39;F&#39;), (3, &#39;G&#39;), (3, &#39;H&#39;),</span>
<span class="c1">;  (4, &#39;A&#39;), (4, &#39;B&#39;), (4, &#39;C&#39;), (4, &#39;D&#39;), (4, &#39;E&#39;), (4, &#39;F&#39;), (4, &#39;G&#39;), (4, &#39;H&#39;),</span>
<span class="c1">;  (5, &#39;A&#39;), (5, &#39;B&#39;), (5, &#39;C&#39;), (5, &#39;D&#39;), (5, &#39;E&#39;), (5, &#39;F&#39;), (5, &#39;G&#39;), (5, &#39;H&#39;),</span>
<span class="c1">;  (6, &#39;A&#39;), (6, &#39;B&#39;), (6, &#39;C&#39;), (6, &#39;D&#39;), (6, &#39;E&#39;), (6, &#39;F&#39;), (6, &#39;G&#39;), (6, &#39;H&#39;),</span>
<span class="c1">;  (7, &#39;A&#39;), (7, &#39;B&#39;), (7, &#39;C&#39;), (7, &#39;D&#39;), (7, &#39;E&#39;), (7, &#39;F&#39;), (7, &#39;G&#39;), (7, &#39;H&#39;)]</span>
</pre></div>
</div>
<p>Python has support for various fancy argument and keyword arguments.
In Python we might see:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">optional_arg</span><span class="p">(</span><span class="n">pos1</span><span class="p">,</span> <span class="n">pos2</span><span class="p">,</span> <span class="n">keyword1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keyword2</span><span class="o">=</span><span class="mi">42</span><span class="p">):</span>
<span class="gp">... </span>  <span class="k">return</span> <span class="p">[</span><span class="n">pos1</span><span class="p">,</span> <span class="n">pos2</span><span class="p">,</span> <span class="n">keyword1</span><span class="p">,</span> <span class="n">keyword2</span><span class="p">]</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">optional_arg</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">[1, 2, None, 42]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">optional_arg</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">[1, 2, 3, 4]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">optional_arg</span><span class="p">(</span><span class="n">keyword1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pos2</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pos1</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">keyword2</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="go">[3, 2, 1, 4]</span>
</pre></div>
</div>
<p>The same thing in Hy:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="p">(</span><span class="n">defn</span> <span class="n">optional</span><span class="o">-</span><span class="n">arg</span> <span class="p">[</span><span class="n">pos1</span> <span class="n">pos2</span> <span class="o">&amp;</span><span class="n">optional</span> <span class="n">keyword1</span> <span class="p">[</span><span class="n">keyword2</span> <span class="mi">42</span><span class="p">]]</span>
<span class="o">...</span>  <span class="p">[</span><span class="n">pos1</span> <span class="n">pos2</span> <span class="n">keyword1</span> <span class="n">keyword2</span><span class="p">])</span>
<span class="o">=&gt;</span> <span class="p">(</span><span class="n">optional</span><span class="o">-</span><span class="n">arg</span> <span class="mi">1</span> <span class="mi">2</span><span class="p">)</span>
<span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="kc">None</span> <span class="mi">42</span><span class="p">]</span>
<span class="o">=&gt;</span> <span class="p">(</span><span class="n">optional</span><span class="o">-</span><span class="n">arg</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">)</span>
<span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
<p>If you're running a version of Hy past 0.10.1 (eg, git master),
there's also a nice new keyword argument syntax:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="p">(</span><span class="n">optional</span><span class="o">-</span><span class="n">arg</span> <span class="p">:</span><span class="n">keyword1</span> <span class="mi">1</span>
<span class="o">...</span>              <span class="p">:</span><span class="n">pos2</span> <span class="mi">2</span>
<span class="o">...</span>              <span class="p">:</span><span class="n">pos1</span> <span class="mi">3</span>
<span class="o">...</span>              <span class="p">:</span><span class="n">keyword2</span> <span class="mi">4</span><span class="p">)</span>
<span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
<p>Otherwise, you can always use <cite>apply</cite>.  But what's <cite>apply</cite>?</p>
<p>Are you familiar with passing in <cite>*args</cite> and <cite>**kwargs</cite> in Python?:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;keyword2&quot;</span><span class="p">:</span> <span class="mi">3</span>
<span class="gp">... </span>          <span class="s2">&quot;keyword1&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">optional_arg</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>We can reproduce this with <cite>apply</cite>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="p">(</span><span class="n">setv</span> <span class="n">args</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">2</span><span class="p">])</span>
<span class="o">=&gt;</span> <span class="p">(</span><span class="n">setv</span> <span class="n">kwargs</span> <span class="p">{</span><span class="s2">&quot;keyword2&quot;</span> <span class="mi">3</span>
<span class="o">...</span>              <span class="s2">&quot;keyword1&quot;</span> <span class="mi">4</span><span class="p">})</span>
<span class="o">=&gt;</span> <span class="p">(</span><span class="n">apply</span> <span class="n">optional</span><span class="o">-</span><span class="n">arg</span> <span class="n">args</span> <span class="n">kwargs</span><span class="p">)</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
<p>There's also a dictionary-style keyword arguments construction that
looks like:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="kd">defn </span><span class="nv">another-style</span> <span class="p">[</span><span class="o">&amp;</span><span class="nb">key </span><span class="p">{</span><span class="s">&quot;key1&quot;</span> <span class="s">&quot;val1&quot;</span> <span class="s">&quot;key2&quot;</span> <span class="s">&quot;val2&quot;</span><span class="p">}]</span>
  <span class="p">[</span><span class="nv">key1</span> <span class="nv">key2</span><span class="p">])</span>
</pre></div>
</div>
<p>The difference here is that since it's a dictionary, you can't rely on
any specific ordering to the arguments.</p>
<p>Hy also supports <code class="docutils literal"><span class="pre">*args</span></code> and <code class="docutils literal"><span class="pre">**kwargs</span></code>.  In Python:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">some_func</span><span class="p">(</span><span class="n">foo</span><span class="p">,</span> <span class="n">bar</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
  <span class="kn">import</span> <span class="nn">pprint</span>
  <span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">((</span><span class="n">foo</span><span class="p">,</span> <span class="n">bar</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">))</span>
</pre></div>
</div>
<p>The Hy equivalent:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="kd">defn </span><span class="nv">some-func</span> <span class="p">[</span><span class="nv">foo</span> <span class="nv">bar</span> <span class="o">&amp;</span><span class="nb">rest </span><span class="nv">args</span> <span class="o">&amp;</span><span class="nv">kwargs</span> <span class="nv">kwargs</span><span class="p">]</span>
  <span class="p">(</span><span class="nb">import </span><span class="nv">pprint</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">pprint.pprint</span> <span class="p">(</span>, <span class="nv">foo</span> <span class="nv">bar</span> <span class="nv">args</span> <span class="nv">kwargs</span><span class="p">)))</span>
</pre></div>
</div>
<p>Finally, of course we need classes!  In Python, we might have a class
like:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">FooBar</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Yet Another Example Class</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>

    <span class="k">def</span> <span class="nf">get_x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return our copy of x</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>
</pre></div>
</div>
<p>And we might use it like:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">bar</span> <span class="o">=</span> <span class="n">FooBar</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span> <span class="n">bar</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span>
</pre></div>
</div>
<p>In Hy:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">defclass</span> <span class="nv">FooBar</span> <span class="p">[</span><span class="nv">object</span><span class="p">]</span>
  <span class="s">&quot;Yet Another Example Class&quot;</span>

  <span class="p">(</span><span class="kd">defn </span><span class="nv">--init--</span> <span class="p">[</span><span class="nv">self</span> <span class="nv">x</span><span class="p">]</span>
    <span class="p">(</span><span class="nf">setv</span> <span class="nv">self.x</span> <span class="nv">x</span><span class="p">))</span>

  <span class="p">(</span><span class="kd">defn </span><span class="nv">get-x</span> <span class="p">[</span><span class="nv">self</span><span class="p">]</span>
    <span class="s">&quot;Return our copy of x&quot;</span>
    <span class="nv">self.x</span><span class="p">))</span>
</pre></div>
</div>
<p>And we can use it like:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">setv</span> <span class="nv">bar</span> <span class="p">(</span><span class="nf">FooBar</span> <span class="mi">1</span><span class="p">))</span>
<span class="p">(</span><span class="nb">print </span><span class="p">(</span><span class="nf">bar.get-x</span><span class="p">))</span>
</pre></div>
</div>
<p>Or using the leading dot syntax!</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">print </span><span class="p">(</span><span class="nf">.get-x</span> <span class="p">(</span><span class="nf">FooBar</span> <span class="mi">1</span><span class="p">)))</span>
</pre></div>
</div>
<p>You can also do class-level attributes.  In Python:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Customer</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
    <span class="n">address</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">()</span>
    <span class="n">notes</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">()</span>
</pre></div>
</div>
<p>In Hy:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">defclass</span> <span class="nv">Customer</span> <span class="p">[</span><span class="nv">models.Model</span><span class="p">]</span>
  <span class="p">[</span><span class="nb">name </span><span class="p">(</span><span class="nf">models.CharField</span> <span class="ss">:max-length</span> <span class="mi">255</span><span class="p">})</span>
   <span class="nv">address</span> <span class="p">(</span><span class="nf">models.TextField</span><span class="p">)</span>
   <span class="nv">notes</span> <span class="p">(</span><span class="nf">models.TextField</span><span class="p">)])</span>
</pre></div>
</div>
</div>
<div class="section" id="macros">
<h3>Macros<a class="headerlink" href="#macros" title="Permalink to this headline">¶</a></h3>
<p>One really powerful feature of Hy are macros. They are small functions that are
used to generate code (or data). When program written in Hy is started, the
macros are executed and their output is placed in the program source. After this,
the program starts executing normally. Very simple example:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">(</span><span class="kd">defmacro </span><span class="nv">hello</span> <span class="p">[</span><span class="nv">person</span><span class="p">]</span>
<span class="nv">...</span>  <span class="o">`</span><span class="p">(</span><span class="nb">print </span><span class="s">&quot;Hello there,&quot;</span> <span class="o">~</span><span class="nv">person</span><span class="p">))</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">hello</span> <span class="s">&quot;Tuukka&quot;</span><span class="p">)</span>
<span class="nv">Hello</span> <span class="nv">there</span>, <span class="nv">Tuukka</span>
</pre></div>
</div>
<p>The thing to notice here is that hello macro doesn't output anything on
screen. Instead it creates piece of code that is then executed and prints on
screen. This macro writes a piece of program that looks like this (provided that
we used &quot;Tuukka&quot; as parameter):</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">print </span><span class="s">&quot;Hello there,&quot;</span> <span class="s">&quot;Tuukka&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>We can also manipulate code with macros:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">(</span><span class="kd">defmacro </span><span class="nv">rev</span> <span class="p">[</span><span class="nv">code</span><span class="p">]</span>
<span class="nv">...</span>  <span class="p">(</span><span class="nf">setv</span> <span class="nv">op</span> <span class="p">(</span><span class="nb">last </span><span class="nv">code</span><span class="p">)</span> <span class="nv">params</span> <span class="p">(</span><span class="nb">list </span><span class="p">(</span><span class="nb">butlast </span><span class="nv">code</span><span class="p">)))</span>
<span class="nv">...</span>  <span class="o">`</span><span class="p">(</span><span class="o">~</span><span class="nv">op</span> <span class="o">~@</span><span class="nv">params</span><span class="p">))</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">rev</span> <span class="p">(</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="nv">+</span><span class="p">))</span>
<span class="mi">6</span>
</pre></div>
</div>
<p>The code that was generated with this macro just switched around some of the
elements, so by the time program started executing, it actually reads:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">+ </span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>Sometimes it's nice to be able to call a one-parameter macro without
parentheses. Sharp macros allow this. The name of a sharp macro must be only
one character long, but since Hy operates well with Unicode, we aren't running
out of characters that soon:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span>=&gt; (defsharp ↻ [code]
...  (setv op (last code) params (list (butlast code)))
...  `(~op ~@params))
=&gt; #↻(1 2 3 +)
6
</pre></div>
</div>
<p>Macros are useful when one wishes to extend Hy or write their own
language on top of that. Many features of Hy are macros, like <code class="docutils literal"><span class="pre">when</span></code>,
<code class="docutils literal"><span class="pre">cond</span></code> and <code class="docutils literal"><span class="pre">-&gt;</span></code>.</p>
<p>What if you want to use a macro that's defined in a different
module? The special form <code class="docutils literal"><span class="pre">import</span></code> won't help, because it merely
translates to a Python <code class="docutils literal"><span class="pre">import</span></code> statement that's executed at
run-time, and macros are expanded at compile-time, that is,
during the translate from Hy to Python. Instead, use <code class="docutils literal"><span class="pre">require</span></code>,
which imports the module and makes macros available at
compile-time. <code class="docutils literal"><span class="pre">require</span></code> uses the same syntax as <code class="docutils literal"><span class="pre">import</span></code>.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">require</span> <span class="nv">tutorial.macros</span><span class="p">)</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">tutorial.macros.rev</span> <span class="p">(</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="nv">+</span><span class="p">))</span>
<span class="mi">6</span>
</pre></div>
</div>
</div>
<div class="section" id="hy-python-interop">
<h3>Hy &lt;-&gt; Python interop<a class="headerlink" href="#hy-python-interop" title="Permalink to this headline">¶</a></h3>
<div class="section" id="using-hy-from-python">
<h4>Using Hy from Python<a class="headerlink" href="#using-hy-from-python" title="Permalink to this headline">¶</a></h4>
<p>You can use Hy modules in Python!</p>
<p>If you save the following in <code class="docutils literal"><span class="pre">greetings.hy</span></code>:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="kd">defn </span><span class="nv">greet</span> <span class="p">[</span><span class="nv">name</span><span class="p">]</span> <span class="p">(</span><span class="nb">print </span><span class="s">&quot;hello from hy,&quot;</span> <span class="nv">name</span><span class="p">))</span>
</pre></div>
</div>
<p>Then you can use it directly from Python, by importing Hy before importing
the module. In Python:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">hy</span>
<span class="kn">import</span> <span class="nn">greetings</span>

<span class="n">greetings</span><span class="o">.</span><span class="n">greet</span><span class="p">(</span><span class="s2">&quot;Foo&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="using-python-from-hy">
<h4>Using Python from Hy<a class="headerlink" href="#using-python-from-hy" title="Permalink to this headline">¶</a></h4>
<p>You can also use any Python module in Hy!</p>
<p>If you save the following in <code class="docutils literal"><span class="pre">greetings.py</span></code> in Python:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">greet</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;hello, </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">))</span>
</pre></div>
</div>
<p>You can use it in Hy (see <a class="reference internal" href="index.html#import"><span class="std std-ref">import</span></a>):</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">import </span><span class="nv">greetings</span><span class="p">)</span>
<span class="p">(</span><span class="nf">.greet</span> <span class="nv">greetings</span> <span class="s">&quot;foo&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>More information on <a class="reference internal" href="index.html#document-language/interop"><span class="doc">Hy &lt;-&gt; Python interop</span></a>.</p>
</div>
</div>
<div class="section" id="protips">
<h3>Protips!<a class="headerlink" href="#protips" title="Permalink to this headline">¶</a></h3>
<p>Hy also features something known as the &quot;threading macro&quot;, a really neat
feature of Clojure's. The &quot;threading macro&quot; (written as <code class="docutils literal"><span class="pre">-&gt;</span></code>) is used
to avoid deep nesting of expressions.</p>
<p>The threading macro inserts each expression into the next expression's first
argument place.</p>
<p>Let's take the classic:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">loop </span><span class="p">(</span><span class="nb">print </span><span class="p">(</span><span class="nb">eval </span><span class="p">(</span><span class="nf">read</span><span class="p">))))</span>
</pre></div>
</div>
<p>Rather than write it like that, we can write it as follows:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">-&gt; </span><span class="p">(</span><span class="nf">read</span><span class="p">)</span> <span class="p">(</span><span class="nf">eval</span><span class="p">)</span> <span class="p">(</span><span class="nf">print</span><span class="p">)</span> <span class="p">(</span><span class="nf">loop</span><span class="p">))</span>
</pre></div>
</div>
<p>Now, using <a class="reference external" href="http://amoffat.github.com/sh/">python-sh</a>, we can show
how the threading macro (because of python-sh's setup) can be used like
a pipe:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">import </span><span class="p">[</span><span class="nv">sh</span> <span class="p">[</span><span class="nv">cat</span> <span class="nv">grep</span> <span class="nv">wc</span><span class="p">]])</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">-&gt; </span><span class="p">(</span><span class="nf">cat</span> <span class="s">&quot;/usr/share/dict/words&quot;</span><span class="p">)</span> <span class="p">(</span><span class="nf">grep</span> <span class="s">&quot;-E&quot;</span> <span class="s">&quot;^hy&quot;</span><span class="p">)</span> <span class="p">(</span><span class="nf">wc</span> <span class="s">&quot;-l&quot;</span><span class="p">))</span>
<span class="mi">210</span>
</pre></div>
</div>
<p>Which, of course, expands out to:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">wc</span> <span class="p">(</span><span class="nf">grep</span> <span class="p">(</span><span class="nf">cat</span> <span class="s">&quot;/usr/share/dict/words&quot;</span><span class="p">)</span> <span class="s">&quot;-E&quot;</span> <span class="s">&quot;^hy&quot;</span><span class="p">)</span> <span class="s">&quot;-l&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Much more readable, no? Use the threading macro!</p>
</div>
</div>
<span id="document-style-guide"></span><div class="section" id="hy-style-guide">
<h2>Hy Style Guide<a class="headerlink" href="#hy-style-guide" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>“You know, Minister, I disagree with Dumbledore on many counts…but
you cannot deny he’s got style…”
— Phineas Nigellus Black, <em>Harry Potter and the Order of the Phoenix</em></div></blockquote>
<p>The Hy style guide intends to be a set of ground rules for the Hyve
(yes, the Hy community prides itself in appending Hy to everything)
to write idiomatic Hy code. Hy derives a lot from Clojure &amp; Common
Lisp, while always maintaining Python interoperability.</p>
<div class="section" id="prelude">
<h3>Prelude<a class="headerlink" href="#prelude" title="Permalink to this headline">¶</a></h3>
<div class="section" id="the-tao-of-hy">
<h4>The Tao of Hy<a class="headerlink" href="#the-tao-of-hy" title="Permalink to this headline">¶</a></h4>
<div class="highlight-none"><div class="highlight"><pre><span></span>Ummon asked the head monk, &quot;What sutra are you lecturing on?&quot;
&quot;The Nirvana Sutra.&quot;
&quot;The Nirvana Sutra has the Four Virtues, hasn&#39;t it?&quot;
&quot;It has.&quot;
Ummon asked, picking up a cup, &quot;How many virtues has this?&quot;
&quot;None at all,&quot; said the monk.
&quot;But ancient people said it had, didn&#39;t they?&quot; said Ummon.
&quot;What do you think of what they said?&quot;
Ummon struck the cup and asked, &quot;You understand?&quot;
&quot;No,&quot; said the monk.
&quot;Then,&quot; said Ummon, &quot;You&#39;d better go on with your lectures on the sutra.&quot;
— the (koan) macro
</pre></div>
</div>
<p>The following illustrates a brief list of design decisions that went
into the making of Hy.</p>
<ul class="simple">
<li>Look like a Lisp; DTRT with it (e.g. dashes turn to underscores, earmuffs
turn to all-caps).</li>
<li>We're still Python. Most of the internals translate 1:1 to Python internals.</li>
<li>Use Unicode everywhere.</li>
<li>Fix the bad decisions in Python 2 when we can (see <code class="docutils literal"><span class="pre">true_division</span></code>).</li>
<li>When in doubt, defer to Python.</li>
<li>If you're still unsure, defer to Clojure.</li>
<li>If you're even more unsure, defer to Common Lisp.</li>
<li>Keep in mind we're not Clojure. We're not Common Lisp. We're
Homoiconic Python, with extra bits that make sense.</li>
</ul>
</div>
</div>
<div class="section" id="layout-indentation">
<h3>Layout &amp; Indentation<a class="headerlink" href="#layout-indentation" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Avoid trailing spaces. They suck!</p>
</li>
<li><p class="first">Indentation shall be 2 spaces (no hard tabs), except when matching
the indentation of the previous line.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="c1">;; Good (and preferred)</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">fib</span> <span class="p">[</span><span class="nv">n</span><span class="p">]</span>
  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&lt;= </span><span class="nv">n</span> <span class="mi">2</span><span class="p">)</span>
      <span class="nv">n</span>
      <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">fib</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">1</span><span class="p">))</span> <span class="p">(</span><span class="nf">fib</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">2</span><span class="p">)))))</span>

<span class="c1">;; Still okay</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">fib</span> <span class="p">[</span><span class="nv">n</span><span class="p">]</span>
  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&lt;= </span><span class="nv">n</span> <span class="mi">2</span><span class="p">)</span> <span class="nv">n</span> <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">fib</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">1</span><span class="p">))</span> <span class="p">(</span><span class="nf">fib</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">2</span><span class="p">)))))</span>

<span class="c1">;; Still okay</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">fib</span> <span class="p">[</span><span class="nv">n</span><span class="p">]</span>
  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&lt;= </span><span class="nv">n</span> <span class="mi">2</span><span class="p">)</span>
    <span class="nv">n</span>
    <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">fib</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">1</span><span class="p">))</span> <span class="p">(</span><span class="nf">fib</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">2</span><span class="p">)))))</span>

<span class="c1">;; Hysterically ridiculous</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">fib</span> <span class="p">[</span><span class="nv">n</span><span class="p">]</span>
    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&lt;= </span><span class="nv">n</span> <span class="mi">2</span><span class="p">)</span>
            <span class="nv">n</span> <span class="c1">;; yes, I love randomly hitting the space key</span>
      <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">fib</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">1</span><span class="p">))</span> <span class="p">(</span><span class="nf">fib</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">2</span><span class="p">)))))</span>
</pre></div>
</div>
</li>
<li><p class="first">Parentheses must <em>never</em> be left alone, sad and lonesome on their own
line.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="c1">;; Good (and preferred)</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">fib</span> <span class="p">[</span><span class="nv">n</span><span class="p">]</span>
  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&lt;= </span><span class="nv">n</span> <span class="mi">2</span><span class="p">)</span>
      <span class="nv">n</span>
      <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">fib</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">1</span><span class="p">))</span> <span class="p">(</span><span class="nf">fib</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">2</span><span class="p">)))))</span>

<span class="c1">;; Hysterically ridiculous</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">fib</span> <span class="p">[</span><span class="nv">n</span><span class="p">]</span>
  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&lt;= </span><span class="nv">n</span> <span class="mi">2</span><span class="p">)</span>
    <span class="nv">n</span>
    <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">fib</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">1</span><span class="p">))</span> <span class="p">(</span><span class="nf">fib</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">2</span><span class="p">)))</span>
  <span class="p">)</span>
<span class="p">)</span>  <span class="c1">; GAH, BURN IT WITH FIRE</span>
</pre></div>
</div>
</li>
<li><p class="first">Inline comments shall be two spaces from the end of the code; they
must always have a space between the comment character and the start
of the comment. Also, try to not comment the obvious.</p>
</li>
</ul>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="c1">;; Good</span>
<span class="p">(</span><span class="nf">setv</span> <span class="nv">ind</span> <span class="p">(</span><span class="nb">dec </span><span class="nv">x</span><span class="p">))</span>  <span class="c1">; indexing starts from 0</span>

<span class="c1">;; Style-compliant but just states the obvious</span>
<span class="p">(</span><span class="nf">setv</span> <span class="nv">ind</span> <span class="p">(</span><span class="nb">dec </span><span class="nv">x</span><span class="p">))</span>  <span class="c1">; sets index to x-1</span>

<span class="c1">;; Bad</span>
<span class="p">(</span><span class="nf">setv</span> <span class="nv">ind</span> <span class="p">(</span><span class="nb">dec </span><span class="nv">x</span><span class="p">))</span><span class="c1">;typing words for fun</span>
</pre></div>
</div>
</div>
<div class="section" id="coding-style">
<h3>Coding Style<a class="headerlink" href="#coding-style" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">As a convention, try not to use <code class="docutils literal"><span class="pre">def</span></code> for anything other than global
variables; use <code class="docutils literal"><span class="pre">setv</span></code> inside functions, loops, etc.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="c1">;; Good (and preferred)</span>
<span class="p">(</span><span class="k">def </span><span class="nv">*limit*</span> <span class="mi">400000</span><span class="p">)</span>

<span class="p">(</span><span class="kd">defn </span><span class="nv">fibs</span> <span class="p">[</span><span class="nv">a</span> <span class="nv">b</span><span class="p">]</span>
  <span class="p">(</span><span class="nf">while</span> <span class="nv">True</span>
    <span class="p">(</span><span class="nf">yield</span> <span class="nv">a</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">setv</span> <span class="p">(</span>, <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span> <span class="p">(</span>, <span class="nv">b</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">a</span> <span class="nv">b</span><span class="p">)))))</span>

<span class="c1">;; Bad (and not preferred)</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">fibs</span> <span class="p">[</span><span class="nv">a</span> <span class="nv">b</span><span class="p">]</span>
  <span class="p">(</span><span class="nf">while</span> <span class="nv">True</span>
    <span class="p">(</span><span class="nf">yield</span> <span class="nv">a</span><span class="p">)</span>
    <span class="p">(</span><span class="k">def </span><span class="p">(</span>, <span class="nv">a</span> <span class="nv">b</span><span class="p">)</span> <span class="p">(</span>, <span class="nv">b</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">a</span> <span class="nv">b</span><span class="p">)))))</span>
</pre></div>
</div>
</li>
<li><p class="first">Do not use s-expression syntax where vector syntax is intended.
For instance, the fact that the former of these two examples works
is just because the compiler isn't overly strict. In reality, the
correct syntax in places such as this is the latter.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="c1">;; Bad (and evil)</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">foo</span> <span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">print </span><span class="nv">x</span><span class="p">))</span>
<span class="p">(</span><span class="nf">foo</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1">;; Good (and preferred)</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">foo</span> <span class="p">[</span><span class="nv">x</span><span class="p">]</span> <span class="p">(</span><span class="nb">print </span><span class="nv">x</span><span class="p">))</span>
<span class="p">(</span><span class="nf">foo</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first">Use the threading macro or the threading tail macros when encountering
deeply nested s-expressions. However, be judicious when using them. Do
use them when clarity and readability improves; do not construct
convoluted, hard to understand expressions.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="c1">;; Preferred</span>
<span class="p">(</span><span class="k">def </span><span class="nv">*names*</span>
  <span class="p">(</span><span class="nf">with</span> <span class="p">[</span><span class="nv">f</span> <span class="p">(</span><span class="nf">open</span> <span class="s">&quot;names.txt&quot;</span><span class="p">)]</span>
    <span class="p">(</span><span class="nb">-&gt; </span><span class="p">(</span><span class="nf">.read</span> <span class="nv">f</span><span class="p">)</span> <span class="p">(</span><span class="nf">.strip</span><span class="p">)</span> <span class="p">(</span><span class="nf">.replace</span> <span class="s">&quot;\&quot;&quot;</span> <span class="s">&quot;&quot;</span><span class="p">)</span> <span class="p">(</span><span class="nf">.split</span> <span class="s">&quot;,&quot;</span><span class="p">)</span> <span class="p">(</span><span class="nf">sorted</span><span class="p">))))</span>

<span class="c1">;; Not so good</span>
<span class="p">(</span><span class="k">def </span><span class="nv">*names*</span>
  <span class="p">(</span><span class="nf">with</span> <span class="p">[</span><span class="nv">f</span> <span class="p">(</span><span class="nf">open</span> <span class="s">&quot;names.txt&quot;</span><span class="p">)]</span>
  <span class="p">(</span><span class="nf">sorted</span> <span class="p">(</span><span class="nf">.split</span> <span class="s">&quot;,&quot;</span> <span class="p">(</span><span class="nf">.replace</span> <span class="s">&quot;\&quot;&quot;</span> <span class="s">&quot;&quot;</span> <span class="p">(</span><span class="nf">.strip</span> <span class="p">(</span><span class="nf">.read</span> <span class="nv">f</span><span class="p">)))))))</span>

<span class="c1">;; Probably not a good idea</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">square?</span> <span class="p">[</span><span class="nv">x</span><span class="p">]</span>
  <span class="p">(</span><span class="nf">-&gt;&gt;</span> <span class="mi">2</span> <span class="p">(</span><span class="nf">pow</span> <span class="p">(</span><span class="nb">int </span><span class="p">(</span><span class="nf">sqrt</span> <span class="nv">x</span><span class="p">)))</span> <span class="p">(</span><span class="nb">= </span><span class="nv">x</span><span class="p">)))</span>
</pre></div>
</div>
</li>
<li><p class="first">Clojure-style dot notation is preferred over the direct call of
the object's method, though both will continue to be supported.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="c1">;; Good</span>
<span class="p">(</span><span class="nf">with</span> <span class="p">[</span><span class="nv">fd</span> <span class="p">(</span><span class="nf">open</span> <span class="s">&quot;/etc/passwd&quot;</span><span class="p">)]</span>
  <span class="p">(</span><span class="nb">print </span><span class="p">(</span><span class="nf">.readlines</span> <span class="nv">fd</span><span class="p">)))</span>

<span class="c1">;; Not so good</span>
<span class="p">(</span><span class="nf">with</span> <span class="p">[</span><span class="nv">fd</span> <span class="p">(</span><span class="nf">open</span> <span class="s">&quot;/etc/passwd&quot;</span><span class="p">)]</span>
  <span class="p">(</span><span class="nb">print </span><span class="p">(</span><span class="nf">fd.readlines</span><span class="p">)))</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="conclusion">
<h3>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>“Fashions fade, style is eternal”
—Yves Saint Laurent</div></blockquote>
<p>This guide is just a set of community guidelines, and obviously, community
guidelines do not make sense without an active community. Contributions are
welcome. Join us at #hy in freenode, blog about it, tweet about it, and most
importantly, have fun with Hy.</p>
</div>
<div class="section" id="thanks">
<h3>Thanks<a class="headerlink" href="#thanks" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>This guide is heavily inspired from <a class="reference external" href="https://github.com/paultag">&#64;paultag</a> 's blog post <a class="reference external" href="https://notes.pault.ag/hy-survival-guide/">Hy
Survival Guide</a></li>
<li>The <a class="reference external" href="https://github.com/bbatsov/clojure-style-guide">Clojure Style Guide</a></li>
</ul>
</div>
</div>
<span id="document-language/index"></span><div class="section" id="documentation-index">
<h2>Documentation Index<a class="headerlink" href="#documentation-index" title="Permalink to this headline">¶</a></h2>
<p>Contents:</p>
<div class="toctree-wrapper compound">
<span id="document-language/cli"></span><div class="section" id="command-line-interface">
<h3>Command Line Interface<a class="headerlink" href="#command-line-interface" title="Permalink to this headline">¶</a></h3>
<div class="section" id="hy">
<span id="id1"></span><h4>hy<a class="headerlink" href="#hy" title="Permalink to this headline">¶</a></h4>
<div class="section" id="command-line-options">
<h5>Command Line Options<a class="headerlink" href="#command-line-options" title="Permalink to this headline">¶</a></h5>
<dl class="cmdoption">
<dt id="cmdoption-c">
<code class="descname">-c</code><code class="descclassname"> &lt;command&gt;</code><a class="headerlink" href="#cmdoption-c" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute the Hy code in <em>command</em>.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ hy -c <span class="s2">&quot;(print (+ 2 2))&quot;</span>
<span class="m">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="cmdoption">
<dt id="cmdoption-i">
<code class="descname">-i</code><code class="descclassname"> &lt;command&gt;</code><a class="headerlink" href="#cmdoption-i" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute the Hy code in <em>command</em>, then stay in REPL.</p>
</dd></dl>

<dl class="cmdoption">
<dt id="cmdoption-m">
<code class="descname">-m</code><code class="descclassname"> &lt;module&gt;</code><a class="headerlink" href="#cmdoption-m" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute the Hy code in <em>module</em>, including <code class="docutils literal"><span class="pre">defmain</span></code> if defined.</p>
<p>The <a class="reference internal" href="#cmdoption-m"><code class="xref std std-option docutils literal"><span class="pre">-m</span></code></a> flag terminates the options list so that
all arguments after the <em>module</em> name are passed to the module in
<code class="docutils literal"><span class="pre">sys.argv</span></code>.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.11.0.</span></p>
</div>
</dd></dl>

<dl class="cmdoption">
<dt id="cmdoption-spy">
<code class="descname">--spy</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-spy" title="Permalink to this definition">¶</a></dt>
<dd><p>Print equivalent Python code before executing in REPL. For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>=&gt; (defn salutationsnm [name] (print (+ &quot;Hy &quot; name &quot;!&quot;)))
def salutationsnm(name):
    return print(((u&#39;Hy &#39; + name) + u&#39;!&#39;))
=&gt; (salutationsnm &quot;YourName&quot;)
salutationsnm(u&#39;YourName&#39;)
Hy YourName!
=&gt;
</pre></div>
</div>
<p><cite>--spy</cite> only works on REPL mode.
.. versionadded:: 0.9.11</p>
</dd></dl>

<dl class="cmdoption">
<dt id="cmdoption-show-tracebacks">
<code class="descname">--show-tracebacks</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-show-tracebacks" title="Permalink to this definition">¶</a></dt>
<dd><p>Print extended tracebacks for Hy exceptions.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.9.12.</span></p>
</div>
</dd></dl>

<dl class="cmdoption">
<dt id="cmdoption-repl-output-fn">
<code class="descname">--repl-output-fn</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-repl-output-fn" title="Permalink to this definition">¶</a></dt>
<dd><p>Format REPL output using specific function (e.g., hy.contrib.hy-repr.hy-repr)</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.13.0.</span></p>
</div>
</dd></dl>

<dl class="cmdoption">
<dt id="cmdoption-v">
<code class="descname">-v</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-v" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the Hy version number and exit.</p>
</dd></dl>

</div>
</div>
<div class="section" id="hyc">
<span id="id2"></span><h4>hyc<a class="headerlink" href="#hyc" title="Permalink to this headline">¶</a></h4>
<div class="section" id="id3">
<h5>Command Line Options<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h5>
<dl class="cmdoption">
<dt id="cmdoption-arg-file">
<code class="descname">file</code><code class="descclassname">[</code><code class="descclassname">, </code><code class="descname">fileN</code><code class="descclassname">]</code><a class="headerlink" href="#cmdoption-arg-file" title="Permalink to this definition">¶</a></dt>
<dd><p>Compile Hy code to Python bytecode. For example, save the
following code as <code class="docutils literal"><span class="pre">hyname.hy</span></code>:</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">(</span><span class="n">defn</span> <span class="n">hy</span><span class="o">-</span><span class="n">hy</span> <span class="o">[</span><span class="n">name</span><span class="o">]</span>
  <span class="o">(</span><span class="nb">print</span> <span class="o">(+</span> <span class="s">&quot;Hy &quot;</span> <span class="n">name</span> <span class="s">&quot;!&quot;</span><span class="o">)))</span>

<span class="o">(</span><span class="n">hy</span><span class="o">-</span><span class="n">hy</span> <span class="s">&quot;Afroman&quot;</span><span class="o">)</span>
</pre></div>
</div>
<p>Then run:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ hyc hyname.hy
$ python hyname.pyc
Hy Afroman!
</pre></div>
</div>
</dd></dl>

</div>
</div>
<div class="section" id="hy2py">
<span id="id4"></span><h4>hy2py<a class="headerlink" href="#hy2py" title="Permalink to this headline">¶</a></h4>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.10.1.</span></p>
</div>
<div class="section" id="id5">
<h5>Command Line Options<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h5>
<dl class="cmdoption">
<dt id="cmdoption-s">
<code class="descname">-s</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-s" title="Permalink to this definition">¶</a></dt>
<dt id="cmdoption-with-source">
<code class="descname">--with-source</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-with-source" title="Permalink to this definition">¶</a></dt>
<dd><p>Show the parsed source structure.</p>
</dd></dl>

<dl class="cmdoption">
<dt id="cmdoption-a">
<code class="descname">-a</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-a" title="Permalink to this definition">¶</a></dt>
<dt id="cmdoption-with-ast">
<code class="descname">--with-ast</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-with-ast" title="Permalink to this definition">¶</a></dt>
<dd><p>Show the generated AST.</p>
</dd></dl>

<dl class="cmdoption">
<dt id="cmdoption-np">
<code class="descname">-np</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-np" title="Permalink to this definition">¶</a></dt>
<dt id="cmdoption-without-python">
<code class="descname">--without-python</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-without-python" title="Permalink to this definition">¶</a></dt>
<dd><p>Do not show the Python code generated from the AST.</p>
</dd></dl>

</div>
</div>
</div>
<span id="document-language/interop"></span><div class="section" id="hy-python-interop">
<h3>Hy &lt;-&gt; Python interop<a class="headerlink" href="#hy-python-interop" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>“Keep in mind we’re not Clojure. We’re not Common Lisp. We’re Homoiconic
Python, with extra bits that make sense.” — Hy Style Guide</div></blockquote>
<p>Despite being a Lisp, Hy aims to be fully compatible with Python. That means
every Python module or package can be imported in Hy code, and vice versa.</p>
<div class="section" id="using-python-from-hy">
<h4>Using Python from Hy<a class="headerlink" href="#using-python-from-hy" title="Permalink to this headline">¶</a></h4>
<p>Using Python from Hy is nice and easy, you just have to <a class="reference internal" href="index.html#import"><span class="std std-ref">import</span></a> it.</p>
<p>If you have the following in <code class="docutils literal"><span class="pre">greetings.py</span></code> in Python:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">greet</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;hello,&quot;</span> <span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
<p>You can use it in Hy:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">import </span><span class="nv">greetings</span><span class="p">)</span>
<span class="p">(</span><span class="nf">.greet</span> <span class="nv">greetings</span> <span class="s">&quot;foo&quot;</span><span class="p">)</span> <span class="c1">; prints &quot;hello, foo&quot;</span>
</pre></div>
</div>
<p>You can also import <code class="docutils literal"><span class="pre">.pyc</span></code> bytecode files, of course.</p>
<div class="section" id="a-quick-note-about-mangling">
<h5>A quick note about mangling<a class="headerlink" href="#a-quick-note-about-mangling" title="Permalink to this headline">¶</a></h5>
<p>In Python, snake_case is used by convention. Lisp dialects tend to use dashes
instead of underscores, so Hy does some magic to give you more pleasant names.</p>
<p>In the same way, <code class="docutils literal"><span class="pre">UPPERCASE_NAMES</span></code> from Python can be used <code class="docutils literal"><span class="pre">*with-earmuffs*</span></code>
instead.</p>
<p>You can use either the original names or the new ones.</p>
<p>Imagine <code class="docutils literal"><span class="pre">example.py</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">function_with_a_long_name</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="n">FOO</span> <span class="o">=</span> <span class="s2">&quot;bar&quot;</span>
</pre></div>
</div>
<p>Then, in Hy:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">import </span><span class="nv">example</span><span class="p">)</span>
<span class="p">(</span><span class="nf">.function-with-a-long-name</span> <span class="nv">example</span><span class="p">)</span> <span class="c1">; prints &quot;42&quot;</span>
<span class="p">(</span><span class="nf">.function_with_a_long_name</span> <span class="nv">example</span><span class="p">)</span> <span class="c1">; also prints &quot;42&quot;</span>

<span class="p">(</span><span class="nb">print </span><span class="p">(</span><span class="k">. </span><span class="nv">example</span> <span class="nv">*foo*</span><span class="p">))</span> <span class="c1">; prints &quot;bar&quot;</span>
<span class="p">(</span><span class="nb">print </span><span class="p">(</span><span class="k">. </span><span class="nv">example</span> <span class="nv">FOO</span><span class="p">))</span>   <span class="c1">; also prints &quot;bar&quot;</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Mangling isn’t that simple; there is more to discuss about it, yet it doesn’t
belong in this section.</p>
</div>
</div>
</div>
<div class="section" id="using-hy-from-python">
<h4>Using Hy from Python<a class="headerlink" href="#using-hy-from-python" title="Permalink to this headline">¶</a></h4>
<p>Suppose you have written some useful utilities in Hy, and you want to use them in
regular Python, or to share them with others as a package. Or suppose you work
with somebody else, who doesn't like Hy (!), and only uses Python.</p>
<p>In any case, you need to know how to use Hy from Python. Fear not, for it is
easy.</p>
<p>If you save the following in <code class="docutils literal"><span class="pre">greetings.hy</span></code>:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">setv</span> <span class="nv">*this-will-be-in-caps-and-underscores*</span> <span class="s">&quot;See?&quot;</span><span class="p">)</span>
<span class="p">(</span><span class="kd">defn </span><span class="nv">greet</span> <span class="p">[</span><span class="nv">name</span><span class="p">]</span> <span class="p">(</span><span class="nf">Print</span> <span class="s">&quot;hello from hy,&quot;</span> <span class="nv">name</span><span class="p">))</span>
</pre></div>
</div>
<p>Then you can use it directly from Python, by importing Hy before importing
the module. In Python:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">hy</span>
<span class="kn">import</span> <span class="nn">greetings</span>

<span class="n">greetings</span><span class="o">.</span><span class="n">greet</span><span class="p">(</span><span class="s2">&quot;Foo&quot;</span><span class="p">)</span> <span class="c1"># prints &quot;Hello from hy, Foo&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">THIS_WILL_BE_IN_CAPS_AND_UNDERSCORES</span><span class="p">)</span> <span class="c1"># prints &quot;See?&quot;</span>
</pre></div>
</div>
<p>If you create a package with Hy code, and you do the <code class="docutils literal"><span class="pre">import</span> <span class="pre">hy</span></code> in
<code class="docutils literal"><span class="pre">__init__.py</span></code>, you can then directly include the package. Of course, Hy still
has to be installed.</p>
<div class="section" id="compiled-files">
<h5>Compiled files<a class="headerlink" href="#compiled-files" title="Permalink to this headline">¶</a></h5>
<p>You can also compile a module with <code class="docutils literal"><span class="pre">hyc</span></code>, which gives you a <code class="docutils literal"><span class="pre">.pyc</span></code> file. You
can import that file. Hy does not <em>really</em> need to be installed ; however, if in
your code, you use any symbol from <a class="reference internal" href="index.html#document-language/core"><span class="doc">Hy Core</span></a>, a corresponding <code class="docutils literal"><span class="pre">import</span></code>
statement will be generated, and Hy will have to be installed.</p>
<p>Even if you do not use a Hy builtin, but just another function or variable with
the name of a Hy builtin, the <code class="docutils literal"><span class="pre">import</span></code> will be generated. For example, the previous code
causes the import of <code class="docutils literal"><span class="pre">name</span></code> from <code class="docutils literal"><span class="pre">hy.core.language</span></code>.</p>
<p><strong>Bottom line: in most cases, Hy has to be installed.</strong></p>
</div>
<div class="section" id="launching-a-hy-repl-from-python">
<h5>Launching a Hy REPL from Python<a class="headerlink" href="#launching-a-hy-repl-from-python" title="Permalink to this headline">¶</a></h5>
<p>You can use the function <code class="docutils literal"><span class="pre">run_repl()</span></code> to launch the Hy REPL from Python:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">hy.cmdline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hy</span><span class="o">.</span><span class="n">cmdline</span><span class="o">.</span><span class="n">run_repl</span><span class="p">()</span>
<span class="go">hy 0.12.1 using CPython(default) 3.6.0 on Linux</span>
<span class="go">=&gt; (defn foo [] (print &quot;bar&quot;))</span>
<span class="go">=&gt; (test)</span>
<span class="go">bar</span>
</pre></div>
</div>
<p>If you want to print the Python code Hy generates for you, use the <code class="docutils literal"><span class="pre">spy</span></code>
argument:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">hy.cmdline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hy</span><span class="o">.</span><span class="n">cmdline</span><span class="o">.</span><span class="n">run_repl</span><span class="p">(</span><span class="n">spy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">hy 0.12.1 using CPython(default) 3.6.0 on Linux</span>
<span class="go">=&gt; (defn test [] (print &quot;bar&quot;))</span>
<span class="go">def test():</span>
<span class="go">    return print(&#39;bar&#39;)</span>
<span class="go">=&gt; (test)</span>
<span class="go">test()</span>
<span class="go">bar</span>
</pre></div>
</div>
</div>
</div>
</div>
<span id="document-language/api"></span><div class="section" id="hy-the-language">
<h3>Hy (the language)<a class="headerlink" href="#hy-the-language" title="Permalink to this headline">¶</a></h3>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This is incomplete; please consider contributing to the documentation
effort.</p>
</div>
<div class="section" id="theory-of-hy">
<h4>Theory of Hy<a class="headerlink" href="#theory-of-hy" title="Permalink to this headline">¶</a></h4>
<p>Hy maintains, over everything else, 100% compatibility in both directions
with Python itself. All Hy code follows a few simple rules. Memorize
this, as it's going to come in handy.</p>
<p>These rules help ensure that Hy code is idiomatic and interfaceable in both
languages.</p>
<blockquote>
<div><ul class="simple">
<li>Symbols in earmuffs will be translated to the upper-cased version of that
string. For example, <code class="docutils literal"><span class="pre">foo</span></code> will become <code class="docutils literal"><span class="pre">FOO</span></code>.</li>
<li>UTF-8 entities will be encoded using
<a class="reference external" href="https://en.wikipedia.org/wiki/Punycode">punycode</a> and prefixed with
<code class="docutils literal"><span class="pre">hy_</span></code>. For instance, <code class="docutils literal"><span class="pre">⚘</span></code> will become <code class="docutils literal"><span class="pre">hy_w7h</span></code>, <code class="docutils literal"><span class="pre">♥</span></code> will become
<code class="docutils literal"><span class="pre">hy_g6h</span></code>, and <code class="docutils literal"><span class="pre">i♥u</span></code> will become <code class="docutils literal"><span class="pre">hy_iu_t0x</span></code>.</li>
<li>Symbols that contain dashes will have them replaced with underscores. For
example, <code class="docutils literal"><span class="pre">render-template</span></code> will become <code class="docutils literal"><span class="pre">render_template</span></code>. This means
that symbols with dashes will shadow their underscore equivalents, and vice
versa.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="notes-on-syntax">
<h4>Notes on Syntax<a class="headerlink" href="#notes-on-syntax" title="Permalink to this headline">¶</a></h4>
<div class="section" id="numeric-literals">
<h5>numeric literals<a class="headerlink" href="#numeric-literals" title="Permalink to this headline">¶</a></h5>
<p>In addition to regular numbers, standard notation from Python 3 for non-base 10
integers is used. <code class="docutils literal"><span class="pre">0x</span></code> for Hex, <code class="docutils literal"><span class="pre">0o</span></code> for Octal, <code class="docutils literal"><span class="pre">0b</span></code> for Binary.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">print </span><span class="mi">0</span><span class="nv">x80</span> <span class="mi">0</span><span class="nv">b11101</span> <span class="mi">0</span><span class="nv">o102</span> <span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
<p>Underscores and commas can appear anywhere in a numeric literal. They have no
effect on the value of the literal, but they're useful for visually separating
digits.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">print </span><span class="mi">10</span>,<span class="mi">000</span>,<span class="mi">000</span>,<span class="mi">000</span> <span class="mi">10</span><span class="nv">_000_000_000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="string-literals">
<h5>string literals<a class="headerlink" href="#string-literals" title="Permalink to this headline">¶</a></h5>
<p>Unlike Python, Hy allows only double-quoted strings (e.g., <code class="docutils literal"><span class="pre">&quot;hello&quot;</span></code>). The
single-quote character <code class="docutils literal"><span class="pre">'</span></code> is reserved for preventing the evaluation of a
form (e.g., <code class="docutils literal"><span class="pre">'(+</span> <span class="pre">1</span> <span class="pre">1)</span></code>), as in most Lisps.</p>
<p>Python's so-called triple-quoted strings (e.g., <code class="docutils literal"><span class="pre">'''hello'''</span></code> and
<code class="docutils literal"><span class="pre">&quot;&quot;&quot;hello&quot;&quot;&quot;</span></code>) aren't supported. However, in Hy, unlike Python, any string
literal can contain newlines.</p>
<p>Whether running under Python 2 or Python 3, Hy treats string literals as
sequences of Unicode characters by default, and allows you to prefix a literal
with <code class="docutils literal"><span class="pre">b</span></code> to treat it as a sequence of bytes. So when running under Python 3,
Hy translates <code class="docutils literal"><span class="pre">&quot;foo&quot;</span></code> and <code class="docutils literal"><span class="pre">b&quot;foo&quot;</span></code> to the identical Python code, but when
running under Python 2, <code class="docutils literal"><span class="pre">&quot;foo&quot;</span></code> is translated to <code class="docutils literal"><span class="pre">u&quot;foo&quot;</span></code> and <code class="docutils literal"><span class="pre">b&quot;foo&quot;</span></code> is
translated to <code class="docutils literal"><span class="pre">&quot;foo&quot;</span></code>.</p>
</div>
<div class="section" id="keywords">
<span id="syntax-keywords"></span><h5>keywords<a class="headerlink" href="#keywords" title="Permalink to this headline">¶</a></h5>
<p>An identifier headed by a colon, such as <code class="docutils literal"><span class="pre">:foo</span></code>, is a keyword. Keywords
evaluate to a string preceded by the Unicode non-character code point U+FDD0,
like <code class="docutils literal"><span class="pre">&quot;\ufdd0:foo&quot;</span></code>, so <code class="docutils literal"><span class="pre">:foo</span></code> and <code class="docutils literal"><span class="pre">&quot;:foo&quot;</span></code> aren't equal. However, if a
literal keyword appears in a function call, it's used to indicate a keyword
argument rather than passed in as a value. For example, <code class="docutils literal"><span class="pre">(f</span> <span class="pre">:foo</span> <span class="pre">3)</span></code> calls
the function <code class="docutils literal"><span class="pre">f</span></code> with the keyword argument named <code class="docutils literal"><span class="pre">foo</span></code> set to <code class="docutils literal"><span class="pre">3</span></code>. Hence,
trying to call a function on a literal keyword may fail: <code class="docutils literal"><span class="pre">(f</span> <span class="pre">:foo)</span></code> yields
the error <code class="docutils literal"><span class="pre">Keyword</span> <span class="pre">argument</span> <span class="pre">:foo</span> <span class="pre">needs</span> <span class="pre">a</span> <span class="pre">value</span></code>. To avoid this, you can quote
the keyword, as in <code class="docutils literal"><span class="pre">(f</span> <span class="pre">':foo)</span></code>, or use it as the value of another keyword
argument, as in <code class="docutils literal"><span class="pre">(f</span> <span class="pre">:arg</span> <span class="pre">:foo)</span></code>.</p>
</div>
</div>
<div class="section" id="built-ins">
<h4>Built-Ins<a class="headerlink" href="#built-ins" title="Permalink to this headline">¶</a></h4>
<p>Hy features a number of special forms that are used to help generate
correct Python AST. The following are &quot;special&quot; forms, which may have
behavior that's slightly unexpected in some situations.</p>
<div class="section" id="id1">
<h5>.<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h5>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.10.0.</span></p>
</div>
<p><code class="docutils literal"><span class="pre">.</span></code> is used to perform attribute access on objects. It uses a small DSL
to allow quick access to attributes and items in a nested data structure.</p>
<p>For instance,</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">. </span><span class="nv">foo</span> <span class="nv">bar</span> <span class="nv">baz</span> <span class="p">[(</span><span class="nb">+ </span><span class="mi">1</span> <span class="mi">2</span><span class="p">)]</span> <span class="nv">frob</span><span class="p">)</span>
</pre></div>
</div>
<p>Compiles down to:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">foo</span><span class="o">.</span><span class="n">bar</span><span class="o">.</span><span class="n">baz</span><span class="p">[</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">frob</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">.</span></code> compiles its first argument (in the example, <em>foo</em>) as the object on
which to do the attribute dereference. It uses bare symbols as attributes
to access (in the example, <em>bar</em>, <em>baz</em>, <em>frob</em>), and compiles the contents
of lists (in the example, <code class="docutils literal"><span class="pre">[(+</span> <span class="pre">1</span> <span class="pre">2)]</span></code>) for indexation. Other arguments
raise a compilation error.</p>
<p>Access to unknown attributes raises an <code class="xref py py-exc docutils literal"><span class="pre">AttributeError</span></code>. Access to
unknown keys raises an <code class="xref py py-exc docutils literal"><span class="pre">IndexError</span></code> (on lists and tuples) or a
<code class="xref py py-exc docutils literal"><span class="pre">KeyError</span></code> (on dictionaries).</p>
</div>
<div class="section" id="id2">
<h5>-&gt;<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h5>
<p><code class="docutils literal"><span class="pre">-&gt;</span></code> (or the <em>threading macro</em>) is used to avoid nesting of expressions. The
threading macro inserts each expression into the next expression's first argument
place. The following code demonstrates this:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">(</span><span class="kd">defn </span><span class="nv">output</span> <span class="p">[</span><span class="nv">a</span> <span class="nv">b</span><span class="p">]</span> <span class="p">(</span><span class="nb">print </span><span class="nv">a</span> <span class="nv">b</span><span class="p">))</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">-&gt; </span><span class="p">(</span><span class="nb">+ </span><span class="mi">4</span> <span class="mi">6</span><span class="p">)</span> <span class="p">(</span><span class="nf">output</span> <span class="mi">5</span><span class="p">))</span>
<span class="mi">10</span> <span class="mi">5</span>
</pre></div>
</div>
</div>
<div class="section" id="id3">
<h5>-&gt;&gt;<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h5>
<p><code class="docutils literal"><span class="pre">-&gt;&gt;</span></code> (or the <em>threading tail macro</em>) is similar to the <em>threading macro</em>, but
instead of inserting each expression into the next expression's first argument,
it appends it as the last argument. The following code demonstrates this:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">(</span><span class="kd">defn </span><span class="nv">output</span> <span class="p">[</span><span class="nv">a</span> <span class="nv">b</span><span class="p">]</span> <span class="p">(</span><span class="nb">print </span><span class="nv">a</span> <span class="nv">b</span><span class="p">))</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">-&gt;&gt;</span> <span class="p">(</span><span class="nb">+ </span><span class="mi">4</span> <span class="mi">6</span><span class="p">)</span> <span class="p">(</span><span class="nf">output</span> <span class="mi">5</span><span class="p">))</span>
<span class="mi">5</span> <span class="mi">10</span>
</pre></div>
</div>
</div>
<div class="section" id="apply">
<h5>apply<a class="headerlink" href="#apply" title="Permalink to this headline">¶</a></h5>
<p><code class="docutils literal"><span class="pre">apply</span></code> is used to apply an optional list of arguments and an
optional dictionary of kwargs to a function. The symbol mangling
transformations will be applied to all keys in the dictionary of
kwargs, provided the dictionary and its keys are defined in-place.</p>
<p>Usage: <code class="docutils literal"><span class="pre">(apply</span> <span class="pre">fn-name</span> <span class="pre">[args]</span> <span class="pre">[kwargs])</span></code></p>
<p>Examples:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="kd">defn </span><span class="nv">thunk</span> <span class="p">[]</span>
  <span class="s">&quot;hy there&quot;</span><span class="p">)</span>

<span class="p">(</span><span class="nb">apply </span><span class="nv">thunk</span><span class="p">)</span>
<span class="c1">;=&gt; &quot;hy there&quot;</span>

<span class="p">(</span><span class="kd">defn </span><span class="nv">total-purchase</span> <span class="p">[</span><span class="nv">price</span> <span class="nv">amount</span> <span class="o">&amp;</span><span class="nv">optional</span> <span class="p">[</span><span class="nv">fees</span> <span class="mf">1.05</span><span class="p">]</span> <span class="p">[</span><span class="nv">vat</span> <span class="mf">1.1</span><span class="p">]]</span>
  <span class="p">(</span><span class="nb">* </span><span class="nv">price</span> <span class="nv">amount</span> <span class="nv">fees</span> <span class="nv">vat</span><span class="p">))</span>

<span class="p">(</span><span class="nb">apply </span><span class="nv">total-purchase</span> <span class="p">[</span><span class="mi">10</span> <span class="mi">15</span><span class="p">])</span>
<span class="c1">;=&gt; 173.25</span>

<span class="p">(</span><span class="nb">apply </span><span class="nv">total-purchase</span> <span class="p">[</span><span class="mi">10</span> <span class="mi">15</span><span class="p">]</span> <span class="p">{</span><span class="s">&quot;vat&quot;</span> <span class="mf">1.05</span><span class="p">})</span>
<span class="c1">;=&gt; 165.375</span>

<span class="p">(</span><span class="nb">apply </span><span class="nv">total-purchase</span> <span class="p">[]</span> <span class="p">{</span><span class="s">&quot;price&quot;</span> <span class="mi">10</span> <span class="s">&quot;amount&quot;</span> <span class="mi">15</span> <span class="s">&quot;vat&quot;</span> <span class="mf">1.05</span><span class="p">})</span>
<span class="c1">;=&gt; 165.375</span>

<span class="p">(</span><span class="nb">apply </span><span class="nv">total-purchase</span> <span class="p">[]</span> <span class="p">{</span><span class="ss">:price</span> <span class="mi">10</span> <span class="ss">:amount</span> <span class="mi">15</span> <span class="ss">:vat</span> <span class="mf">1.05</span><span class="p">})</span>
<span class="c1">;=&gt; 165.375</span>
</pre></div>
</div>
</div>
<div class="section" id="and">
<h5>and<a class="headerlink" href="#and" title="Permalink to this headline">¶</a></h5>
<p><code class="docutils literal"><span class="pre">and</span></code> is used in logical expressions. It takes at least two parameters. If
all parameters evaluate to <code class="docutils literal"><span class="pre">True</span></code>, the last parameter is returned. In any
other case, the first false value will be returned. Example usage:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">and </span><span class="nv">True</span> <span class="nv">False</span><span class="p">)</span>
<span class="nv">False</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">and </span><span class="nv">True</span> <span class="nv">True</span><span class="p">)</span>
<span class="nv">True</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">and </span><span class="nv">True</span> <span class="mi">1</span><span class="p">)</span>
<span class="mi">1</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">and </span><span class="nv">True</span> <span class="p">[]</span> <span class="nv">False</span> <span class="nv">True</span><span class="p">)</span>
<span class="p">[]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><code class="docutils literal"><span class="pre">and</span></code> short-circuits and stops evaluating parameters as soon as the first
false is encountered.</p>
</div>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">and </span><span class="nv">False</span> <span class="p">(</span><span class="nb">print </span><span class="s">&quot;hello&quot;</span><span class="p">))</span>
<span class="nv">False</span>
</pre></div>
</div>
</div>
<div class="section" id="as">
<h5>as-&gt;<a class="headerlink" href="#as" title="Permalink to this headline">¶</a></h5>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.12.0.</span></p>
</div>
<p>Expands to sequence of assignments to the provided name, starting with head.
The previous result is thus available in the subsequent form. Returns the final
result, and leaves the name bound to it in the local scope. This behaves much
like the other threading macros, but requires you to specify the threading
point per form via the name instead of always the first or last argument.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span>;; example how -&gt; and as-&gt; relate

=&gt; (as-&gt; 0 it
...      (inc it)
...      (inc it))
2

=&gt; (-&gt; 0 inc inc)
2

;; create data for our cuttlefish database

=&gt; (setv data [{:name &quot;hooded cuttlefish&quot;
...             :classification {:subgenus &quot;Acanthosepion&quot;
...                              :species &quot;Sepia prashadi&quot;}
...             :discovered {:year 1936
...                          :name &quot;Ronald Winckworth&quot;}}
...            {:name &quot;slender cuttlefish&quot;
...             :classification {:subgenus &quot;Doratosepion&quot;
...                              :species &quot;Sepia braggi&quot;}
...             :discovered {:year 1907
...                          :name &quot;Sir Joseph Cooke Verco&quot;}}])

;; retrieve name of first entry
=&gt; (as-&gt; (first data) it
...      (:name it))
&#39;hooded cuttlefish&#39;

;; retrieve species of first entry
=&gt; (as-&gt; (first data) it
...      (:classification it)
...      (:species it))
&#39;Sepia prashadi&#39;

;; find out who discovered slender cuttlefish
=&gt; (as-&gt; (filter (fn [entry] (= (:name entry)
...                           &quot;slender cuttlefish&quot;)) data) it
...      (first it)
...      (:discovered it)
...      (:name it))
&#39;Sir Joseph Cooke Verco&#39;

;; more convoluted example to load web page and retrieve data from it
=&gt; (import [urllib.request [urlopen]])
=&gt; (as-&gt; (urlopen &quot;http://docs.hylang.org/en/stable/&quot;) it
...      (.read it)
...      (.decode it &quot;utf-8&quot;)
...      (drop (.index it &quot;Welcome&quot;) it)
...      (take 30 it)
...      (list it)
...      (.join &quot;&quot; it))
&#39;Welcome to Hy’s documentation!
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In these examples, the REPL will report a tuple (e.g. <cite>('Sepia prashadi',
'Sepia prashadi')</cite>) as the result, but only a single value is actually
returned.</p>
</div>
</div>
<div class="section" id="assert">
<h5>assert<a class="headerlink" href="#assert" title="Permalink to this headline">¶</a></h5>
<p><code class="docutils literal"><span class="pre">assert</span></code> is used to verify conditions while the program is
running. If the condition is not met, an <code class="xref py py-exc docutils literal"><span class="pre">AssertionError</span></code> is
raised. <code class="docutils literal"><span class="pre">assert</span></code> may take one or two parameters.  The first
parameter is the condition to check, and it should evaluate to either
<code class="docutils literal"><span class="pre">True</span></code> or <code class="docutils literal"><span class="pre">False</span></code>. The second parameter, optional, is a label for
the assert, and is the string that will be raised with the
<code class="xref py py-exc docutils literal"><span class="pre">AssertionError</span></code>. For example:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">assert </span><span class="p">(</span><span class="nb">= </span><span class="nv">variable</span> <span class="nv">expected-value</span><span class="p">))</span>

<span class="p">(</span><span class="nb">assert </span><span class="nv">False</span><span class="p">)</span>
<span class="c1">; AssertionError</span>

<span class="p">(</span><span class="nb">assert </span><span class="p">(</span><span class="nb">= </span><span class="mi">1</span> <span class="mi">2</span><span class="p">)</span> <span class="s">&quot;one should equal two&quot;</span><span class="p">)</span>
<span class="c1">; AssertionError: one should equal two</span>
</pre></div>
</div>
</div>
<div class="section" id="assoc">
<h5>assoc<a class="headerlink" href="#assoc" title="Permalink to this headline">¶</a></h5>
<p><code class="docutils literal"><span class="pre">assoc</span></code> is used to associate a key with a value in a dictionary or to set an
index of a list to a value. It takes at least three parameters: the <em>data
structure</em> to be modified, a <em>key</em> or <em>index</em>, and a <em>value</em>. If more than
three parameters are used, it will associate in pairs.</p>
<p>Examples of usage:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span>=&gt;(do
... (setv collection {})
... (assoc collection &quot;Dog&quot; &quot;Bark&quot;)
... (print collection))
{u&#39;Dog&#39;: u&#39;Bark&#39;}

=&gt;(do
... (setv collection {})
... (assoc collection &quot;Dog&quot; &quot;Bark&quot; &quot;Cat&quot; &quot;Meow&quot;)
... (print collection))
{u&#39;Cat&#39;: u&#39;Meow&#39;, u&#39;Dog&#39;: u&#39;Bark&#39;}

=&gt;(do
... (setv collection [1 2 3 4])
... (assoc collection 2 None)
... (print collection))
[1, 2, None, 4]
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><code class="docutils literal"><span class="pre">assoc</span></code> modifies the datastructure in place and returns <code class="docutils literal"><span class="pre">None</span></code>.</p>
</div>
</div>
<div class="section" id="break">
<h5>break<a class="headerlink" href="#break" title="Permalink to this headline">¶</a></h5>
<p><code class="docutils literal"><span class="pre">break</span></code> is used to break out from a loop. It terminates the loop immediately.
The following example has an infinite <code class="docutils literal"><span class="pre">while</span></code> loop that is terminated as soon
as the user enters <em>k</em>.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">while</span> <span class="nv">True</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="s">&quot;k&quot;</span> <span class="p">(</span><span class="nf">raw-input</span> <span class="s">&quot;? &quot;</span><span class="p">))</span>
              <span class="p">(</span><span class="nf">break</span><span class="p">)</span>
              <span class="p">(</span><span class="nb">print </span><span class="s">&quot;Try again&quot;</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="section" id="cond">
<h5>cond<a class="headerlink" href="#cond" title="Permalink to this headline">¶</a></h5>
<p><code class="docutils literal"><span class="pre">cond</span></code> can be used to build nested <code class="docutils literal"><span class="pre">if</span></code> statements. The following example
shows the relationship between the macro and its expansion:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">cond </span><span class="p">[</span><span class="nv">condition-1</span> <span class="nv">result-1</span><span class="p">]</span>
      <span class="p">[</span><span class="nv">condition-2</span> <span class="nv">result-2</span><span class="p">])</span>

<span class="p">(</span><span class="k">if </span><span class="nv">condition-1</span> <span class="nv">result-1</span>
  <span class="p">(</span><span class="k">if </span><span class="nv">condition-2</span> <span class="nv">result-2</span><span class="p">))</span>
</pre></div>
</div>
<p>If only the condition is given in a branch, then the condition is also used as
the result. The expansion of this single argument version is demonstrated
below:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">cond </span><span class="p">[</span><span class="nv">condition-1</span><span class="p">]</span>
      <span class="p">[</span><span class="nv">condition-2</span><span class="p">])</span>

<span class="p">(</span><span class="k">if </span><span class="nv">condition-1</span> <span class="nv">condition-1</span>
  <span class="p">(</span><span class="k">if </span><span class="nv">condition-2</span> <span class="nv">condition-2</span><span class="p">))</span>
</pre></div>
</div>
<p>As shown below, only the first matching result block is executed.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">(</span><span class="kd">defn </span><span class="nv">check-value</span> <span class="p">[</span><span class="nv">value</span><span class="p">]</span>
<span class="nv">...</span>  <span class="p">(</span><span class="nb">cond </span><span class="p">[(</span><span class="nb">&lt; </span><span class="nv">value</span> <span class="mi">5</span><span class="p">)</span> <span class="p">(</span><span class="nb">print </span><span class="s">&quot;value is smaller than 5&quot;</span><span class="p">)]</span>
<span class="nv">...</span>        <span class="p">[(</span><span class="nb">= </span><span class="nv">value</span> <span class="mi">5</span><span class="p">)</span> <span class="p">(</span><span class="nb">print </span><span class="s">&quot;value is equal to 5&quot;</span><span class="p">)]</span>
<span class="nv">...</span>        <span class="p">[(</span><span class="nb">&gt; </span><span class="nv">value</span> <span class="mi">5</span><span class="p">)</span> <span class="p">(</span><span class="nb">print </span><span class="s">&quot;value is greater than 5&quot;</span><span class="p">)]</span>
<span class="nv">...</span>        <span class="p">[</span><span class="nv">True</span> <span class="p">(</span><span class="nb">print </span><span class="s">&quot;value is something that it should not be&quot;</span><span class="p">)]))</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">check-value</span> <span class="mi">6</span><span class="p">)</span>
<span class="nv">value</span> <span class="nv">is</span> <span class="nv">greater</span> <span class="nv">than</span> <span class="mi">5</span>
</pre></div>
</div>
</div>
<div class="section" id="continue">
<h5>continue<a class="headerlink" href="#continue" title="Permalink to this headline">¶</a></h5>
<p><code class="docutils literal"><span class="pre">continue</span></code> returns execution to the start of a loop. In the following example,
<code class="docutils literal"><span class="pre">(side-effect1)</span></code> is called for each iteration. <code class="docutils literal"><span class="pre">(side-effect2)</span></code>, however,
is only called on every other value in the list.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="c1">;; assuming that (side-effect1) and (side-effect2) are functions and</span>
<span class="c1">;; collection is a list of numerical values</span>

<span class="p">(</span><span class="nb">for </span><span class="p">[</span><span class="nv">x</span> <span class="nv">collection</span><span class="p">]</span>
  <span class="p">(</span><span class="nf">side-effect1</span> <span class="nv">x</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">%</span> <span class="nv">x</span> <span class="mi">2</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">continue</span><span class="p">))</span>
  <span class="p">(</span><span class="nf">side-effect2</span> <span class="nv">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="dict-comp">
<h5>dict-comp<a class="headerlink" href="#dict-comp" title="Permalink to this headline">¶</a></h5>
<p><code class="docutils literal"><span class="pre">dict-comp</span></code> is used to create dictionaries. It takes three or four parameters.
The first two parameters are for controlling the return value (key-value pair)
while the third is used to select items from a sequence. The fourth and optional
parameter can be used to filter out some of the items in the sequence based on a
conditional expression.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">dict</span><span class="o">-</span><span class="n">comp</span> <span class="n">x</span> <span class="o">(*</span> <span class="n">x</span> <span class="mi">2</span><span class="o">)</span> <span class="o">[</span><span class="n">x</span> <span class="o">(</span><span class="n">range</span> <span class="mi">10</span><span class="o">)]</span> <span class="o">(</span><span class="n">odd</span><span class="o">?</span> <span class="n">x</span><span class="o">))</span>
<span class="o">{</span><span class="mi">1</span><span class="o">:</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">:</span> <span class="mi">6</span><span class="o">,</span> <span class="mi">9</span><span class="o">:</span> <span class="mi">18</span><span class="o">,</span> <span class="mi">5</span><span class="o">:</span> <span class="mi">10</span><span class="o">,</span> <span class="mi">7</span><span class="o">:</span> <span class="mi">14</span><span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="do">
<h5>do<a class="headerlink" href="#do" title="Permalink to this headline">¶</a></h5>
<p><code class="docutils literal"><span class="pre">do</span></code> is used to evaluate each of its arguments and return the
last one. Return values from every other than the last argument are discarded.
It can be used in <code class="docutils literal"><span class="pre">list-comp</span></code> to perform more complex logic as shown in one
of the following examples.</p>
<p>Some example usage:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">(</span><span class="k">if </span><span class="nv">True</span>
<span class="nv">...</span>  <span class="p">(</span><span class="k">do </span><span class="p">(</span><span class="nb">print </span><span class="s">&quot;Side effects rock!&quot;</span><span class="p">)</span>
<span class="nv">...</span>      <span class="p">(</span><span class="nb">print </span><span class="s">&quot;Yeah, really!&quot;</span><span class="p">)))</span>
<span class="nv">Side</span> <span class="nv">effects</span> <span class="nv">rock!</span>
<span class="nv">Yeah</span>, <span class="nv">really!</span>

<span class="c1">;; assuming that (side-effect) is a function that we want to call for each</span>
<span class="c1">;; and every value in the list, but whose return value we do not care about</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">list-comp</span> <span class="p">(</span><span class="k">do </span><span class="p">(</span><span class="nf">side-effect</span> <span class="nv">x</span><span class="p">)</span>
<span class="nv">...</span>               <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&lt; </span><span class="nv">x</span> <span class="mi">5</span><span class="p">)</span> <span class="p">(</span><span class="nb">* </span><span class="mi">2</span> <span class="nv">x</span><span class="p">)</span>
<span class="nv">...</span>                   <span class="p">(</span><span class="nb">* </span><span class="mi">4</span> <span class="nv">x</span><span class="p">)))</span>
<span class="nv">...</span>           <span class="p">(</span><span class="nf">x</span> <span class="p">(</span><span class="nb">range </span><span class="mi">10</span><span class="p">)))</span>
<span class="p">[</span><span class="mi">0</span>, <span class="mi">2</span>, <span class="mi">4</span>, <span class="mi">6</span>, <span class="mi">8</span>, <span class="mi">20</span>, <span class="mi">24</span>, <span class="mi">28</span>, <span class="mi">32</span>, <span class="mi">36</span><span class="p">]</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">do</span></code> can accept any number of arguments, from 1 to n.</p>
</div>
<div class="section" id="def-setv">
<h5>def / setv<a class="headerlink" href="#def-setv" title="Permalink to this headline">¶</a></h5>
<p><code class="docutils literal"><span class="pre">def</span></code> and <code class="docutils literal"><span class="pre">setv</span></code> are used to bind a value, object, or function to a symbol.
For example:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">(</span><span class="k">def </span><span class="nv">names</span> <span class="p">[</span><span class="s">&quot;Alice&quot;</span> <span class="s">&quot;Bob&quot;</span> <span class="s">&quot;Charlie&quot;</span><span class="p">])</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">print </span><span class="nv">names</span><span class="p">)</span>
<span class="p">[</span><span class="nv">u</span><span class="ss">&#39;Alice</span><span class="o">&#39;</span>, <span class="nv">u</span><span class="ss">&#39;Bob</span><span class="o">&#39;</span>, <span class="nv">u</span><span class="ss">&#39;Charlie</span><span class="o">&#39;</span><span class="p">]</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">setv</span> <span class="nv">counter</span> <span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">collection</span> <span class="nv">item</span><span class="p">]</span> <span class="p">(</span><span class="nf">.count</span> <span class="nv">collection</span> <span class="nv">item</span><span class="p">)))</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">counter</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">]</span> <span class="mi">2</span><span class="p">)</span>
<span class="mi">2</span>
</pre></div>
</div>
<p>They can be used to assign multiple variables at once:</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">setv</span> <span class="n">a</span> <span class="mi">1</span> <span class="n">b</span> <span class="mi">2</span><span class="o">)</span>
<span class="o">(</span><span class="mi">1L</span><span class="o">,</span> <span class="mi">2L</span><span class="o">)</span>
<span class="o">=&gt;</span> <span class="n">a</span>
<span class="mi">1L</span>
<span class="o">=&gt;</span> <span class="n">b</span>
<span class="mi">2L</span>
<span class="o">=&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="defclass">
<h5>defclass<a class="headerlink" href="#defclass" title="Permalink to this headline">¶</a></h5>
<p>New classes are declared with <code class="docutils literal"><span class="pre">defclass</span></code>. It can takes two optional parameters:
a vector defining a possible super classes and another vector containing
attributes of the new class as two item vectors.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">defclass</span> <span class="nv">class-name</span> <span class="p">[</span><span class="nv">super-class-1</span> <span class="nv">super-class-2</span><span class="p">]</span>
  <span class="p">[</span><span class="nv">attribute</span> <span class="nv">value</span><span class="p">]</span>

  <span class="p">(</span><span class="kd">defn </span><span class="nv">method</span> <span class="p">[</span><span class="nv">self</span><span class="p">]</span> <span class="p">(</span><span class="nb">print </span><span class="s">&quot;hello!&quot;</span><span class="p">)))</span>
</pre></div>
</div>
<p>Both values and functions can be bound on the new class as shown by the example
below:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">defclass</span> <span class="nv">Cat</span> <span class="p">[]</span>
<span class="nv">...</span>  <span class="p">[</span><span class="nv">age</span> <span class="nv">None</span>
<span class="nv">...</span>   <span class="nv">colour</span> <span class="s">&quot;white&quot;</span><span class="p">]</span>
<span class="nv">...</span>
<span class="nv">...</span>  <span class="p">(</span><span class="kd">defn </span><span class="nv">speak</span> <span class="p">[</span><span class="nv">self</span><span class="p">]</span> <span class="p">(</span><span class="nb">print </span><span class="s">&quot;Meow&quot;</span><span class="p">)))</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="k">def </span><span class="nv">spot</span> <span class="p">(</span><span class="nf">Cat</span><span class="p">))</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">setv</span> <span class="nv">spot.colour</span> <span class="s">&quot;Black&quot;</span><span class="p">)</span>
<span class="ss">&#39;Black</span><span class="o">&#39;</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">.speak</span> <span class="nv">spot</span><span class="p">)</span>
<span class="nv">Meow</span>
</pre></div>
</div>
</div>
<div class="section" id="defn">
<span id="id4"></span><h5>defn<a class="headerlink" href="#defn" title="Permalink to this headline">¶</a></h5>
<p><code class="docutils literal"><span class="pre">defn</span></code> macro is used to define functions. It takes three
parameters: the <em>name</em> of the function to define, a vector of <em>parameters</em>,
and the <em>body</em> of the function:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="kd">defn </span><span class="nb">name </span><span class="p">[</span><span class="nv">params</span><span class="p">]</span> <span class="nv">body</span><span class="p">)</span>
</pre></div>
</div>
<p>Parameters may have the following keywords in front of them:</p>
<dl class="docutils">
<dt>&amp;optional</dt>
<dd><p class="first">Parameter is optional. The parameter can be given as a two item list, where
the first element is parameter name and the second is the default value. The
parameter can be also given as a single item, in which case the default
value is <code class="docutils literal"><span class="pre">None</span></code>.</p>
<div class="last highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">(</span><span class="kd">defn </span><span class="nv">total-value</span> <span class="p">[</span><span class="nv">value</span> <span class="o">&amp;</span><span class="nv">optional</span> <span class="p">[</span><span class="nv">value-added-tax</span> <span class="mi">10</span><span class="p">]]</span>
<span class="nv">...</span>  <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nb">* </span><span class="nv">value</span> <span class="nv">value-added-tax</span><span class="p">)</span> <span class="mi">100</span><span class="p">)</span> <span class="nv">value</span><span class="p">))</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">total-value</span> <span class="mi">100</span><span class="p">)</span>
<span class="mf">110.0</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">total-value</span> <span class="mi">100</span> <span class="mi">1</span><span class="p">)</span>
<span class="mf">101.0</span>
</pre></div>
</div>
</dd>
<dt>&amp;key</dt>
<dd><p class="first">Parameter is a dict of keyword arguments. The keys of the dict
specify the parameter names and the values give the default values
of the parameters.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">(</span><span class="kd">defn </span><span class="nv">key-parameters</span> <span class="p">[</span><span class="o">&amp;</span><span class="nb">key </span><span class="p">{</span><span class="s">&quot;a&quot;</span> <span class="mi">1</span> <span class="s">&quot;b&quot;</span> <span class="mi">2</span><span class="p">}]</span>
<span class="nv">...</span> <span class="p">(</span><span class="nb">print </span><span class="s">&quot;a is&quot;</span> <span class="nv">a</span> <span class="s">&quot;and b is&quot;</span> <span class="nv">b</span><span class="p">))</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">key-parameters</span> <span class="ss">:a</span> <span class="mi">1</span> <span class="ss">:b</span> <span class="mi">2</span><span class="p">)</span>
<span class="nv">a</span> <span class="nv">is</span> <span class="mi">1</span> <span class="nb">and </span><span class="nv">b</span> <span class="nv">is</span> <span class="mi">2</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">key-parameters</span> <span class="ss">:b</span> <span class="mi">1</span> <span class="ss">:a</span> <span class="mi">2</span><span class="p">)</span>
<span class="nv">a</span> <span class="nv">is</span> <span class="mi">2</span> <span class="nb">and </span><span class="nv">b</span> <span class="nv">is</span> <span class="mi">1</span>
</pre></div>
</div>
<p>The following declarations are equivalent:</p>
<div class="last highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="kd">defn </span><span class="nv">key-parameters</span> <span class="p">[</span><span class="o">&amp;</span><span class="nb">key </span><span class="p">{</span><span class="s">&quot;a&quot;</span> <span class="mi">1</span> <span class="s">&quot;b&quot;</span> <span class="mi">2</span><span class="p">}])</span>

<span class="p">(</span><span class="kd">defn </span><span class="nv">key-parameters</span> <span class="p">[</span><span class="o">&amp;</span><span class="nv">optional</span> <span class="p">[</span><span class="nv">a</span> <span class="mi">1</span><span class="p">]</span> <span class="p">[</span><span class="nv">b</span> <span class="mi">2</span><span class="p">]])</span>
</pre></div>
</div>
</dd>
<dt>&amp;kwargs</dt>
<dd><p class="first">Parameter will contain 0 or more keyword arguments.</p>
<p>The following code examples defines a function that will print all keyword
arguments and their values.</p>
<div class="last highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">(</span><span class="kd">defn </span><span class="nv">print-parameters</span> <span class="p">[</span><span class="o">&amp;</span><span class="nv">kwargs</span> <span class="nv">kwargs</span><span class="p">]</span>
<span class="nv">...</span>    <span class="p">(</span><span class="nb">for </span><span class="p">[(</span>, <span class="nv">k</span> <span class="nv">v</span><span class="p">)</span> <span class="p">(</span><span class="nf">.items</span> <span class="nv">kwargs</span><span class="p">)]</span> <span class="p">(</span><span class="nb">print </span><span class="nv">k</span> <span class="nv">v</span><span class="p">)))</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">print-parameters</span> <span class="ss">:parameter-1</span> <span class="mi">1</span> <span class="ss">:parameter-2</span> <span class="mi">2</span><span class="p">)</span>
<span class="nv">parameter_1</span> <span class="mi">1</span>
<span class="nv">parameter_2</span> <span class="mi">2</span>

<span class="c1">; to avoid the mangling of &#39;-&#39; to &#39;_&#39;, use apply:</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">apply </span><span class="nv">print-parameters</span> <span class="p">[]</span> <span class="p">{</span><span class="s">&quot;parameter-1&quot;</span> <span class="mi">1</span> <span class="s">&quot;parameter-2&quot;</span> <span class="mi">2</span><span class="p">})</span>
<span class="nv">parameter-1</span> <span class="mi">1</span>
<span class="nv">parameter-2</span> <span class="mi">2</span>
</pre></div>
</div>
</dd>
<dt>&amp;rest</dt>
<dd><p class="first">Parameter will contain 0 or more positional arguments. No other positional
arguments may be specified after this one.</p>
<p>The following code example defines a function that can be given 0 to n
numerical parameters. It then sums every odd number and subtracts
every even number.</p>
<div class="last highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">(</span><span class="kd">defn </span><span class="nv">zig-zag-sum</span> <span class="p">[</span><span class="o">&amp;</span><span class="nb">rest </span><span class="nv">numbers</span><span class="p">]</span>
     <span class="p">(</span><span class="nf">setv</span> <span class="nv">odd-numbers</span> <span class="p">(</span><span class="nf">list-comp</span> <span class="nv">x</span> <span class="p">[</span><span class="nv">x</span> <span class="nv">numbers</span><span class="p">]</span> <span class="p">(</span><span class="nf">odd?</span> <span class="nv">x</span><span class="p">))</span>
           <span class="nv">even-numbers</span> <span class="p">(</span><span class="nf">list-comp</span> <span class="nv">x</span> <span class="p">[</span><span class="nv">x</span> <span class="nv">numbers</span><span class="p">]</span> <span class="p">(</span><span class="nf">even?</span> <span class="nv">x</span><span class="p">)))</span>
     <span class="p">(</span><span class="nb">- </span><span class="p">(</span><span class="nf">sum</span> <span class="nv">odd-numbers</span><span class="p">)</span> <span class="p">(</span><span class="nf">sum</span> <span class="nv">even-numbers</span><span class="p">)))</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">zig-zag-sum</span><span class="p">)</span>
<span class="mi">0</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">zig-zag-sum</span> <span class="mi">3</span> <span class="mi">9</span> <span class="mi">4</span><span class="p">)</span>
<span class="mi">8</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">zig-zag-sum</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span><span class="p">)</span>
<span class="mi">-3</span>
</pre></div>
</div>
</dd>
<dt>&amp;kwonly</dt>
<dd><div class="first versionadded">
<p><span class="versionmodified">New in version 0.12.0.</span></p>
</div>
<p>Parameters that can only be called as keywords. Mandatory
keyword-only arguments are declared with the argument's name;
optional keyword-only arguments are declared as a two-element list
containing the argument name followed by the default value (as
with <cite>&amp;optional</cite> above).</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">(</span><span class="kd">defn </span><span class="nv">compare</span> <span class="p">[</span><span class="nv">a</span> <span class="nv">b</span> <span class="o">&amp;</span><span class="nv">kwonly</span> <span class="nv">keyfn</span> <span class="p">[</span><span class="nb">reverse </span><span class="nv">false</span><span class="p">]]</span>
<span class="nv">...</span>  <span class="p">(</span><span class="nf">setv</span> <span class="nv">result</span> <span class="p">(</span><span class="nf">keyfn</span> <span class="nv">a</span> <span class="nv">b</span><span class="p">))</span>
<span class="nv">...</span>  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">not </span><span class="nv">reverse</span><span class="p">)</span>
<span class="nv">...</span>    <span class="nv">result</span>
<span class="nv">...</span>    <span class="p">(</span><span class="nb">- </span><span class="nv">result</span><span class="p">)))</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">apply </span><span class="nv">compare</span> <span class="p">[</span><span class="s">&quot;lisp&quot;</span> <span class="s">&quot;python&quot;</span><span class="p">]</span>
<span class="nv">...</span>        <span class="p">{</span><span class="s">&quot;keyfn&quot;</span> <span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">x</span> <span class="nv">y</span><span class="p">]</span>
<span class="nv">...</span>                   <span class="p">(</span><span class="nb">reduce - </span><span class="p">(</span><span class="nb">map </span><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">s</span><span class="p">]</span> <span class="p">(</span><span class="nf">ord</span> <span class="p">(</span><span class="nb">first </span><span class="nv">s</span><span class="p">)))</span> <span class="p">[</span><span class="nv">x</span> <span class="nv">y</span><span class="p">])))})</span>
<span class="mi">-4</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">apply </span><span class="nv">compare</span> <span class="p">[</span><span class="s">&quot;lisp&quot;</span> <span class="s">&quot;python&quot;</span><span class="p">]</span>
<span class="nv">...</span>        <span class="p">{</span><span class="s">&quot;keyfn&quot;</span> <span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">x</span> <span class="nv">y</span><span class="p">]</span>
<span class="nv">...</span>                   <span class="p">(</span><span class="nb">reduce - </span><span class="p">(</span><span class="nb">map </span><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">s</span><span class="p">]</span> <span class="p">(</span><span class="nf">ord</span> <span class="p">(</span><span class="nb">first </span><span class="nv">s</span><span class="p">)))</span> <span class="p">[</span><span class="nv">x</span> <span class="nv">y</span><span class="p">])))</span>
<span class="nv">...</span>         <span class="s">&quot;reverse&quot;</span> <span class="nv">True</span><span class="p">})</span>
<span class="mi">4</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="p">(</span><span class="n">compare</span> <span class="s2">&quot;lisp&quot;</span> <span class="s2">&quot;python&quot;</span><span class="p">)</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s2">&quot;&lt;input&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">TypeError</span><span class="p">:</span> <span class="n">compare</span><span class="p">()</span> <span class="n">missing</span> <span class="mi">1</span> <span class="n">required</span> <span class="n">keyword</span><span class="o">-</span><span class="n">only</span> <span class="n">argument</span><span class="p">:</span> <span class="s1">&#39;keyfn&#39;</span>
</pre></div>
</div>
<p class="last">Availability: Python 3.</p>
</dd>
</dl>
</div>
<div class="section" id="defmain">
<h5>defmain<a class="headerlink" href="#defmain" title="Permalink to this headline">¶</a></h5>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.10.1.</span></p>
</div>
<p>The <code class="docutils literal"><span class="pre">defmain</span></code> macro defines a main function that is immediately called
with <code class="docutils literal"><span class="pre">sys.argv</span></code> as arguments if and only if this file is being executed
as a script.  In other words, this:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">defmain</span> <span class="p">[</span><span class="o">&amp;</span><span class="nb">rest </span><span class="nv">args</span><span class="p">]</span>
  <span class="p">(</span><span class="nf">do-something-with</span> <span class="nv">args</span><span class="p">))</span>
</pre></div>
</div>
<p>is the equivalent of:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="n">do_something_with</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">0</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">sys</span>
    <span class="n">retval</span> <span class="o">=</span> <span class="n">main</span><span class="p">(</span><span class="o">*</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">retval</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">retval</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that as you can see above, if you return an integer from this
function, this will be used as the exit status for your script.
(Python defaults to exit status 0 otherwise, which means everything's
okay!) Since <code class="docutils literal"><span class="pre">(sys.exit</span> <span class="pre">0)</span></code> is not run explicitly in the case of a
non-integer return from <code class="docutils literal"><span class="pre">defmain</span></code>, it's a good idea to put <code class="docutils literal"><span class="pre">(defmain)</span></code>
as the last piece of code in your file.</p>
<p>If you want fancy command-line arguments, you can use the standard Python
module <code class="docutils literal"><span class="pre">argparse</span></code> in the usual way:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">import </span><span class="nv">argparse</span><span class="p">)</span>

<span class="p">(</span><span class="nf">defmain</span> <span class="p">[</span><span class="o">&amp;</span><span class="nb">rest </span><span class="nv">_</span><span class="p">]</span>
  <span class="p">(</span><span class="nf">setv</span> <span class="nv">parser</span> <span class="p">(</span><span class="nf">argparse.ArgumentParser</span><span class="p">))</span>
  <span class="p">(</span><span class="nf">.add-argument</span> <span class="nv">parser</span> <span class="s">&quot;STRING&quot;</span>
    <span class="ss">:help</span> <span class="s">&quot;string to replicate&quot;</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">.add-argument</span> <span class="nv">parser</span> <span class="s">&quot;-n&quot;</span> <span class="ss">:type</span> <span class="nb">int </span><span class="ss">:default</span> <span class="mi">3</span>
    <span class="ss">:help</span> <span class="s">&quot;number of copies&quot;</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">setv</span> <span class="nv">args</span> <span class="p">(</span><span class="nf">parser.parse_args</span><span class="p">))</span>

  <span class="p">(</span><span class="nb">print </span><span class="p">(</span><span class="nb">* </span><span class="nv">args.STRING</span> <span class="nv">args.n</span><span class="p">))</span>

  <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="defmacro">
<span id="id5"></span><h5>defmacro<a class="headerlink" href="#defmacro" title="Permalink to this headline">¶</a></h5>
<p><code class="docutils literal"><span class="pre">defmacro</span></code> is used to define macros. The general format is
<code class="docutils literal"><span class="pre">(defmacro</span> <span class="pre">name</span> <span class="pre">[parameters]</span> <span class="pre">expr)</span></code>.</p>
<p>The following example defines a macro that can be used to swap order of elements
in code, allowing the user to write code in infix notation, where operator is in
between the operands.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">(</span><span class="kd">defmacro </span><span class="nv">infix</span> <span class="p">[</span><span class="nv">code</span><span class="p">]</span>
<span class="nv">...</span>  <span class="p">(</span><span class="nf">quasiquote</span> <span class="p">(</span>
<span class="nv">...</span>    <span class="p">(</span><span class="nf">unquote</span> <span class="p">(</span><span class="nb">get </span><span class="nv">code</span> <span class="mi">1</span><span class="p">))</span>
<span class="nv">...</span>    <span class="p">(</span><span class="nf">unquote</span> <span class="p">(</span><span class="nb">get </span><span class="nv">code</span> <span class="mi">0</span><span class="p">))</span>
<span class="nv">...</span>    <span class="p">(</span><span class="nf">unquote</span> <span class="p">(</span><span class="nb">get </span><span class="nv">code</span> <span class="mi">2</span><span class="p">)))))</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">infix</span> <span class="p">(</span><span class="mi">1</span> <span class="nb">+ </span><span class="mi">1</span><span class="p">))</span>
<span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="section" id="defmacro-g">
<span id="id6"></span><h5>defmacro/g!<a class="headerlink" href="#defmacro-g" title="Permalink to this headline">¶</a></h5>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.9.12.</span></p>
</div>
<p><code class="docutils literal"><span class="pre">defmacro/g!</span></code> is a special version of <code class="docutils literal"><span class="pre">defmacro</span></code> that is used to
automatically generate <a class="reference internal" href="#gensym"><span class="std std-ref">gensym</span></a> for any symbol that starts with
<code class="docutils literal"><span class="pre">g!</span></code>.</p>
<p>For example, <code class="docutils literal"><span class="pre">g!a</span></code> would become <code class="docutils literal"><span class="pre">(gensym</span> <span class="pre">&quot;a&quot;)</span></code>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">Section <a class="reference internal" href="index.html#using-gensym"><span class="std std-ref">Using gensym for Safer Macros</span></a></p>
</div>
</div>
<div class="section" id="id7">
<span id="id8"></span><h5>defmacro!<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h5>
<p><code class="docutils literal"><span class="pre">defmacro!</span></code> is like <code class="docutils literal"><span class="pre">defmacro/g!</span></code> plus automatic once-only evaluation for
<code class="docutils literal"><span class="pre">o!</span></code> parameters, which are available as the equivalent <code class="docutils literal"><span class="pre">g!</span></code> symbol.</p>
<p>For example,</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">(</span><span class="kd">defn </span><span class="nv">expensive-get-number</span> <span class="p">[]</span> <span class="p">(</span><span class="nb">print </span><span class="s">&quot;spam&quot;</span><span class="p">)</span> <span class="mi">14</span><span class="p">)</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="kd">defmacro </span><span class="nv">triple-1</span> <span class="p">[</span><span class="nv">n</span><span class="p">]</span> <span class="o">`</span><span class="p">(</span><span class="nb">+ </span><span class="o">~</span><span class="nv">n</span> <span class="o">~</span><span class="nv">n</span> <span class="o">~</span><span class="nv">n</span><span class="p">))</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">triple-1</span> <span class="p">(</span><span class="nf">expensive-get-number</span><span class="p">))</span>  <span class="c1">; evals n three times</span>
<span class="nv">spam</span>
<span class="nv">spam</span>
<span class="nv">spam</span>
<span class="mi">42</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">defmacro/g!</span> <span class="nv">triple-2</span> <span class="p">[</span><span class="nv">n</span><span class="p">]</span> <span class="o">`</span><span class="p">(</span><span class="k">do </span><span class="p">(</span><span class="nf">setv</span> <span class="o">~</span><span class="nv">g!n</span> <span class="o">~</span><span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nb">+ </span><span class="o">~</span><span class="nv">g!n</span> <span class="o">~</span><span class="nv">g!n</span> <span class="o">~</span><span class="nv">g!n</span><span class="p">)))</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">triple-2</span> <span class="p">(</span><span class="nf">expensive-get-number</span><span class="p">))</span>  <span class="c1">; avoid repeats with a gensym</span>
<span class="nv">spam</span>
<span class="mi">42</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">defmacro!</span> <span class="nv">triple-3</span> <span class="p">[</span><span class="nv">o!n</span><span class="p">]</span> <span class="o">`</span><span class="p">(</span><span class="nb">+ </span><span class="o">~</span><span class="nv">g!n</span> <span class="o">~</span><span class="nv">g!n</span> <span class="o">~</span><span class="nv">g!n</span><span class="p">))</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">triple-3</span> <span class="p">(</span><span class="nf">expensive-get-number</span><span class="p">))</span>  <span class="c1">; easier with defmacro!</span>
<span class="nv">spam</span>
<span class="mi">42</span>
</pre></div>
</div>
</div>
<div class="section" id="defsharp">
<h5>defsharp<a class="headerlink" href="#defsharp" title="Permalink to this headline">¶</a></h5>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.13.0.</span></p>
</div>
<p><code class="docutils literal"><span class="pre">defsharp</span></code> defines a sharp macro. A sharp macro is a unary macro that has the
same semantics as an ordinary macro defined with <code class="docutils literal"><span class="pre">defmacro</span></code>, but can be
called without parentheses and with less whitespace. The name of a sharp macro
must be exactly one character long. It is called with the syntax <code class="docutils literal"><span class="pre">#cFORM</span></code>,
where <code class="docutils literal"><span class="pre">#</span></code> is a literal sharp sign (hence the term &quot;sharp macro&quot;), <code class="docutils literal"><span class="pre">c</span></code> is
the name of the macro, and <code class="docutils literal"><span class="pre">FORM</span></code> is any form. Whitspace is forbidden between
<code class="docutils literal"><span class="pre">#</span></code> and <code class="docutils literal"><span class="pre">c</span></code>. Whitespace is allowed between <code class="docutils literal"><span class="pre">c</span></code> and <code class="docutils literal"><span class="pre">FORM</span></code>, but not
required.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span>=&gt; (defsharp ♣ [expr] `[~expr ~expr])
&lt;function &lt;lambda&gt; at 0x7f76d0271158&gt;
=&gt; #♣5
[5, 5]
=&gt; (setv x 0)
=&gt; #♣(+= x 1)
[None, None]
=&gt; x
2
</pre></div>
</div>
<p>In this example, if you used <code class="docutils literal"><span class="pre">(defmacro</span> <span class="pre">♣</span> <span class="pre">...)</span></code> instead of <code class="docutils literal"><span class="pre">(defsharp</span>
<span class="pre">♣</span> <span class="pre">...)</span></code>, you would call the macro as <code class="docutils literal"><span class="pre">(♣</span> <span class="pre">5)</span></code> or <code class="docutils literal"><span class="pre">(♣</span> <span class="pre">(+=</span> <span class="pre">x</span> <span class="pre">1))</span></code>.</p>
<p>The syntax for calling sharp macros is similar to that of reader macros a la
Common Lisp's <code class="docutils literal"><span class="pre">SET-MACRO-CHARACTER</span></code>. In fact, before Hy 0.13.0, sharp macros
were called &quot;reader macros&quot;, and defined with <code class="docutils literal"><span class="pre">defreader</span></code> rather than
<code class="docutils literal"><span class="pre">defsharp</span></code>. True reader macros are not (yet) implemented in Hy.</p>
</div>
<div class="section" id="del">
<h5>del<a class="headerlink" href="#del" title="Permalink to this headline">¶</a></h5>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.9.12.</span></p>
</div>
<p><code class="docutils literal"><span class="pre">del</span></code> removes an object from the current namespace.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span>=&gt; (setv foo 42)
=&gt; (del foo)
=&gt; foo
Traceback (most recent call last):
  File &quot;&lt;console&gt;&quot;, line 1, in &lt;module&gt;
NameError: name &#39;foo&#39; is not defined
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">del</span></code> can also remove objects from mappings, lists, and more.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span>=&gt; (setv test (list (range 10)))
=&gt; test
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
=&gt; (del (cut test 2 4)) ;; remove items from 2 to 4 excluded
=&gt; test
[0, 1, 4, 5, 6, 7, 8, 9]
=&gt; (setv dic {&quot;foo&quot; &quot;bar&quot;})
=&gt; dic
{&quot;foo&quot;: &quot;bar&quot;}
=&gt; (del (get dic &quot;foo&quot;))
=&gt; dic
{}
</pre></div>
</div>
</div>
<div class="section" id="doto">
<h5>doto<a class="headerlink" href="#doto" title="Permalink to this headline">¶</a></h5>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.10.1.</span></p>
</div>
<p><code class="docutils literal"><span class="pre">doto</span></code> is used to simplify a sequence of method calls to an object.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">doto </span><span class="p">[]</span> <span class="p">(</span><span class="nf">.append</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nf">.append</span> <span class="mi">2</span><span class="p">)</span> <span class="nv">.reverse</span><span class="p">)</span>
<span class="p">[</span><span class="mi">2</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">setv</span> <span class="nv">collection</span> <span class="p">[])</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">.append</span> <span class="nv">collection</span> <span class="mi">1</span><span class="p">)</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">.append</span> <span class="nv">collection</span> <span class="mi">2</span><span class="p">)</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">.reverse</span> <span class="nv">collection</span><span class="p">)</span>
<span class="nv">=&gt;</span> <span class="nv">collection</span>
<span class="p">[</span><span class="mi">2</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="eval">
<h5>eval<a class="headerlink" href="#eval" title="Permalink to this headline">¶</a></h5>
<p><code class="docutils literal"><span class="pre">eval</span></code> evaluates a quoted expression and returns the value. The optional
second and third arguments specify the dictionary of globals to use and the
module name. The globals dictionary defaults to <code class="docutils literal"><span class="pre">(local)</span></code> and the module name
defaults to the name of the current module.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">eval </span><span class="o">&#39;</span><span class="p">(</span><span class="nb">print </span><span class="s">&quot;Hello World&quot;</span><span class="p">))</span>
<span class="s">&quot;Hello World&quot;</span>
</pre></div>
</div>
<p>If you want to evaluate a string, use <code class="docutils literal"><span class="pre">read-str</span></code> to convert it to a
form first:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">eval </span><span class="p">(</span><span class="nf">read-str</span> <span class="s">&quot;(+ 1 1)&quot;</span><span class="p">))</span>
<span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="section" id="eval-and-compile">
<h5>eval-and-compile<a class="headerlink" href="#eval-and-compile" title="Permalink to this headline">¶</a></h5>
</div>
<div class="section" id="eval-when-compile">
<h5>eval-when-compile<a class="headerlink" href="#eval-when-compile" title="Permalink to this headline">¶</a></h5>
</div>
<div class="section" id="first">
<h5>first<a class="headerlink" href="#first" title="Permalink to this headline">¶</a></h5>
<p><code class="docutils literal"><span class="pre">first</span></code> is a function for accessing the first element of a collection.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">first </span><span class="p">(</span><span class="nb">range </span><span class="mi">10</span><span class="p">))</span>
<span class="mi">0</span>
</pre></div>
</div>
<p>It is implemented as <code class="docutils literal"><span class="pre">(next</span> <span class="pre">(iter</span> <span class="pre">coll)</span> <span class="pre">None)</span></code>, so it works with any
iterable, and if given an empty iterable, it will return <code class="docutils literal"><span class="pre">None</span></code> instead of
raising an exception.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">first </span><span class="p">(</span><span class="nb">repeat </span><span class="mi">10</span><span class="p">))</span>
<span class="mi">10</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">first </span><span class="p">[])</span>
<span class="nv">None</span>
</pre></div>
</div>
</div>
<div class="section" id="for">
<h5>for<a class="headerlink" href="#for" title="Permalink to this headline">¶</a></h5>
<p><code class="docutils literal"><span class="pre">for</span></code> is used to call a function for each element in a list or vector.
The results of each call are discarded and the <code class="docutils literal"><span class="pre">for</span></code> expression returns
<code class="docutils literal"><span class="pre">None</span></code> instead. The example code iterates over <em>collection</em> and for each
<em>element</em> in <em>collection</em> calls the <code class="docutils literal"><span class="pre">side-effect</span></code> function with <em>element</em>
as its argument:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="c1">;; assuming that (side-effect) is a function that takes a single parameter</span>
<span class="p">(</span><span class="nb">for </span><span class="p">[</span><span class="nv">element</span> <span class="nv">collection</span><span class="p">]</span> <span class="p">(</span><span class="nf">side-effect</span> <span class="nv">element</span><span class="p">))</span>

<span class="c1">;; for can have an optional else block</span>
<span class="p">(</span><span class="nb">for </span><span class="p">[</span><span class="nv">element</span> <span class="nv">collection</span><span class="p">]</span> <span class="p">(</span><span class="nf">side-effect</span> <span class="nv">element</span><span class="p">)</span>
     <span class="p">(</span><span class="nf">else</span> <span class="p">(</span><span class="nf">side-effect-2</span><span class="p">)))</span>
</pre></div>
</div>
<p>The optional <code class="docutils literal"><span class="pre">else</span></code> block is only executed if the <code class="docutils literal"><span class="pre">for</span></code> loop terminates
normally. If the execution is halted with <code class="docutils literal"><span class="pre">break</span></code>, the <code class="docutils literal"><span class="pre">else</span></code> block does
not execute.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">for </span><span class="p">[</span><span class="nv">element</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">]]</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&lt; </span><span class="nv">element</span> <span class="mi">3</span><span class="p">)</span>
<span class="nv">...</span>                             <span class="p">(</span><span class="nb">print </span><span class="nv">element</span><span class="p">)</span>
<span class="nv">...</span>                             <span class="p">(</span><span class="nf">break</span><span class="p">))</span>
<span class="nv">...</span>    <span class="p">(</span><span class="nf">else</span> <span class="p">(</span><span class="nb">print </span><span class="s">&quot;loop finished&quot;</span><span class="p">)))</span>
<span class="mi">1</span>
<span class="mi">2</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">for </span><span class="p">[</span><span class="nv">element</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">]]</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&lt; </span><span class="nv">element</span> <span class="mi">4</span><span class="p">)</span>
<span class="nv">...</span>                             <span class="p">(</span><span class="nb">print </span><span class="nv">element</span><span class="p">)</span>
<span class="nv">...</span>                             <span class="p">(</span><span class="nf">break</span><span class="p">))</span>
<span class="nv">...</span>    <span class="p">(</span><span class="nf">else</span> <span class="p">(</span><span class="nb">print </span><span class="s">&quot;loop finished&quot;</span><span class="p">)))</span>
<span class="mi">1</span>
<span class="mi">2</span>
<span class="mi">3</span>
<span class="k">loop </span><span class="nv">finished</span>
</pre></div>
</div>
</div>
<div class="section" id="genexpr">
<h5>genexpr<a class="headerlink" href="#genexpr" title="Permalink to this headline">¶</a></h5>
<p><code class="docutils literal"><span class="pre">genexpr</span></code> is used to create generator expressions. It takes two or three
parameters. The first parameter is the expression controlling the return value,
while the second is used to select items from a list. The third and optional
parameter can be used to filter out some of the items in the list based on a
conditional expression. <code class="docutils literal"><span class="pre">genexpr</span></code> is similar to <code class="docutils literal"><span class="pre">list-comp</span></code>, except it
returns an iterable that evaluates values one by one instead of evaluating them
immediately.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">def</span> <span class="n">collection</span> <span class="o">(</span><span class="n">range</span> <span class="mi">10</span><span class="o">))</span>
<span class="o">=&gt;</span> <span class="o">(</span><span class="n">def</span> <span class="n">filtered</span> <span class="o">(</span><span class="n">genexpr</span> <span class="n">x</span> <span class="o">[</span><span class="n">x</span> <span class="n">collection</span><span class="o">]</span> <span class="o">(</span><span class="n">even</span><span class="o">?</span> <span class="n">x</span><span class="o">)))</span>
<span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="n">filtered</span><span class="o">)</span>
<span class="o">[</span><span class="mi">0</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">6</span><span class="o">,</span> <span class="mi">8</span><span class="o">]</span>
</pre></div>
</div>
</div>
<div class="section" id="gensym">
<span id="id9"></span><h5>gensym<a class="headerlink" href="#gensym" title="Permalink to this headline">¶</a></h5>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.9.12.</span></p>
</div>
<p><code class="docutils literal"><span class="pre">gensym</span></code> is used to generate a unique symbol that allows macros to be
written without accidental variable name clashes.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">gensym</span><span class="p">)</span>
<span class="nv">u</span><span class="o">&#39;</span><span class="ss">:G_1235</span><span class="o">&#39;</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">gensym </span><span class="s">&quot;x&quot;</span><span class="p">)</span>
<span class="nv">u</span><span class="o">&#39;</span><span class="ss">:x_1236</span><span class="o">&#39;</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">Section <a class="reference internal" href="index.html#using-gensym"><span class="std std-ref">Using gensym for Safer Macros</span></a></p>
</div>
</div>
<div class="section" id="get">
<h5>get<a class="headerlink" href="#get" title="Permalink to this headline">¶</a></h5>
<p><code class="docutils literal"><span class="pre">get</span></code> is used to access single elements in collections. <code class="docutils literal"><span class="pre">get</span></code> takes at
least two parameters: the <em>data structure</em> and the <em>index</em> or <em>key</em> of the
item. It will then return the corresponding value from the collection. If
multiple <em>index</em> or <em>key</em> values are provided, they are used to access
successive elements in a nested structure. Example usage:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">do</span>
<span class="nv">...</span>  <span class="p">(</span><span class="nf">setv</span> <span class="nv">animals</span> <span class="p">{</span><span class="s">&quot;dog&quot;</span> <span class="s">&quot;bark&quot;</span> <span class="s">&quot;cat&quot;</span> <span class="s">&quot;meow&quot;</span><span class="p">}</span>
<span class="nv">...</span>        <span class="nv">numbers</span> <span class="p">(</span>, <span class="s">&quot;zero&quot;</span> <span class="s">&quot;one&quot;</span> <span class="s">&quot;two&quot;</span> <span class="s">&quot;three&quot;</span><span class="p">)</span>
<span class="nv">...</span>        <span class="nv">nested</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="p">[</span><span class="s">&quot;a&quot;</span> <span class="s">&quot;b&quot;</span> <span class="s">&quot;c&quot;</span><span class="p">]</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">])</span>
<span class="nv">...</span>  <span class="p">(</span><span class="nb">print </span><span class="p">(</span><span class="nb">get </span><span class="nv">animals</span> <span class="s">&quot;dog&quot;</span><span class="p">))</span>
<span class="nv">...</span>  <span class="p">(</span><span class="nb">print </span><span class="p">(</span><span class="nb">get </span><span class="nv">numbers</span> <span class="mi">2</span><span class="p">))</span>
<span class="nv">...</span>  <span class="p">(</span><span class="nb">print </span><span class="p">(</span><span class="nb">get </span><span class="nv">nested</span> <span class="mi">2</span> <span class="mi">1</span><span class="p">)))</span>

<span class="nv">bark</span>
<span class="nv">two</span>
<span class="nv">b</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><code class="docutils literal"><span class="pre">get</span></code> raises a KeyError if a dictionary is queried for a
non-existing key.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><code class="docutils literal"><span class="pre">get</span></code> raises an IndexError if a list or a tuple is queried for an
index that is out of bounds.</p>
</div>
</div>
<div class="section" id="global">
<h5>global<a class="headerlink" href="#global" title="Permalink to this headline">¶</a></h5>
<p><code class="docutils literal"><span class="pre">global</span></code> can be used to mark a symbol as global. This allows the programmer to
assign a value to a global symbol. Reading a global symbol does not require the
<code class="docutils literal"><span class="pre">global</span></code> keyword -- only assigning it does.</p>
<p>The following example shows how the global symbol <code class="docutils literal"><span class="pre">a</span></code> is assigned a value in a
function and is later on printed in another function. Without the <code class="docutils literal"><span class="pre">global</span></code>
keyword, the second function would have raised a <code class="docutils literal"><span class="pre">NameError</span></code>.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="kd">defn </span><span class="nv">set-a</span> <span class="p">[</span><span class="nv">value</span><span class="p">]</span>
  <span class="p">(</span><span class="nf">global</span> <span class="nv">a</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">setv</span> <span class="nv">a</span> <span class="nv">value</span><span class="p">))</span>

<span class="p">(</span><span class="kd">defn </span><span class="nv">print-a</span> <span class="p">[]</span>
  <span class="p">(</span><span class="nb">print </span><span class="nv">a</span><span class="p">))</span>

<span class="p">(</span><span class="nf">set-a</span> <span class="mi">5</span><span class="p">)</span>
<span class="p">(</span><span class="nf">print-a</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="if-if-if-not">
<h5>if / if* / if-not<a class="headerlink" href="#if-if-if-not" title="Permalink to this headline">¶</a></h5>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.10.0: </span>if-not</p>
</div>
<p><code class="docutils literal"><span class="pre">if</span> <span class="pre">/</span> <span class="pre">if*</span> <span class="pre">/</span> <span class="pre">if-not</span></code> respect Python <em>truthiness</em>, that is, a <em>test</em> fails if it
evaluates to a &quot;zero&quot; (including values of <code class="docutils literal"><span class="pre">len</span></code> zero, <code class="docutils literal"><span class="pre">None</span></code>, and
<code class="docutils literal"><span class="pre">False</span></code>), and passes otherwise, but values with a <code class="docutils literal"><span class="pre">__bool__</span></code> method
(<code class="docutils literal"><span class="pre">__nonzero__</span></code> in Python 2) can overrides this.</p>
<p>The <code class="docutils literal"><span class="pre">if</span></code> macro is for conditionally selecting an expression for evaluation.
The result of the selected expression becomes the result of the entire <code class="docutils literal"><span class="pre">if</span></code>
form. <code class="docutils literal"><span class="pre">if</span></code> can select a group of expressions with the help of a <code class="docutils literal"><span class="pre">do</span></code> block.</p>
<p><code class="docutils literal"><span class="pre">if</span></code> takes any number of alternating <em>test</em> and <em>then</em> expressions, plus an
optional <em>else</em> expression at the end, which defaults to <code class="docutils literal"><span class="pre">None</span></code>. <code class="docutils literal"><span class="pre">if</span></code> checks
each <em>test</em> in turn, and selects the <em>then</em> corresponding to the first passed
test. <code class="docutils literal"><span class="pre">if</span></code> does not evaluate any expressions following its selection, similar
to the <code class="docutils literal"><span class="pre">if/elif/else</span></code> control structure from Python. If no tests pass, <code class="docutils literal"><span class="pre">if</span></code>
selects <em>else</em>.</p>
<p>The <code class="docutils literal"><span class="pre">if*</span></code> special form is restricted to 2 or 3 arguments, but otherwise works
exactly like <code class="docutils literal"><span class="pre">if</span></code> (which expands to nested <code class="docutils literal"><span class="pre">if*</span></code> forms), so there is
generally no reason to use it directly.</p>
<p><code class="docutils literal"><span class="pre">if-not</span></code> is similar to <code class="docutils literal"><span class="pre">if*</span></code> but the second expression will be executed
when the condition fails while the third and final expression is executed when
the test succeeds -- the opposite order of <code class="docutils literal"><span class="pre">if*</span></code>. The final expression is
again optional and defaults to <code class="docutils literal"><span class="pre">None</span></code>.</p>
<p>Example usage:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">print </span><span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&lt; </span><span class="nv">n</span> <span class="mf">0.0</span><span class="p">)</span> <span class="s">&quot;negative&quot;</span>
           <span class="p">(</span><span class="nb">= </span><span class="nv">n</span> <span class="mf">0.0</span><span class="p">)</span> <span class="s">&quot;zero&quot;</span>
           <span class="p">(</span><span class="nb">&gt; </span><span class="nv">n</span> <span class="mf">0.0</span><span class="p">)</span> <span class="s">&quot;positive&quot;</span>
           <span class="s">&quot;not a number&quot;</span><span class="p">))</span>

<span class="p">(</span><span class="nf">if*</span> <span class="p">(</span><span class="nf">money-left?</span> <span class="nv">account</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">print </span><span class="s">&quot;let&#39;s go shopping&quot;</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">print </span><span class="s">&quot;let&#39;s go and work&quot;</span><span class="p">))</span>

<span class="p">(</span><span class="nb">if-not </span><span class="p">(</span><span class="nf">money-left?</span> <span class="nv">account</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">print </span><span class="s">&quot;let&#39;s go and work&quot;</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">print </span><span class="s">&quot;let&#39;s go shopping&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="lif-and-lif-not">
<h5>lif and lif-not<a class="headerlink" href="#lif-and-lif-not" title="Permalink to this headline">¶</a></h5>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.10.0.</span></p>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.11.0: </span>lif-not</p>
</div>
<p>For those that prefer a more Lispy <code class="docutils literal"><span class="pre">if</span></code> clause, we have
<code class="docutils literal"><span class="pre">lif</span></code>. This <em>only</em> considers <code class="docutils literal"><span class="pre">None</span></code> to be false! All other
&quot;false-ish&quot; Python values are considered true. Conversely, we have
<code class="docutils literal"><span class="pre">lif-not</span></code> in parallel to <code class="docutils literal"><span class="pre">if</span></code> and <code class="docutils literal"><span class="pre">if-not</span></code> which
reverses the comparison.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">lif</span> <span class="nv">True</span> <span class="s">&quot;true&quot;</span> <span class="s">&quot;false&quot;</span><span class="p">)</span>
<span class="s">&quot;true&quot;</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">lif</span> <span class="nv">False</span> <span class="s">&quot;true&quot;</span> <span class="s">&quot;false&quot;</span><span class="p">)</span>
<span class="s">&quot;true&quot;</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">lif</span> <span class="mi">0</span> <span class="s">&quot;true&quot;</span> <span class="s">&quot;false&quot;</span><span class="p">)</span>
<span class="s">&quot;true&quot;</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">lif</span> <span class="nv">None</span> <span class="s">&quot;true&quot;</span> <span class="s">&quot;false&quot;</span><span class="p">)</span>
<span class="s">&quot;false&quot;</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">lif-not</span> <span class="nv">None</span> <span class="s">&quot;true&quot;</span> <span class="s">&quot;false&quot;</span><span class="p">)</span>
<span class="s">&quot;true&quot;</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">lif-not</span> <span class="nv">False</span> <span class="s">&quot;true&quot;</span> <span class="s">&quot;false&quot;</span><span class="p">)</span>
<span class="s">&quot;false&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="import">
<span id="id10"></span><h5>import<a class="headerlink" href="#import" title="Permalink to this headline">¶</a></h5>
<p><code class="docutils literal"><span class="pre">import</span></code> is used to import modules, like in Python. There are several ways
that <code class="docutils literal"><span class="pre">import</span></code> can be used.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="c1">;; Imports each of these modules</span>
<span class="c1">;;</span>
<span class="c1">;; Python:</span>
<span class="c1">;; import sys</span>
<span class="c1">;; import os.path</span>
<span class="p">(</span><span class="nb">import </span><span class="nv">sys</span> <span class="nv">os.path</span><span class="p">)</span>

<span class="c1">;; Import from a module</span>
<span class="c1">;;</span>
<span class="c1">;; Python: from os.path import exists, isdir, isfile</span>
<span class="p">(</span><span class="nb">import </span><span class="p">[</span><span class="nv">os.path</span> <span class="p">[</span><span class="nv">exists</span> <span class="nv">isdir</span> <span class="nv">isfile</span><span class="p">]])</span>

<span class="c1">;; Import with an alias</span>
<span class="c1">;;</span>
<span class="c1">;; Python: import sys as systest</span>
<span class="p">(</span><span class="nb">import </span><span class="p">[</span><span class="nv">sys</span> <span class="ss">:as</span> <span class="nv">systest</span><span class="p">])</span>

<span class="c1">;; You can list as many imports as you like of different types.</span>
<span class="c1">;;</span>
<span class="c1">;; Python:</span>
<span class="c1">;; from tests.resources import kwtest, function_with_a_dash</span>
<span class="c1">;; from os.path import exists, isdir as is_dir, isfile as is_file</span>
<span class="c1">;; import sys as systest</span>
<span class="p">(</span><span class="nb">import </span><span class="p">[</span><span class="nv">tests.resources</span> <span class="p">[</span><span class="nv">kwtest</span> <span class="nv">function-with-a-dash</span><span class="p">]]</span>
        <span class="p">[</span><span class="nv">os.path</span> <span class="p">[</span><span class="nv">exists</span>
                  <span class="nv">isdir</span> <span class="ss">:as</span> <span class="nv">dir?</span>
                  <span class="nv">isfile</span> <span class="ss">:as</span> <span class="nv">file?</span><span class="p">]]</span>
        <span class="p">[</span><span class="nv">sys</span> <span class="ss">:as</span> <span class="nv">systest</span><span class="p">])</span>

<span class="c1">;; Import all module functions into current namespace</span>
<span class="c1">;;</span>
<span class="c1">;; Python: from sys import *</span>
<span class="p">(</span><span class="nb">import </span><span class="p">[</span><span class="nv">sys</span> <span class="p">[</span><span class="nv">*</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="section" id="fn">
<h5>fn<a class="headerlink" href="#fn" title="Permalink to this headline">¶</a></h5>
<p><code class="docutils literal"><span class="pre">fn</span></code>, like Python's <code class="docutils literal"><span class="pre">lambda</span></code>, can be used to define an anonymous function.
Unlike Python's <code class="docutils literal"><span class="pre">lambda</span></code>, the body of the function can comprise several
statements. The parameters are similar to <code class="docutils literal"><span class="pre">defn</span></code>: the first parameter is
vector of parameters and the rest is the body of the function. <code class="docutils literal"><span class="pre">fn</span></code> returns a
new function. In the following example, an anonymous function is defined and
passed to another function for filtering output.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">(</span><span class="k">def </span><span class="nv">people</span> <span class="p">[{</span><span class="ss">:name</span> <span class="s">&quot;Alice&quot;</span> <span class="ss">:age</span> <span class="mi">20</span><span class="p">}</span>
<span class="nv">...</span>             <span class="p">{</span><span class="ss">:name</span> <span class="s">&quot;Bob&quot;</span> <span class="ss">:age</span> <span class="mi">25</span><span class="p">}</span>
<span class="nv">...</span>             <span class="p">{</span><span class="ss">:name</span> <span class="s">&quot;Charlie&quot;</span> <span class="ss">:age</span> <span class="mi">50</span><span class="p">}</span>
<span class="nv">...</span>             <span class="p">{</span><span class="ss">:name</span> <span class="s">&quot;Dave&quot;</span> <span class="ss">:age</span> <span class="mi">5</span><span class="p">}])</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="kd">defn </span><span class="nv">display-people</span> <span class="p">[</span><span class="nv">people</span> <span class="nv">filter</span><span class="p">]</span>
<span class="nv">...</span>  <span class="p">(</span><span class="nb">for </span><span class="p">[</span><span class="nv">person</span> <span class="nv">people</span><span class="p">]</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">filter </span><span class="nv">person</span><span class="p">)</span> <span class="p">(</span><span class="nb">print </span><span class="p">(</span><span class="ss">:name</span> <span class="nv">person</span><span class="p">)))))</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">display-people</span> <span class="nv">people</span> <span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">person</span><span class="p">]</span> <span class="p">(</span><span class="nb">&lt; </span><span class="p">(</span><span class="ss">:age</span> <span class="nv">person</span><span class="p">)</span> <span class="mi">25</span><span class="p">)))</span>
<span class="nv">Alice</span>
<span class="nv">Dave</span>
</pre></div>
</div>
<p>Just as in normal function definitions, if the first element of the
body is a string, it serves as a docstring. This is useful for giving
class methods docstrings.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">setv</span> <span class="nv">times-three</span>
<span class="nv">...</span>   <span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">x</span><span class="p">]</span>
<span class="nv">...</span>    <span class="s">&quot;Multiplies input by three and returns the result.&quot;</span>
<span class="nv">...</span>    <span class="p">(</span><span class="nb">* </span><span class="nv">x</span> <span class="mi">3</span><span class="p">)))</span>
</pre></div>
</div>
<p>This can be confirmed via Python's built-in <code class="docutils literal"><span class="pre">help</span></code> function:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="p">(</span><span class="n">help</span> <span class="n">times</span><span class="o">-</span><span class="n">three</span><span class="p">)</span>
<span class="n">Help</span> <span class="n">on</span> <span class="n">function</span> <span class="n">times_three</span><span class="p">:</span>

<span class="n">times_three</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">Multiplies</span> <span class="nb">input</span> <span class="n">by</span> <span class="n">three</span> <span class="ow">and</span> <span class="n">returns</span> <span class="n">result</span>
<span class="p">(</span><span class="n">END</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="last">
<h5>last<a class="headerlink" href="#last" title="Permalink to this headline">¶</a></h5>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.11.0.</span></p>
</div>
<p><code class="docutils literal"><span class="pre">last</span></code> can be used for accessing the last element of a collection:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">last </span><span class="p">[</span><span class="mi">2</span> <span class="mi">4</span> <span class="mi">6</span><span class="p">])</span>
<span class="mi">6</span>
</pre></div>
</div>
</div>
<div class="section" id="list-comp">
<h5>list-comp<a class="headerlink" href="#list-comp" title="Permalink to this headline">¶</a></h5>
<p><code class="docutils literal"><span class="pre">list-comp</span></code> performs list comprehensions. It takes two or three parameters.
The first parameter is the expression controlling the return value, while
the second is used to select items from a list. The third and optional
parameter can be used to filter out some of the items in the list based on a
conditional expression. Some examples:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">(</span><span class="k">def </span><span class="nv">collection</span> <span class="p">(</span><span class="nb">range </span><span class="mi">10</span><span class="p">))</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">list-comp</span> <span class="nv">x</span> <span class="p">[</span><span class="nv">x</span> <span class="nv">collection</span><span class="p">])</span>
<span class="p">[</span><span class="mi">0</span>, <span class="mi">1</span>, <span class="mi">2</span>, <span class="mi">3</span>, <span class="mi">4</span>, <span class="mi">5</span>, <span class="mi">6</span>, <span class="mi">7</span>, <span class="mi">8</span>, <span class="mi">9</span><span class="p">]</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">list-comp</span> <span class="p">(</span><span class="nb">* </span><span class="nv">x</span> <span class="mi">2</span><span class="p">)</span> <span class="p">[</span><span class="nv">x</span> <span class="nv">collection</span><span class="p">])</span>
<span class="p">[</span><span class="mi">0</span>, <span class="mi">2</span>, <span class="mi">4</span>, <span class="mi">6</span>, <span class="mi">8</span>, <span class="mi">10</span>, <span class="mi">12</span>, <span class="mi">14</span>, <span class="mi">16</span>, <span class="mi">18</span><span class="p">]</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">list-comp</span> <span class="p">(</span><span class="nb">* </span><span class="nv">x</span> <span class="mi">2</span><span class="p">)</span> <span class="p">[</span><span class="nv">x</span> <span class="nv">collection</span><span class="p">]</span> <span class="p">(</span><span class="nb">&lt; </span><span class="nv">x</span> <span class="mi">5</span><span class="p">))</span>
<span class="p">[</span><span class="mi">0</span>, <span class="mi">2</span>, <span class="mi">4</span>, <span class="mi">6</span>, <span class="mi">8</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="nonlocal">
<h5>nonlocal<a class="headerlink" href="#nonlocal" title="Permalink to this headline">¶</a></h5>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.11.1.</span></p>
</div>
<p><strong>PYTHON 3.0 AND UP ONLY!</strong></p>
<p><code class="docutils literal"><span class="pre">nonlocal</span></code> can be used to mark a symbol as not local to the current scope.
The parameters are the names of symbols to mark as nonlocal.  This is necessary
to modify variables through nested <code class="docutils literal"><span class="pre">fn</span></code> scopes:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="kd">defn </span><span class="nv">some-function</span> <span class="p">[]</span>
  <span class="p">(</span><span class="nf">setv</span> <span class="nv">x</span> <span class="mi">0</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">register-some-callback</span>
    <span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">stuff</span><span class="p">]</span>
      <span class="p">(</span><span class="nf">nonlocal</span> <span class="nv">x</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">setv</span> <span class="nv">x</span> <span class="nv">stuff</span><span class="p">))))</span>
</pre></div>
</div>
<p>Without the call to <code class="docutils literal"><span class="pre">(nonlocal</span> <span class="pre">x)</span></code>, the inner function would redefine <code class="docutils literal"><span class="pre">x</span></code> to
<code class="docutils literal"><span class="pre">stuff</span></code> inside its local scope instead of overwriting the <code class="docutils literal"><span class="pre">x</span></code> in the outer
function.</p>
<p>See <a class="reference external" href="https://www.python.org/dev/peps/pep-3104/">PEP3104</a> for further
information.</p>
</div>
<div class="section" id="not">
<h5>not<a class="headerlink" href="#not" title="Permalink to this headline">¶</a></h5>
<p><code class="docutils literal"><span class="pre">not</span></code> is used in logical expressions. It takes a single parameter and
returns a reversed truth value. If <code class="docutils literal"><span class="pre">True</span></code> is given as a parameter, <code class="docutils literal"><span class="pre">False</span></code>
will be returned, and vice-versa. Example usage:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">not </span><span class="nv">True</span><span class="p">)</span>
<span class="nv">False</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">not </span><span class="nv">False</span><span class="p">)</span>
<span class="nv">True</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">not </span><span class="nv">None</span><span class="p">)</span>
<span class="nv">True</span>
</pre></div>
</div>
</div>
<div class="section" id="or">
<h5>or<a class="headerlink" href="#or" title="Permalink to this headline">¶</a></h5>
<p><code class="docutils literal"><span class="pre">or</span></code> is used in logical expressions. It takes at least two parameters. It
will return the first non-false parameter. If no such value exists, the last
parameter will be returned.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">or </span><span class="nv">True</span> <span class="nv">False</span><span class="p">)</span>
<span class="nv">True</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">and </span><span class="nv">False</span> <span class="nv">False</span><span class="p">)</span>
<span class="nv">False</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">and </span><span class="nv">False</span> <span class="mi">1</span> <span class="nv">True</span> <span class="nv">False</span><span class="p">)</span>
<span class="mi">1</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><code class="docutils literal"><span class="pre">or</span></code> short-circuits and stops evaluating parameters as soon as the
first true value is encountered.</p>
</div>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">or </span><span class="nv">True</span> <span class="p">(</span><span class="nb">print </span><span class="s">&quot;hello&quot;</span><span class="p">))</span>
<span class="nv">True</span>
</pre></div>
</div>
</div>
<div class="section" id="print">
<h5>print<a class="headerlink" href="#print" title="Permalink to this headline">¶</a></h5>
<p><code class="docutils literal"><span class="pre">print</span></code> is used to output on screen. Example usage:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">print </span><span class="s">&quot;Hello world!&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><code class="docutils literal"><span class="pre">print</span></code> always returns <code class="docutils literal"><span class="pre">None</span></code>.</p>
</div>
</div>
<div class="section" id="quasiquote">
<h5>quasiquote<a class="headerlink" href="#quasiquote" title="Permalink to this headline">¶</a></h5>
<p><code class="docutils literal"><span class="pre">quasiquote</span></code> allows you to quote a form, but also selectively evaluate
expressions. Expressions inside a <code class="docutils literal"><span class="pre">quasiquote</span></code> can be selectively evaluated
using <code class="docutils literal"><span class="pre">unquote</span></code> (<code class="docutils literal"><span class="pre">~</span></code>). The evaluated form can also be spliced using
<code class="docutils literal"><span class="pre">unquote-splice</span></code> (<code class="docutils literal"><span class="pre">~&#64;</span></code>). Quasiquote can be also written using the backquote
(<code class="docutils literal"><span class="pre">`</span></code>) symbol.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="c1">;; let `qux&#39; be a variable with value (bar baz)</span>
<span class="o">`</span><span class="p">(</span><span class="nf">foo</span> <span class="o">~</span><span class="nv">qux</span><span class="p">)</span>
<span class="c1">; equivalent to &#39;(foo (bar baz))</span>
<span class="o">`</span><span class="p">(</span><span class="nf">foo</span> <span class="o">~@</span><span class="nv">qux</span><span class="p">)</span>
<span class="c1">; equivalent to &#39;(foo bar baz)</span>
</pre></div>
</div>
</div>
<div class="section" id="quote">
<h5>quote<a class="headerlink" href="#quote" title="Permalink to this headline">¶</a></h5>
<p><code class="docutils literal"><span class="pre">quote</span></code> returns the form passed to it without evaluating it. <code class="docutils literal"><span class="pre">quote</span></code> can
alternatively be written using the apostrophe (<code class="docutils literal"><span class="pre">'</span></code>) symbol.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">setv</span> <span class="nv">x</span> <span class="o">&#39;</span><span class="p">(</span><span class="nb">print </span><span class="s">&quot;Hello World&quot;</span><span class="p">))</span>
<span class="c1">; variable x is set to expression &amp; not evaluated</span>
<span class="nv">=&gt;</span> <span class="nv">x</span>
<span class="p">(</span><span class="nf">u</span><span class="ss">&#39;print</span><span class="o">&#39;</span> <span class="nv">u</span><span class="ss">&#39;Hello</span> <span class="nv">World</span><span class="o">&#39;</span><span class="p">)</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">eval </span><span class="nv">x</span><span class="p">)</span>
<span class="nv">Hello</span> <span class="nv">World</span>
</pre></div>
</div>
</div>
<div class="section" id="require">
<h5>require<a class="headerlink" href="#require" title="Permalink to this headline">¶</a></h5>
<p><code class="docutils literal"><span class="pre">require</span></code> is used to import macros from one or more given modules. It allows
parameters in all the same formats as <code class="docutils literal"><span class="pre">import</span></code>. The <code class="docutils literal"><span class="pre">require</span></code> form itself
produces no code in the final program: its effect is purely at compile-time, for
the benefit of macro expansion. Specifically, <code class="docutils literal"><span class="pre">require</span></code> imports each named
module and then makes each requested macro available in the current module.</p>
<p>The following are all equivalent ways to call a macro named <code class="docutils literal"><span class="pre">foo</span></code> in the module <code class="docutils literal"><span class="pre">mymodule</span></code>:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">require</span> <span class="nv">mymodule</span><span class="p">)</span>
<span class="p">(</span><span class="nf">mymodule.foo</span> <span class="mi">1</span><span class="p">)</span>

<span class="p">(</span><span class="nf">require</span> <span class="p">[</span><span class="nv">mymodule</span> <span class="ss">:as</span> <span class="nv">M</span><span class="p">])</span>
<span class="p">(</span><span class="nf">M.foo</span> <span class="mi">1</span><span class="p">)</span>

<span class="p">(</span><span class="nf">require</span> <span class="p">[</span><span class="nv">mymodule</span> <span class="p">[</span><span class="nv">foo</span><span class="p">]])</span>
<span class="p">(</span><span class="nf">foo</span> <span class="mi">1</span><span class="p">)</span>

<span class="p">(</span><span class="nf">require</span> <span class="p">[</span><span class="nv">mymodule</span> <span class="p">[</span><span class="nv">*</span><span class="p">]])</span>
<span class="p">(</span><span class="nf">foo</span> <span class="mi">1</span><span class="p">)</span>

<span class="p">(</span><span class="nf">require</span> <span class="p">[</span><span class="nv">mymodule</span> <span class="p">[</span><span class="nv">foo</span> <span class="ss">:as</span> <span class="nv">bar</span><span class="p">]])</span>
<span class="p">(</span><span class="nf">bar</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="macros-that-call-macros">
<h6>Macros that call macros<a class="headerlink" href="#macros-that-call-macros" title="Permalink to this headline">¶</a></h6>
<p>One aspect of <code class="docutils literal"><span class="pre">require</span></code> that may be surprising is what happens when one
macro's expansion calls another macro. Suppose <code class="docutils literal"><span class="pre">mymodule.hy</span></code> looks like this:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="kd">defmacro </span><span class="nv">repexpr</span> <span class="p">[</span><span class="nv">n</span> <span class="nv">expr</span><span class="p">]</span>
  <span class="c1">; Evaluate the expression n times</span>
  <span class="c1">; and collect the results in a list.</span>
  <span class="o">`</span><span class="p">(</span><span class="nb">list </span><span class="p">(</span><span class="nb">map </span><span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">_</span><span class="p">]</span> <span class="o">~</span><span class="nv">expr</span><span class="p">)</span> <span class="p">(</span><span class="nb">range </span><span class="o">~</span><span class="nv">n</span><span class="p">))))</span>

<span class="p">(</span><span class="kd">defmacro </span><span class="nv">foo</span> <span class="p">[</span><span class="nv">n</span><span class="p">]</span>
  <span class="o">`</span><span class="p">(</span><span class="nf">repexpr</span> <span class="o">~</span><span class="nv">n</span> <span class="p">(</span><span class="nf">input</span> <span class="s">&quot;Gimme some input: &quot;</span><span class="p">)))</span>
</pre></div>
</div>
<p>And then, in your main program, you write:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">require</span> <span class="p">[</span><span class="nv">mymodule</span> <span class="p">[</span><span class="nv">foo</span><span class="p">]])</span>

<span class="p">(</span><span class="nb">print </span><span class="p">(</span><span class="nf">mymodule.foo</span> <span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
<p>Running this raises <code class="docutils literal"><span class="pre">NameError:</span> <span class="pre">name</span> <span class="pre">'repexpr'</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">defined</span></code>, even though
writing <code class="docutils literal"><span class="pre">(print</span> <span class="pre">(foo</span> <span class="pre">3))</span></code> in <code class="docutils literal"><span class="pre">mymodule</span></code> works fine. The trouble is that your
main program doesn't have the macro <code class="docutils literal"><span class="pre">repexpr</span></code> available, since it wasn't
imported (and imported under exactly that name, as opposed to a qualified name).
You could do <code class="docutils literal"><span class="pre">(require</span> <span class="pre">[mymodule</span> <span class="pre">[*]])</span></code> or <code class="docutils literal"><span class="pre">(require</span> <span class="pre">[mymodule</span> <span class="pre">[foo</span>
<span class="pre">repexpr]])</span></code>, but a less error-prone approach is to change the definition of
<code class="docutils literal"><span class="pre">foo</span></code> to require whatever sub-macros it needs:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="kd">defmacro </span><span class="nv">foo</span> <span class="p">[</span><span class="nv">n</span><span class="p">]</span>
  <span class="o">`</span><span class="p">(</span><span class="nf">do</span>
    <span class="p">(</span><span class="nf">require</span> <span class="nv">mymodule</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">mymodule.repexpr</span> <span class="o">~</span><span class="nv">n</span> <span class="p">(</span><span class="nf">raw-input</span> <span class="s">&quot;Gimme some input: &quot;</span><span class="p">))))</span>
</pre></div>
</div>
<p>It's wise to use <code class="docutils literal"><span class="pre">(require</span> <span class="pre">mymodule)</span></code> here rather than <code class="docutils literal"><span class="pre">(require</span> <span class="pre">[mymodule</span>
<span class="pre">[repexpr]])</span></code> to avoid accidentally shadowing a function named <code class="docutils literal"><span class="pre">repexpr</span></code> in
the main program.</p>
</div>
<div class="section" id="qualified-macro-names">
<h6>Qualified macro names<a class="headerlink" href="#qualified-macro-names" title="Permalink to this headline">¶</a></h6>
<p>Note that in the current implementation, there's a trick in qualified macro
names, like <code class="docutils literal"><span class="pre">mymodule.foo</span></code> and <code class="docutils literal"><span class="pre">M.foo</span></code> in the above example. These names
aren't actually attributes of module objects; they're just identifiers with
periods in them. In fact, <code class="docutils literal"><span class="pre">mymodule</span></code> and <code class="docutils literal"><span class="pre">M</span></code> aren't defined by these
<code class="docutils literal"><span class="pre">require</span></code> forms, even at compile-time. None of this will hurt you unless try
to do introspection of the current module's set of defined macros, which isn't
really supported anyway.</p>
</div>
</div>
<div class="section" id="rest">
<h5>rest<a class="headerlink" href="#rest" title="Permalink to this headline">¶</a></h5>
<p><code class="docutils literal"><span class="pre">rest</span></code> takes the given collection and returns an iterable of all but the
first element.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">list </span><span class="p">(</span><span class="nb">rest </span><span class="p">(</span><span class="nb">range </span><span class="mi">10</span><span class="p">)))</span>
<span class="p">[</span><span class="mi">1</span>, <span class="mi">2</span>, <span class="mi">3</span>, <span class="mi">4</span>, <span class="mi">5</span>, <span class="mi">6</span>, <span class="mi">7</span>, <span class="mi">8</span>, <span class="mi">9</span><span class="p">]</span>
</pre></div>
</div>
<p>Given an empty collection, it returns an empty iterable.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">list </span><span class="p">(</span><span class="nb">rest </span><span class="p">[]))</span>
<span class="p">[]</span>
</pre></div>
</div>
</div>
<div class="section" id="set-comp">
<h5>set-comp<a class="headerlink" href="#set-comp" title="Permalink to this headline">¶</a></h5>
<p><code class="docutils literal"><span class="pre">set-comp</span></code> is used to create sets. It takes two or three parameters.
The first parameter is for controlling the return value, while the second is
used to select items from a sequence. The third and optional parameter can be
used to filter out some of the items in the sequence based on a conditional
expression.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">setv</span> <span class="n">data</span> <span class="o">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span><span class="o">])</span>
<span class="o">=&gt;</span> <span class="o">(</span><span class="n">set</span><span class="o">-</span><span class="n">comp</span> <span class="n">x</span> <span class="o">[</span><span class="n">x</span> <span class="n">data</span><span class="o">]</span> <span class="o">(</span><span class="n">odd</span><span class="o">?</span> <span class="n">x</span><span class="o">))</span>
<span class="o">{</span><span class="mi">1</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">5</span><span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="cut">
<h5>cut<a class="headerlink" href="#cut" title="Permalink to this headline">¶</a></h5>
<p><code class="docutils literal"><span class="pre">cut</span></code> can be used to take a subset of a list and create a new list from it.
The form takes at least one parameter specifying the list to cut. Two
optional parameters can be used to give the start and end position of the
subset. If they are not supplied, the default value of <code class="docutils literal"><span class="pre">None</span></code> will be used
instead. The third optional parameter is used to control step between the elements.</p>
<p><code class="docutils literal"><span class="pre">cut</span></code> follows the same rules as its Python counterpart. Negative indices are
counted starting from the end of the list. Some example usage:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">(</span><span class="k">def </span><span class="nv">collection</span> <span class="p">(</span><span class="nb">range </span><span class="mi">10</span><span class="p">))</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">cut</span> <span class="nv">collection</span><span class="p">)</span>
<span class="p">[</span><span class="mi">0</span>, <span class="mi">1</span>, <span class="mi">2</span>, <span class="mi">3</span>, <span class="mi">4</span>, <span class="mi">5</span>, <span class="mi">6</span>, <span class="mi">7</span>, <span class="mi">8</span>, <span class="mi">9</span><span class="p">]</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">cut</span> <span class="nv">collection</span> <span class="mi">5</span><span class="p">)</span>
<span class="p">[</span><span class="mi">5</span>, <span class="mi">6</span>, <span class="mi">7</span>, <span class="mi">8</span>, <span class="mi">9</span><span class="p">]</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">cut</span> <span class="nv">collection</span> <span class="mi">2</span> <span class="mi">8</span><span class="p">)</span>
<span class="p">[</span><span class="mi">2</span>, <span class="mi">3</span>, <span class="mi">4</span>, <span class="mi">5</span>, <span class="mi">6</span>, <span class="mi">7</span><span class="p">]</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">cut</span> <span class="nv">collection</span> <span class="mi">2</span> <span class="mi">8</span> <span class="mi">2</span><span class="p">)</span>
<span class="p">[</span><span class="mi">2</span>, <span class="mi">4</span>, <span class="mi">6</span><span class="p">]</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">cut</span> <span class="nv">collection</span> <span class="mi">-4</span> <span class="mi">-2</span><span class="p">)</span>
<span class="p">[</span><span class="mi">6</span>, <span class="mi">7</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="raise">
<h5>raise<a class="headerlink" href="#raise" title="Permalink to this headline">¶</a></h5>
<p>The <code class="docutils literal"><span class="pre">raise</span></code> form can be used to raise an <code class="docutils literal"><span class="pre">Exception</span></code> at
runtime. Example usage:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">raise</span><span class="p">)</span>
<span class="c1">; re-rase the last exception</span>

<span class="p">(</span><span class="nf">raise</span> <span class="nv">IOError</span><span class="p">)</span>
<span class="c1">; raise an IOError</span>

<span class="p">(</span><span class="nf">raise</span> <span class="p">(</span><span class="nf">IOError</span> <span class="s">&quot;foobar&quot;</span><span class="p">))</span>
<span class="c1">; raise an IOError(&quot;foobar&quot;)</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">raise</span></code> can accept a single argument (an <code class="docutils literal"><span class="pre">Exception</span></code> class or instance)
or no arguments to re-raise the last <code class="docutils literal"><span class="pre">Exception</span></code>.</p>
</div>
<div class="section" id="try">
<h5>try<a class="headerlink" href="#try" title="Permalink to this headline">¶</a></h5>
<p>The <code class="docutils literal"><span class="pre">try</span></code> form is used to catch exceptions (<code class="docutils literal"><span class="pre">except</span></code>) and run cleanup
actions (<code class="docutils literal"><span class="pre">finally</span></code>).</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">try</span>
  <span class="p">(</span><span class="nf">error-prone-function</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">except</span> <span class="p">[</span><span class="nv">ZeroDivisionError</span><span class="p">]</span>
    <span class="p">(</span><span class="nb">print </span><span class="s">&quot;Division by zero&quot;</span><span class="p">))</span>
  <span class="p">(</span><span class="nf">except</span> <span class="p">[[</span><span class="nv">IndexError</span> <span class="nv">KeyboardInterrupt</span><span class="p">]]</span>
    <span class="p">(</span><span class="nb">print </span><span class="s">&quot;Index error or Ctrl-C&quot;</span><span class="p">))</span>
  <span class="p">(</span><span class="nf">except</span> <span class="p">[</span><span class="nv">e</span> <span class="nv">ValueError</span><span class="p">]</span>
    <span class="p">(</span><span class="nb">print </span><span class="s">&quot;ValueError:&quot;</span> <span class="p">(</span><span class="nf">repr</span> <span class="nv">e</span><span class="p">)))</span>
  <span class="p">(</span><span class="nf">except</span> <span class="p">[</span><span class="nv">e</span> <span class="p">[</span><span class="nv">TabError</span> <span class="nv">PermissionError</span> <span class="nv">ReferenceError</span><span class="p">]]</span>
    <span class="p">(</span><span class="nb">print </span><span class="s">&quot;Some sort of error:&quot;</span> <span class="p">(</span><span class="nf">repr</span> <span class="nv">e</span><span class="p">)))</span>
  <span class="p">(</span><span class="nf">else</span>
    <span class="p">(</span><span class="nb">print </span><span class="s">&quot;No errors&quot;</span><span class="p">))</span>
  <span class="p">(</span><span class="nf">finally</span>
    <span class="p">(</span><span class="nb">print </span><span class="s">&quot;All done&quot;</span><span class="p">)))</span>
</pre></div>
</div>
<p>The first argument of <code class="docutils literal"><span class="pre">try</span></code> is its body. (To put more than one form in the
body, use <code class="docutils literal"><span class="pre">do</span></code>.) Then comes any number of <code class="docutils literal"><span class="pre">except</span></code> clauses, then optionally
an <code class="docutils literal"><span class="pre">else</span></code> clause, then optionally a <code class="docutils literal"><span class="pre">finally</span></code> clause. If an exception is
raised with a matching <code class="docutils literal"><span class="pre">except</span></code> clause during the execution of the body, that
<code class="docutils literal"><span class="pre">except</span></code> clause will be executed. If no exceptions are raised, the <code class="docutils literal"><span class="pre">else</span></code>
clause is executed. The <code class="docutils literal"><span class="pre">finally</span></code> clause will be executed last regardless of
whether an exception was raised.</p>
<p>The return value of <code class="docutils literal"><span class="pre">try</span></code> is the last form of the <code class="docutils literal"><span class="pre">except</span></code> clause that was
run, or the last form of <code class="docutils literal"><span class="pre">else</span></code> if no exception was raised, or the <code class="docutils literal"><span class="pre">try</span></code>
body if there is no <code class="docutils literal"><span class="pre">else</span></code> clause.</p>
</div>
<div class="section" id="unless">
<h5>unless<a class="headerlink" href="#unless" title="Permalink to this headline">¶</a></h5>
<p>The <code class="docutils literal"><span class="pre">unless</span></code> macro is a shorthand for writing an <code class="docutils literal"><span class="pre">if</span></code> statement that checks if
the given conditional is <code class="docutils literal"><span class="pre">False</span></code>. The following shows the expansion of this macro.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">unless</span> <span class="nv">conditional</span> <span class="nv">statement</span><span class="p">)</span>

<span class="p">(</span><span class="k">if </span><span class="nv">conditional</span>
  <span class="nv">None</span>
  <span class="p">(</span><span class="k">do </span><span class="nv">statement</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="unquote">
<h5>unquote<a class="headerlink" href="#unquote" title="Permalink to this headline">¶</a></h5>
<p>Within a quasiquoted form, <code class="docutils literal"><span class="pre">unquote</span></code> forces evaluation of a symbol. <code class="docutils literal"><span class="pre">unquote</span></code>
is aliased to the tilde (<code class="docutils literal"><span class="pre">~</span></code>) symbol.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">def </span><span class="nb">name </span><span class="s">&quot;Cuddles&quot;</span><span class="p">)</span>
<span class="p">(</span><span class="nf">quasiquote</span> <span class="p">(</span><span class="nb">= name </span><span class="p">(</span><span class="nf">unquote</span> <span class="nv">name</span><span class="p">)))</span>
<span class="c1">;=&gt; (u&#39;=&#39; u&#39;name&#39; u&#39;Cuddles&#39;)</span>

<span class="o">`</span><span class="p">(</span><span class="nb">= name </span><span class="o">~</span><span class="nv">name</span><span class="p">)</span>
<span class="c1">;=&gt; (u&#39;=&#39; u&#39;name&#39; u&#39;Cuddles&#39;)</span>
</pre></div>
</div>
</div>
<div class="section" id="unquote-splice">
<h5>unquote-splice<a class="headerlink" href="#unquote-splice" title="Permalink to this headline">¶</a></h5>
<p><code class="docutils literal"><span class="pre">unquote-splice</span></code> forces the evaluation of a symbol within a quasiquoted form,
much like <code class="docutils literal"><span class="pre">unquote</span></code>. <code class="docutils literal"><span class="pre">unquote-splice</span></code> can only be used when the symbol
being unquoted contains an iterable value, as it &quot;splices&quot; that iterable into
the quasiquoted form. <code class="docutils literal"><span class="pre">unquote-splice</span></code> is aliased to the <code class="docutils literal"><span class="pre">~&#64;</span></code> symbol.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">def </span><span class="nv">nums</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">])</span>
<span class="p">(</span><span class="nf">quasiquote</span> <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">unquote-splice</span> <span class="nv">nums</span><span class="p">)))</span>
<span class="c1">;=&gt; (u&#39;+&#39; 1L 2L 3L 4L)</span>

<span class="o">`</span><span class="p">(</span><span class="nb">+ </span><span class="o">~@</span><span class="nv">nums</span><span class="p">)</span>
<span class="c1">;=&gt; (u&#39;+&#39; 1L 2L 3L 4L)</span>
</pre></div>
</div>
</div>
<div class="section" id="when">
<h5>when<a class="headerlink" href="#when" title="Permalink to this headline">¶</a></h5>
<p><code class="docutils literal"><span class="pre">when</span></code> is similar to <code class="docutils literal"><span class="pre">unless</span></code>, except it tests when the given conditional is
<code class="docutils literal"><span class="pre">True</span></code>. It is not possible to have an <code class="docutils literal"><span class="pre">else</span></code> block in a <code class="docutils literal"><span class="pre">when</span></code> macro. The
following shows the expansion of the macro.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">when </span><span class="nv">conditional</span> <span class="nv">statement</span><span class="p">)</span>

<span class="p">(</span><span class="k">if </span><span class="nv">conditional</span> <span class="p">(</span><span class="k">do </span><span class="nv">statement</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="while">
<h5>while<a class="headerlink" href="#while" title="Permalink to this headline">¶</a></h5>
<p><code class="docutils literal"><span class="pre">while</span></code> is used to execute one or more blocks as long as a condition is met.
The following example will output &quot;Hello world!&quot; to the screen indefinitely:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">while</span> <span class="nv">True</span> <span class="p">(</span><span class="nb">print </span><span class="s">&quot;Hello world!&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="with">
<h5>with<a class="headerlink" href="#with" title="Permalink to this headline">¶</a></h5>
<p><code class="docutils literal"><span class="pre">with</span></code> is used to wrap the execution of a block within a context manager. The
context manager can then set up the local system and tear it down in a controlled
manner. The archetypical example of using <code class="docutils literal"><span class="pre">with</span></code> is when processing files.
<code class="docutils literal"><span class="pre">with</span></code> can bind context to an argument or ignore it completely, as shown below:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">with</span> <span class="p">[</span><span class="nv">arg</span> <span class="p">(</span><span class="nf">expr</span><span class="p">)]</span> <span class="nv">block</span><span class="p">)</span>

<span class="p">(</span><span class="nf">with</span> <span class="p">[(</span><span class="nf">expr</span><span class="p">)]</span> <span class="nv">block</span><span class="p">)</span>

<span class="p">(</span><span class="nf">with</span> <span class="p">[</span><span class="nv">arg</span> <span class="p">(</span><span class="nf">expr</span><span class="p">)</span> <span class="p">(</span><span class="nf">expr</span><span class="p">)]</span> <span class="nv">block</span><span class="p">)</span>
</pre></div>
</div>
<p>The following example will open the <code class="docutils literal"><span class="pre">NEWS</span></code> file and print its content to the
screen. The file is automatically closed after it has been processed.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">with</span> <span class="p">[</span><span class="nv">f</span> <span class="p">(</span><span class="nf">open</span> <span class="s">&quot;NEWS&quot;</span><span class="p">)]</span> <span class="p">(</span><span class="nb">print </span><span class="p">(</span><span class="nf">.read</span> <span class="nv">f</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="section" id="with-decorator">
<h5>with-decorator<a class="headerlink" href="#with-decorator" title="Permalink to this headline">¶</a></h5>
<p><code class="docutils literal"><span class="pre">with-decorator</span></code> is used to wrap a function with another. The function
performing the decoration should accept a single value: the function being
decorated, and return a new function. <code class="docutils literal"><span class="pre">with-decorator</span></code> takes a minimum
of two parameters: the function performing decoration and the function
being decorated. More than one decorator function can be applied; they
will be applied in order from outermost to innermost, ie. the first
decorator will be the outermost one, and so on. Decorators with arguments
are called just like a function call.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nf">with-decorator</span> <span class="nv">decorator-fun</span>
   <span class="p">(</span><span class="kd">defn </span><span class="nv">some-function</span> <span class="p">[]</span> <span class="nv">...</span><span class="p">)</span>

<span class="p">(</span><span class="nf">with-decorator</span> <span class="nv">decorator1</span> <span class="nv">decorator2</span> <span class="nv">...</span>
   <span class="p">(</span><span class="kd">defn </span><span class="nv">some-function</span> <span class="p">[]</span> <span class="nv">...</span><span class="p">)</span>

<span class="p">(</span><span class="nf">with-decorator</span> <span class="p">(</span><span class="nf">decorator</span> <span class="nv">arg</span><span class="p">)</span> <span class="nv">..</span>
   <span class="p">(</span><span class="kd">defn </span><span class="nv">some-function</span> <span class="p">[]</span> <span class="nv">...</span><span class="p">)</span>
</pre></div>
</div>
<p>In the following example, <code class="docutils literal"><span class="pre">inc-decorator</span></code> is used to decorate the function
<code class="docutils literal"><span class="pre">addition</span></code> with a function that takes two parameters and calls the
decorated function with values that are incremented by 1. When
the decorated <code class="docutils literal"><span class="pre">addition</span></code> is called with values 1 and 1, the end result
will be 4 (<code class="docutils literal"><span class="pre">1+1</span> <span class="pre">+</span> <span class="pre">1+1</span></code>).</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">(</span><span class="kd">defn </span><span class="nv">inc-decorator</span> <span class="p">[</span><span class="nv">func</span><span class="p">]</span>
<span class="nv">...</span>  <span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">value-1</span> <span class="nv">value-2</span><span class="p">]</span> <span class="p">(</span><span class="nf">func</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">value-1</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">value-2</span> <span class="mi">1</span><span class="p">))))</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="kd">defn </span><span class="nv">inc2-decorator</span> <span class="p">[</span><span class="nv">func</span><span class="p">]</span>
<span class="nv">...</span>  <span class="p">(</span><span class="k">fn </span><span class="p">[</span><span class="nv">value-1</span> <span class="nv">value-2</span><span class="p">]</span> <span class="p">(</span><span class="nf">func</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">value-1</span> <span class="mi">2</span><span class="p">)</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">value-2</span> <span class="mi">2</span><span class="p">))))</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">with-decorator</span> <span class="nv">inc-decorator</span> <span class="p">(</span><span class="kd">defn </span><span class="nv">addition</span> <span class="p">[</span><span class="nv">a</span> <span class="nv">b</span><span class="p">]</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">a</span> <span class="nv">b</span><span class="p">)))</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">addition</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">)</span>
<span class="mi">4</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">with-decorator</span> <span class="nv">inc2-decorator</span> <span class="nv">inc-decorator</span>
<span class="nv">...</span>  <span class="p">(</span><span class="kd">defn </span><span class="nv">addition</span> <span class="p">[</span><span class="nv">a</span> <span class="nv">b</span><span class="p">]</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">a</span> <span class="nv">b</span><span class="p">)))</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">addition</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">)</span>
<span class="mi">8</span>
</pre></div>
</div>
<div class="section" id="id11">
<h6>#&#64;<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h6>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.12.0.</span></p>
</div>
<p>The sharp macro <code class="docutils literal"><span class="pre">#&#64;</span></code> can be used as a shorthand for <code class="docutils literal"><span class="pre">with-decorator</span></code>. With
<code class="docutils literal"><span class="pre">#&#64;</span></code>, the previous example becomes:</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="o">#@</span><span class="p">(</span><span class="nf">inc-decorator</span> <span class="p">(</span><span class="kd">defn </span><span class="nv">addition</span> <span class="p">[</span><span class="nv">a</span> <span class="nv">b</span><span class="p">]</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">a</span> <span class="nv">b</span><span class="p">)))</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">addition</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">)</span>
<span class="mi">4</span>
<span class="nv">=&gt;</span> <span class="o">#@</span><span class="p">(</span><span class="nf">inc2-decorator</span> <span class="nv">inc-decorator</span>
<span class="nv">...</span>   <span class="p">(</span><span class="kd">defn </span><span class="nv">addition</span> <span class="p">[</span><span class="nv">a</span> <span class="nv">b</span><span class="p">]</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">a</span> <span class="nv">b</span><span class="p">)))</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">addition</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">)</span>
<span class="mi">8</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="with-gensyms">
<span id="id12"></span><h5>with-gensyms<a class="headerlink" href="#with-gensyms" title="Permalink to this headline">¶</a></h5>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.9.12.</span></p>
</div>
<p><code class="docutils literal"><span class="pre">with-gensym</span></code> is used to generate a set of <a class="reference internal" href="#gensym"><span class="std std-ref">gensym</span></a> for use in a macro.
The following code:</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">(</span><span class="n">with</span><span class="o">-</span><span class="n">gensyms</span> <span class="o">[</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span><span class="o">]</span>
  <span class="o">...)</span>
</pre></div>
</div>
<p>expands to:</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">(</span><span class="k">do</span>
  <span class="o">(</span><span class="n">setv</span> <span class="n">a</span> <span class="o">(</span><span class="n">gensym</span><span class="o">)</span>
        <span class="n">b</span> <span class="o">(</span><span class="n">gensym</span><span class="o">)</span>
        <span class="n">c</span> <span class="o">(</span><span class="n">gensym</span><span class="o">))</span>
  <span class="o">...)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">Section <a class="reference internal" href="index.html#using-gensym"><span class="std std-ref">Using gensym for Safer Macros</span></a></p>
</div>
</div>
<div class="section" id="xor">
<h5>xor<a class="headerlink" href="#xor" title="Permalink to this headline">¶</a></h5>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.12.0.</span></p>
</div>
<p><code class="docutils literal"><span class="pre">xor</span></code> performs the logical operation of exclusive OR. It takes two arguments.
If exactly one argument is true, that argument is returned. If neither is true,
the second argument is returned (which will necessarily be false). Otherwise,
when both arguments are true, the value <code class="docutils literal"><span class="pre">False</span></code> is returned.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">[(</span><span class="nf">xor</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nf">xor</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nf">xor</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">)</span> <span class="p">(</span><span class="nf">xor</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">)]</span>
<span class="p">[</span><span class="mi">0</span>, <span class="mi">1</span>, <span class="mi">1</span>, <span class="nv">False</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="yield">
<h5>yield<a class="headerlink" href="#yield" title="Permalink to this headline">¶</a></h5>
<p><code class="docutils literal"><span class="pre">yield</span></code> is used to create a generator object that returns one or more values.
The generator is iterable and therefore can be used in loops, list
comprehensions and other similar constructs.</p>
<p>The function <code class="docutils literal"><span class="pre">random-numbers</span></code> shows how generators can be used to generate
infinite series without consuming infinite amount of memory.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">(</span><span class="kd">defn </span><span class="nv">multiply</span> <span class="p">[</span><span class="nv">bases</span> <span class="nv">coefficients</span><span class="p">]</span>
<span class="nv">...</span>  <span class="p">(</span><span class="nb">for </span><span class="p">[(</span>, <span class="nv">base</span> <span class="nv">coefficient</span><span class="p">)</span> <span class="p">(</span><span class="nf">zip</span> <span class="nv">bases</span> <span class="nv">coefficients</span><span class="p">)]</span>
<span class="nv">...</span>   <span class="p">(</span><span class="nf">yield</span> <span class="p">(</span><span class="nb">* </span><span class="nv">base</span> <span class="nv">coefficient</span><span class="p">))))</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">multiply</span> <span class="p">(</span><span class="nb">range </span><span class="mi">5</span><span class="p">)</span> <span class="p">(</span><span class="nb">range </span><span class="mi">5</span><span class="p">))</span>
<span class="nv">&lt;generator</span> <span class="nv">object</span> <span class="nv">multiply</span> <span class="nv">at</span> <span class="mi">0</span><span class="nv">x978d8ec&gt;</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">list-comp</span> <span class="nv">value</span> <span class="p">[</span><span class="nv">value</span> <span class="p">(</span><span class="nf">multiply</span> <span class="p">(</span><span class="nb">range </span><span class="mi">10</span><span class="p">)</span> <span class="p">(</span><span class="nb">range </span><span class="mi">10</span><span class="p">))])</span>
<span class="p">[</span><span class="mi">0</span>, <span class="mi">1</span>, <span class="mi">4</span>, <span class="mi">9</span>, <span class="mi">16</span>, <span class="mi">25</span>, <span class="mi">36</span>, <span class="mi">49</span>, <span class="mi">64</span>, <span class="mi">81</span><span class="p">]</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">import </span><span class="nv">random</span><span class="p">)</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="kd">defn </span><span class="nv">random-numbers</span> <span class="p">[</span><span class="nv">low</span> <span class="nv">high</span><span class="p">]</span>
<span class="nv">...</span>  <span class="p">(</span><span class="nf">while</span> <span class="nv">True</span> <span class="p">(</span><span class="nf">yield</span> <span class="p">(</span><span class="nf">.randint</span> <span class="nv">random</span> <span class="nv">low</span> <span class="nv">high</span><span class="p">))))</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">list-comp</span> <span class="nv">x</span> <span class="p">[</span><span class="nv">x</span> <span class="p">(</span><span class="nb">take </span><span class="mi">15</span> <span class="p">(</span><span class="nf">random-numbers</span> <span class="mi">1</span> <span class="mi">50</span><span class="p">))])</span>
<span class="p">[</span><span class="mi">7</span>, <span class="mi">41</span>, <span class="mi">6</span>, <span class="mi">22</span>, <span class="mi">32</span>, <span class="mi">17</span>, <span class="mi">5</span>, <span class="mi">38</span>, <span class="mi">18</span>, <span class="mi">38</span>, <span class="mi">17</span>, <span class="mi">14</span>, <span class="mi">23</span>, <span class="mi">23</span>, <span class="mi">19</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="yield-from">
<h5>yield-from<a class="headerlink" href="#yield-from" title="Permalink to this headline">¶</a></h5>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.9.13.</span></p>
</div>
<p><strong>PYTHON 3.3 AND UP ONLY!</strong></p>
<p><code class="docutils literal"><span class="pre">yield-from</span></code> is used to call a subgenerator.  This is useful if you
want your coroutine to be able to delegate its processes to another
coroutine, say, if using something fancy like
<a class="reference external" href="https://docs.python.org/3.4/library/asyncio.html">asyncio</a>.</p>
</div>
</div>
</div>
<span id="document-language/core"></span><div class="section" id="hy-core">
<h3>Hy Core<a class="headerlink" href="#hy-core" title="Permalink to this headline">¶</a></h3>
<div class="section" id="core-functions">
<h4>Core Functions<a class="headerlink" href="#core-functions" title="Permalink to this headline">¶</a></h4>
<div class="section" id="butlast">
<span id="butlast-fn"></span><h5>butlast<a class="headerlink" href="#butlast" title="Permalink to this headline">¶</a></h5>
<p>Usage: <code class="docutils literal"><span class="pre">(butlast</span> <span class="pre">coll)</span></code></p>
<p>Returns an iterator of all but the last item in <em>coll</em>.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">butlast</span> <span class="o">(</span><span class="n">range</span> <span class="mi">10</span><span class="o">)))</span>
<span class="o">[</span><span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">6</span><span class="o">,</span> <span class="mi">7</span><span class="o">,</span> <span class="mi">8</span><span class="o">]</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">butlast</span> <span class="o">[</span><span class="mi">1</span><span class="o">]))</span>
<span class="o">[]</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">butlast</span> <span class="o">[]))</span>
<span class="o">[]</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">take</span> <span class="mi">5</span> <span class="o">(</span><span class="n">butlast</span> <span class="o">(</span><span class="n">count</span> <span class="mi">10</span><span class="o">))))</span>
<span class="o">[</span><span class="mi">10</span><span class="o">,</span> <span class="mi">11</span><span class="o">,</span> <span class="mi">12</span><span class="o">,</span> <span class="mi">13</span><span class="o">,</span> <span class="mi">14</span><span class="o">]</span>
</pre></div>
</div>
</div>
<div class="section" id="coll">
<span id="is-coll-fn"></span><h5>coll?<a class="headerlink" href="#coll" title="Permalink to this headline">¶</a></h5>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.10.0.</span></p>
</div>
<p>Usage: <code class="docutils literal"><span class="pre">(coll?</span> <span class="pre">x)</span></code></p>
<p>Returns <code class="docutils literal"><span class="pre">True</span></code> if <em>x</em> is iterable and not a string.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">coll</span><span class="o">?</span> <span class="o">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span><span class="o">])</span>
<span class="n">True</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">coll</span><span class="o">?</span> <span class="o">{</span><span class="s">&quot;a&quot;</span> <span class="mi">1</span> <span class="s">&quot;b&quot;</span> <span class="mi">2</span><span class="o">})</span>
<span class="n">True</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">coll</span><span class="o">?</span> <span class="s">&quot;abc&quot;</span><span class="o">)</span>
<span class="n">False</span>
</pre></div>
</div>
</div>
<div class="section" id="comp">
<span id="id1"></span><h5>comp<a class="headerlink" href="#comp" title="Permalink to this headline">¶</a></h5>
<p>Usage: <code class="docutils literal"><span class="pre">(comp</span> <span class="pre">f</span> <span class="pre">g)</span></code></p>
<p>Compose zero or more functions into a new function. The new function will
chain the given functions together, so <code class="docutils literal"><span class="pre">((comp</span> <span class="pre">g</span> <span class="pre">f)</span> <span class="pre">x)</span></code> is equivalent to
<code class="docutils literal"><span class="pre">(g</span> <span class="pre">(f</span> <span class="pre">x))</span></code>. Called without arguments, <code class="docutils literal"><span class="pre">comp</span></code> returns <code class="docutils literal"><span class="pre">identity</span></code>.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">def</span> <span class="n">example</span> <span class="o">(</span><span class="n">comp</span> <span class="n">str</span> <span class="o">+))</span>
<span class="o">=&gt;</span> <span class="o">(</span><span class="n">example</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="o">)</span>
<span class="s">&quot;6&quot;</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">def</span> <span class="n">simple</span> <span class="o">(</span><span class="n">comp</span><span class="o">))</span>
<span class="o">=&gt;</span> <span class="o">(</span><span class="n">simple</span> <span class="s">&quot;hello&quot;</span><span class="o">)</span>
<span class="s">&quot;hello&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="complement">
<span id="id2"></span><h5>complement<a class="headerlink" href="#complement" title="Permalink to this headline">¶</a></h5>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.12.0.</span></p>
</div>
<p>Usage: <code class="docutils literal"><span class="pre">(complement</span> <span class="pre">f)</span></code></p>
<p>Returns a new function that returns the same thing as <code class="docutils literal"><span class="pre">f</span></code>, but logically
inverted. So, <code class="docutils literal"><span class="pre">((complement</span> <span class="pre">f)</span> <span class="pre">x)</span></code> is equivalent to <code class="docutils literal"><span class="pre">(not</span> <span class="pre">(f</span> <span class="pre">x))</span></code>.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">def</span> <span class="n">inverse</span> <span class="o">(</span><span class="n">complement</span> <span class="n">identity</span><span class="o">))</span>
<span class="o">=&gt;</span> <span class="o">(</span><span class="n">inverse</span> <span class="n">True</span><span class="o">)</span>
<span class="n">False</span>
<span class="o">=&gt;</span> <span class="o">(</span><span class="n">inverse</span> <span class="mi">1</span><span class="o">)</span>
<span class="n">False</span>
<span class="o">=&gt;</span> <span class="o">(</span><span class="n">inverse</span> <span class="n">False</span><span class="o">)</span>
<span class="n">True</span>
</pre></div>
</div>
</div>
<div class="section" id="cons">
<h5>cons<a class="headerlink" href="#cons" title="Permalink to this headline">¶</a></h5>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.10.0.</span></p>
</div>
<p>Usage: <code class="docutils literal"><span class="pre">(cons</span> <span class="pre">a</span> <span class="pre">b)</span></code></p>
<p>Returns a fresh <a class="reference internal" href="index.html#hycons"><span class="std std-ref">cons cell</span></a> with car <em>a</em> and cdr <em>b</em>.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span>=&gt; (setv a (cons &#39;hd &#39;tl))

=&gt; (= &#39;hd (get a 0))
True

=&gt; (= &#39;tl (cut a 1))
True
</pre></div>
</div>
</div>
<div class="section" id="id3">
<h5>cons?<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h5>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.10.0.</span></p>
</div>
<p>Usage: <code class="docutils literal"><span class="pre">(cons?</span> <span class="pre">foo)</span></code></p>
<p>Checks whether <em>foo</em> is a <a class="reference internal" href="index.html#hycons"><span class="std std-ref">cons cell</span></a>.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span>=&gt; (setv a (cons &#39;hd &#39;tl))

=&gt; (cons? a)
True

=&gt; (cons? None)
False

=&gt; (cons? [1 2 3])
False
</pre></div>
</div>
</div>
<div class="section" id="constantly">
<span id="id4"></span><h5>constantly<a class="headerlink" href="#constantly" title="Permalink to this headline">¶</a></h5>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.12.0.</span></p>
</div>
<p>Usage <code class="docutils literal"><span class="pre">(constantly</span> <span class="pre">42)</span></code></p>
<p>Create a new function that always returns the given value, regardless of
the arguments given to it.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">def</span> <span class="n">answer</span> <span class="o">(</span><span class="n">constantly</span> <span class="mi">42</span><span class="o">))</span>
<span class="o">=&gt;</span> <span class="o">(</span><span class="n">answer</span><span class="o">)</span>
<span class="mi">42</span>
<span class="o">=&gt;</span> <span class="o">(</span><span class="n">answer</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="o">)</span>
<span class="mi">42</span>
<span class="o">=&gt;</span> <span class="o">(</span><span class="n">answer</span> <span class="mi">1</span> <span class="o">:</span><span class="n">foo</span> <span class="mi">2</span><span class="o">)</span>
<span class="mi">42</span>
</pre></div>
</div>
</div>
<div class="section" id="dec">
<span id="dec-fn"></span><h5>dec<a class="headerlink" href="#dec" title="Permalink to this headline">¶</a></h5>
<p>Usage: <code class="docutils literal"><span class="pre">(dec</span> <span class="pre">x)</span></code></p>
<p>Returns one less than <em>x</em>. Equivalent to <code class="docutils literal"><span class="pre">(-</span> <span class="pre">x</span> <span class="pre">1)</span></code>. Raises <code class="docutils literal"><span class="pre">TypeError</span></code>
if <code class="docutils literal"><span class="pre">(not</span> <span class="pre">(numeric?</span> <span class="pre">x))</span></code>.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">dec</span> <span class="mi">3</span><span class="o">)</span>
<span class="mi">2</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">dec</span> <span class="mi">0</span><span class="o">)</span>
<span class="o">-</span><span class="mi">1</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">dec</span> <span class="mf">12.3</span><span class="o">)</span>
<span class="mf">11.3</span>
</pre></div>
</div>
</div>
<div class="section" id="disassemble">
<span id="disassemble-fn"></span><h5>disassemble<a class="headerlink" href="#disassemble" title="Permalink to this headline">¶</a></h5>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.10.0.</span></p>
</div>
<p>Usage: <code class="docutils literal"><span class="pre">(disassemble</span> <span class="pre">tree</span> <span class="pre">&amp;optional</span> <span class="pre">[codegen</span> <span class="pre">false])</span></code></p>
<p>Dump the Python AST for given Hy <em>tree</em> to standard output. If <em>codegen</em>
is <code class="docutils literal"><span class="pre">True</span></code>, the function prints Python code instead.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span>=&gt; (disassemble &#39;(print &quot;Hello World!&quot;))
Module(
 body=[
     Expr(value=Call(func=Name(id=&#39;print&#39;), args=[Str(s=&#39;Hello World!&#39;)], keywords=[], starargs=None, kwargs=None))])

=&gt; (disassemble &#39;(print &quot;Hello World!&quot;) True)
print(&#39;Hello World!&#39;)
</pre></div>
</div>
</div>
<div class="section" id="empty">
<span id="empty-fn"></span><h5>empty?<a class="headerlink" href="#empty" title="Permalink to this headline">¶</a></h5>
<p>Usage: <code class="docutils literal"><span class="pre">(empty?</span> <span class="pre">coll)</span></code></p>
<p>Returns <code class="docutils literal"><span class="pre">True</span></code> if <em>coll</em> is empty. Equivalent to <code class="docutils literal"><span class="pre">(=</span> <span class="pre">0</span> <span class="pre">(len</span> <span class="pre">coll))</span></code>.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">empty</span><span class="o">?</span> <span class="o">[])</span>
<span class="n">True</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">empty</span><span class="o">?</span> <span class="s">&quot;&quot;</span><span class="o">)</span>
<span class="n">True</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">empty</span><span class="o">?</span> <span class="o">(,</span> <span class="mi">1</span> <span class="mi">2</span><span class="o">))</span>
<span class="n">False</span>
</pre></div>
</div>
</div>
<div class="section" id="every">
<span id="every-fn"></span><h5>every?<a class="headerlink" href="#every" title="Permalink to this headline">¶</a></h5>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.10.0.</span></p>
</div>
<p>Usage: <code class="docutils literal"><span class="pre">(every?</span> <span class="pre">pred</span> <span class="pre">coll)</span></code></p>
<p>Returns <code class="docutils literal"><span class="pre">True</span></code> if <code class="docutils literal"><span class="pre">(pred</span> <span class="pre">x)</span></code> is logical true for every <em>x</em> in <em>coll</em>,
otherwise <code class="docutils literal"><span class="pre">False</span></code>. Return <code class="docutils literal"><span class="pre">True</span></code> if <em>coll</em> is empty.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">every</span><span class="o">?</span> <span class="n">even</span><span class="o">?</span> <span class="o">[</span><span class="mi">2</span> <span class="mi">4</span> <span class="mi">6</span><span class="o">])</span>
<span class="n">True</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">every</span><span class="o">?</span> <span class="n">even</span><span class="o">?</span> <span class="o">[</span><span class="mi">1</span> <span class="mi">3</span> <span class="mi">5</span><span class="o">])</span>
<span class="n">False</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">every</span><span class="o">?</span> <span class="n">even</span><span class="o">?</span> <span class="o">[</span><span class="mi">2</span> <span class="mi">4</span> <span class="mi">5</span><span class="o">])</span>
<span class="n">False</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">every</span><span class="o">?</span> <span class="n">even</span><span class="o">?</span> <span class="o">[])</span>
<span class="n">True</span>
</pre></div>
</div>
</div>
<div class="section" id="float">
<span id="float-fn"></span><h5>float?<a class="headerlink" href="#float" title="Permalink to this headline">¶</a></h5>
<p>Usage: <code class="docutils literal"><span class="pre">(float?</span> <span class="pre">x)</span></code></p>
<p>Returns <code class="docutils literal"><span class="pre">True</span></code> if <em>x</em> is a float.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">float</span><span class="o">?</span> <span class="mf">3.2</span><span class="o">)</span>
<span class="n">True</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">float</span><span class="o">?</span> <span class="o">-</span><span class="mi">2</span><span class="o">)</span>
<span class="n">False</span>
</pre></div>
</div>
</div>
<div class="section" id="fraction">
<span id="fraction-fn"></span><h5>fraction<a class="headerlink" href="#fraction" title="Permalink to this headline">¶</a></h5>
<p>Returns a Python object of type <code class="docutils literal"><span class="pre">fractions.Fraction</span></code>.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">fraction</span> <span class="mi">1</span> <span class="mi">2</span><span class="o">)</span>
<span class="n">Fraction</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">)</span>
</pre></div>
</div>
<p>Note that Hy has a built-in fraction literal that does the same thing:</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span>
<span class="n">Fraction</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">)</span>
</pre></div>
</div>
</div>
<div class="section" id="even">
<span id="even-fn"></span><h5>even?<a class="headerlink" href="#even" title="Permalink to this headline">¶</a></h5>
<p>Usage: <code class="docutils literal"><span class="pre">(even?</span> <span class="pre">x)</span></code></p>
<p>Returns <code class="docutils literal"><span class="pre">True</span></code> if <em>x</em> is even. Raises <code class="docutils literal"><span class="pre">TypeError</span></code> if
<code class="docutils literal"><span class="pre">(not</span> <span class="pre">(numeric?</span> <span class="pre">x))</span></code>.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">even</span><span class="o">?</span> <span class="mi">2</span><span class="o">)</span>
<span class="n">True</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">even</span><span class="o">?</span> <span class="mi">13</span><span class="o">)</span>
<span class="n">False</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">even</span><span class="o">?</span> <span class="mi">0</span><span class="o">)</span>
<span class="n">True</span>
</pre></div>
</div>
</div>
<div class="section" id="identity-fn">
<span id="identity"></span><h5>identity<a class="headerlink" href="#identity-fn" title="Permalink to this headline">¶</a></h5>
<p>Usage: <code class="docutils literal"><span class="pre">(identity</span> <span class="pre">x)</span></code></p>
<p>Returns the argument supplied to the function.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">identity</span> <span class="mi">4</span><span class="o">)</span>
<span class="mi">4</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">map</span> <span class="n">identity</span> <span class="o">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span><span class="o">]))</span>
<span class="o">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span><span class="o">]</span>
</pre></div>
</div>
</div>
<div class="section" id="inc">
<span id="inc-fn"></span><h5>inc<a class="headerlink" href="#inc" title="Permalink to this headline">¶</a></h5>
<p>Usage: <code class="docutils literal"><span class="pre">(inc</span> <span class="pre">x)</span></code></p>
<p>Returns one more than <em>x</em>. Equivalent to <code class="docutils literal"><span class="pre">(+</span> <span class="pre">x</span> <span class="pre">1)</span></code>. Raises <code class="docutils literal"><span class="pre">TypeError</span></code>
if <code class="docutils literal"><span class="pre">(not</span> <span class="pre">(numeric?</span> <span class="pre">x))</span></code>.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">inc</span> <span class="mi">3</span><span class="o">)</span>
<span class="mi">4</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">inc</span> <span class="mi">0</span><span class="o">)</span>
<span class="mi">1</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">inc</span> <span class="mf">12.3</span><span class="o">)</span>
<span class="mf">13.3</span>
</pre></div>
</div>
</div>
<div class="section" id="instance">
<span id="instance-fn"></span><h5>instance?<a class="headerlink" href="#instance" title="Permalink to this headline">¶</a></h5>
<p>Usage: <code class="docutils literal"><span class="pre">(instance?</span> <span class="pre">class</span> <span class="pre">x)</span></code></p>
<p>Returns <code class="docutils literal"><span class="pre">True</span></code> if <em>x</em> is an instance of <em>class</em>.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">instance</span><span class="o">?</span> <span class="n">float</span> <span class="mf">1.0</span><span class="o">)</span>
<span class="n">True</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">instance</span><span class="o">?</span> <span class="n">int</span> <span class="mi">7</span><span class="o">)</span>
<span class="n">True</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">instance</span><span class="o">?</span> <span class="n">str</span> <span class="o">(</span><span class="n">str</span> <span class="s">&quot;foo&quot;</span><span class="o">))</span>
<span class="n">True</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">defclass</span> <span class="n">TestClass</span> <span class="o">[</span><span class="n">object</span><span class="o">])</span>
<span class="o">=&gt;</span> <span class="o">(</span><span class="n">setv</span> <span class="n">inst</span> <span class="o">(</span><span class="n">TestClass</span><span class="o">))</span>
<span class="o">=&gt;</span> <span class="o">(</span><span class="n">instance</span><span class="o">?</span> <span class="n">TestClass</span> <span class="n">inst</span><span class="o">)</span>
<span class="n">True</span>
</pre></div>
</div>
</div>
<div class="section" id="integer">
<span id="integer-fn"></span><h5>integer?<a class="headerlink" href="#integer" title="Permalink to this headline">¶</a></h5>
<p>Usage: <code class="docutils literal"><span class="pre">(integer?</span> <span class="pre">x)</span></code></p>
<p>Returns <cite>True</cite> if <em>x</em> is an integer. For Python 2, this is
either <code class="docutils literal"><span class="pre">int</span></code> or <code class="docutils literal"><span class="pre">long</span></code>. For Python 3, this is <code class="docutils literal"><span class="pre">int</span></code>.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">integer</span><span class="o">?</span> <span class="mi">3</span><span class="o">)</span>
<span class="n">True</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">integer</span><span class="o">?</span> <span class="o">-</span><span class="mf">2.4</span><span class="o">)</span>
<span class="n">False</span>
</pre></div>
</div>
</div>
<div class="section" id="interleave">
<span id="interleave-fn"></span><h5>interleave<a class="headerlink" href="#interleave" title="Permalink to this headline">¶</a></h5>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.10.1.</span></p>
</div>
<p>Usage: <code class="docutils literal"><span class="pre">(interleave</span> <span class="pre">seq1</span> <span class="pre">seq2</span> <span class="pre">...)</span></code></p>
<p>Returns an iterable of the first item in each of the sequences,
then the second, etc.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">interleave</span> <span class="o">(</span><span class="n">range</span> <span class="mi">5</span><span class="o">)</span> <span class="o">(</span><span class="n">range</span> <span class="mi">100</span> <span class="mi">105</span><span class="o">)))</span>
<span class="o">[</span><span class="mi">0</span><span class="o">,</span> <span class="mi">100</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">101</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">102</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">103</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">104</span><span class="o">]</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">interleave</span> <span class="o">(</span><span class="n">range</span> <span class="mi">1000000</span><span class="o">)</span> <span class="s">&quot;abc&quot;</span><span class="o">))</span>
<span class="o">[</span><span class="mi">0</span><span class="o">,</span> <span class="sc">&#39;a&#39;</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="sc">&#39;b&#39;</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="sc">&#39;c&#39;</span><span class="o">]</span>
</pre></div>
</div>
</div>
<div class="section" id="interpose">
<span id="interpose-fn"></span><h5>interpose<a class="headerlink" href="#interpose" title="Permalink to this headline">¶</a></h5>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.10.1.</span></p>
</div>
<p>Usage: <code class="docutils literal"><span class="pre">(interpose</span> <span class="pre">item</span> <span class="pre">seq)</span></code></p>
<p>Returns an iterable of the elements of the sequence separated by the item.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">interpose</span> <span class="s">&quot;!&quot;</span> <span class="s">&quot;abcd&quot;</span><span class="o">))</span>
<span class="o">[</span><span class="sc">&#39;a&#39;</span><span class="o">,</span> <span class="sc">&#39;!&#39;</span><span class="o">,</span> <span class="sc">&#39;b&#39;</span><span class="o">,</span> <span class="sc">&#39;!&#39;</span><span class="o">,</span> <span class="sc">&#39;c&#39;</span><span class="o">,</span> <span class="sc">&#39;!&#39;</span><span class="o">,</span> <span class="sc">&#39;d&#39;</span><span class="o">]</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">interpose</span> <span class="o">-</span><span class="mi">1</span> <span class="o">(</span><span class="n">range</span> <span class="mi">5</span><span class="o">)))</span>
<span class="o">[</span><span class="mi">0</span><span class="o">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">,</span> <span class="mi">4</span><span class="o">]</span>
</pre></div>
</div>
</div>
<div class="section" id="iterable">
<span id="iterable-fn"></span><h5>iterable?<a class="headerlink" href="#iterable" title="Permalink to this headline">¶</a></h5>
<p>Usage: <code class="docutils literal"><span class="pre">(iterable?</span> <span class="pre">x)</span></code></p>
<p>Returns <code class="docutils literal"><span class="pre">True</span></code> if <em>x</em> is iterable. Iterable objects return a new iterator
when <code class="docutils literal"><span class="pre">(iter</span> <span class="pre">x)</span></code> is called. Contrast with <a class="reference internal" href="#iterator-fn"><span class="std std-ref">iterator?</span></a>.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">;;</span> <span class="n">works</span> <span class="k">for</span> <span class="n">strings</span>
<span class="o">=&gt;</span> <span class="o">(</span><span class="n">iterable</span><span class="o">?</span> <span class="o">(</span><span class="n">str</span> <span class="s">&quot;abcde&quot;</span><span class="o">))</span>
<span class="n">True</span>

<span class="o">=&gt;</span> <span class="o">;;</span> <span class="n">works</span> <span class="k">for</span> <span class="n">lists</span>
<span class="o">=&gt;</span> <span class="o">(</span><span class="n">iterable</span><span class="o">?</span> <span class="o">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span><span class="o">])</span>
<span class="n">True</span>

<span class="o">=&gt;</span> <span class="o">;;</span> <span class="n">works</span> <span class="k">for</span> <span class="n">tuples</span>
<span class="o">=&gt;</span> <span class="o">(</span><span class="n">iterable</span><span class="o">?</span> <span class="o">(,</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="o">))</span>
<span class="n">True</span>

<span class="o">=&gt;</span> <span class="o">;;</span> <span class="n">works</span> <span class="k">for</span> <span class="n">dicts</span>
<span class="o">=&gt;</span> <span class="o">(</span><span class="n">iterable</span><span class="o">?</span> <span class="o">{:</span><span class="n">a</span> <span class="mi">1</span> <span class="o">:</span><span class="n">b</span> <span class="mi">2</span> <span class="o">:</span><span class="n">c</span> <span class="mi">3</span><span class="o">})</span>
<span class="n">True</span>

<span class="o">=&gt;</span> <span class="o">;;</span> <span class="n">works</span> <span class="k">for</span> <span class="n">iterators</span><span class="o">/</span><span class="n">generators</span>
<span class="o">=&gt;</span> <span class="o">(</span><span class="n">iterable</span><span class="o">?</span> <span class="o">(</span><span class="n">repeat</span> <span class="mi">3</span><span class="o">))</span>
<span class="n">True</span>
</pre></div>
</div>
</div>
<div class="section" id="iterator">
<span id="iterator-fn"></span><h5>iterator?<a class="headerlink" href="#iterator" title="Permalink to this headline">¶</a></h5>
<p>Usage: <code class="docutils literal"><span class="pre">(iterator?</span> <span class="pre">x)</span></code></p>
<p>Returns <code class="docutils literal"><span class="pre">True</span></code> if <em>x</em> is an iterator. Iterators are objects that return
themselves as an iterator when <code class="docutils literal"><span class="pre">(iter</span> <span class="pre">x)</span></code> is called. Contrast with
<a class="reference internal" href="#iterable-fn"><span class="std std-ref">iterable?</span></a>.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span>=&gt; ;; doesn&#39;t work for a list
=&gt; (iterator? [1 2 3 4 5])
False

=&gt; ;; but we can get an iter from the list
=&gt; (iterator? (iter [1 2 3 4 5]))
True

=&gt; ;; doesn&#39;t work for dict
=&gt; (iterator? {:a 1 :b 2 :c 3})
False

=&gt; ;; create an iterator from the dict
=&gt; (iterator? (iter {:a 1 :b 2 :c 3}))
True
</pre></div>
</div>
</div>
<div class="section" id="juxt">
<span id="juxt-fn"></span><h5>juxt<a class="headerlink" href="#juxt" title="Permalink to this headline">¶</a></h5>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.12.0.</span></p>
</div>
<p>Usage: <code class="docutils literal"><span class="pre">(juxt</span> <span class="pre">f</span> <span class="pre">&amp;rest</span> <span class="pre">fs)</span></code></p>
<p>Return a function that applies each of the supplied functions to a
single set of arguments and collects the results into a list.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">((</span><span class="n">juxt</span> <span class="n">min</span> <span class="n">max</span> <span class="n">sum</span><span class="o">)</span> <span class="o">(</span><span class="n">range</span> <span class="mi">1</span> <span class="mi">101</span><span class="o">))</span>
<span class="o">[</span><span class="mi">1</span><span class="o">,</span> <span class="mi">100</span><span class="o">,</span> <span class="mi">5050</span><span class="o">]</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">dict</span> <span class="o">(</span><span class="n">map</span> <span class="o">(</span><span class="n">juxt</span> <span class="n">identity</span> <span class="n">ord</span><span class="o">)</span> <span class="s">&quot;abcdef&quot;</span><span class="o">))</span>
<span class="o">{</span><span class="sc">&#39;f&#39;</span><span class="o">:</span> <span class="mi">102</span><span class="o">,</span> <span class="sc">&#39;d&#39;</span><span class="o">:</span> <span class="mi">100</span><span class="o">,</span> <span class="sc">&#39;b&#39;</span><span class="o">:</span> <span class="mi">98</span><span class="o">,</span> <span class="sc">&#39;e&#39;</span><span class="o">:</span> <span class="mi">101</span><span class="o">,</span> <span class="sc">&#39;c&#39;</span><span class="o">:</span> <span class="mi">99</span><span class="o">,</span> <span class="sc">&#39;a&#39;</span><span class="o">:</span> <span class="mi">97</span><span class="o">}</span>

<span class="o">=&gt;</span> <span class="o">((</span><span class="n">juxt</span> <span class="o">+</span> <span class="o">-</span> <span class="o">*</span> <span class="o">/)</span> <span class="mi">24</span> <span class="mi">3</span><span class="o">)</span>
<span class="o">[</span><span class="mi">27</span><span class="o">,</span> <span class="mi">21</span><span class="o">,</span> <span class="mi">72</span><span class="o">,</span> <span class="mf">8.0</span><span class="o">]</span>
</pre></div>
</div>
</div>
<div class="section" id="keyword">
<span id="keyword-fn"></span><h5>keyword<a class="headerlink" href="#keyword" title="Permalink to this headline">¶</a></h5>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.10.1.</span></p>
</div>
<p>Usage: <code class="docutils literal"><span class="pre">(keyword</span> <span class="pre">&quot;foo&quot;)</span></code></p>
<p>Create a keyword from the given value. Strings, numbers, and even
objects with the <cite>__name__</cite> magic will work.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span>=&gt; (keyword &quot;foo&quot;)
u&#39;\ufdd0:foo&#39;

=&gt; (keyword 1)
u&#39;\ufdd0:1&#39;
</pre></div>
</div>
</div>
<div class="section" id="id5">
<span id="id6"></span><h5>keyword?<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h5>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.10.1.</span></p>
</div>
<p>Usage: <code class="docutils literal"><span class="pre">(keyword?</span> <span class="pre">foo)</span></code></p>
<p>Check whether <em>foo</em> is a <a class="reference internal" href="index.html#hykeyword"><span class="std std-ref">keyword</span></a>.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">keyword</span><span class="o">?</span> <span class="o">:</span><span class="n">foo</span><span class="o">)</span>
<span class="n">True</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">setv</span> <span class="n">foo</span> <span class="mi">1</span><span class="o">)</span>
<span class="o">=&gt;</span> <span class="o">(</span><span class="n">keyword</span><span class="o">?</span> <span class="n">foo</span><span class="o">)</span>
<span class="n">False</span>
</pre></div>
</div>
</div>
<div class="section" id="list">
<span id="list-fn"></span><h5>list*<a class="headerlink" href="#list" title="Permalink to this headline">¶</a></h5>
<p>Usage: <code class="docutils literal"><span class="pre">(list*</span> <span class="pre">head</span> <span class="pre">&amp;rest</span> <span class="pre">tail)</span></code></p>
<p>Generates a chain of nested cons cells (a dotted list) containing the
arguments. If the argument list only has one element, return it.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span><span class="o">*</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span><span class="o">)</span>
<span class="o">(</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="o">.</span> <span class="mi">4</span><span class="o">)</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span><span class="o">*</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="o">[</span><span class="mi">4</span><span class="o">])</span>
<span class="o">[</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">]</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span><span class="o">*</span> <span class="mi">1</span><span class="o">)</span>
<span class="mi">1</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">cons</span><span class="o">?</span> <span class="o">(</span><span class="n">list</span><span class="o">*</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span><span class="o">))</span>
<span class="n">True</span>
</pre></div>
</div>
</div>
<div class="section" id="macroexpand">
<span id="macroexpand-fn"></span><h5>macroexpand<a class="headerlink" href="#macroexpand" title="Permalink to this headline">¶</a></h5>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.10.0.</span></p>
</div>
<p>Usage: <code class="docutils literal"><span class="pre">(macroexpand</span> <span class="pre">form)</span></code></p>
<p>Returns the full macro expansion of <em>form</em>.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span>=&gt; (macroexpand &#39;(-&gt; (a b) (x y)))
(u&#39;x&#39; (u&#39;a&#39; u&#39;b&#39;) u&#39;y&#39;)

=&gt; (macroexpand &#39;(-&gt; (a b) (-&gt; (c d) (e f))))
(u&#39;e&#39; (u&#39;c&#39; (u&#39;a&#39; u&#39;b&#39;) u&#39;d&#39;) u&#39;f&#39;)
</pre></div>
</div>
</div>
<div class="section" id="macroexpand-1">
<span id="macroexpand-1-fn"></span><h5>macroexpand-1<a class="headerlink" href="#macroexpand-1" title="Permalink to this headline">¶</a></h5>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.10.0.</span></p>
</div>
<p>Usage: <code class="docutils literal"><span class="pre">(macroexpand-1</span> <span class="pre">form)</span></code></p>
<p>Returns the single step macro expansion of <em>form</em>.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span>=&gt; (macroexpand-1 &#39;(-&gt; (a b) (-&gt; (c d) (e f))))
(u&#39;_&gt;&#39; (u&#39;a&#39; u&#39;b&#39;) (u&#39;c&#39; u&#39;d&#39;) (u&#39;e&#39; u&#39;f&#39;))
</pre></div>
</div>
</div>
<div class="section" id="merge-with">
<span id="merge-with-fn"></span><h5>merge-with<a class="headerlink" href="#merge-with" title="Permalink to this headline">¶</a></h5>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.10.1.</span></p>
</div>
<p>Usage: <code class="docutils literal"><span class="pre">(merge-with</span> <span class="pre">f</span> <span class="pre">&amp;rest</span> <span class="pre">maps)</span></code></p>
<p>Returns a map that consist of the rest of the maps joined onto first.
If a key occurs in more than one map, the mapping(s) from the latter
(left-to-right) will be combined with the mapping in the result by
calling <code class="docutils literal"><span class="pre">(f</span> <span class="pre">val-in-result</span> <span class="pre">val-in-latter)</span></code>.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">merge</span><span class="o">-</span><span class="n">with</span> <span class="o">(</span><span class="n">fn</span> <span class="o">[</span><span class="n">x</span> <span class="n">y</span><span class="o">]</span> <span class="o">(+</span> <span class="n">x</span> <span class="n">y</span><span class="o">))</span> <span class="o">{</span><span class="s">&quot;a&quot;</span> <span class="mi">10</span> <span class="s">&quot;b&quot;</span> <span class="mi">20</span><span class="o">}</span> <span class="o">{</span><span class="s">&quot;a&quot;</span> <span class="mi">1</span> <span class="s">&quot;c&quot;</span> <span class="mi">30</span><span class="o">})</span>
<span class="o">{</span><span class="n">u</span><span class="sc">&#39;a&#39;</span><span class="o">:</span> <span class="mi">11L</span><span class="o">,</span> <span class="n">u</span><span class="sc">&#39;c&#39;</span><span class="o">:</span> <span class="mi">30L</span><span class="o">,</span> <span class="n">u</span><span class="sc">&#39;b&#39;</span><span class="o">:</span> <span class="mi">20L</span><span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="name">
<span id="name-fn"></span><h5>name<a class="headerlink" href="#name" title="Permalink to this headline">¶</a></h5>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.10.1.</span></p>
</div>
<p>Usage: <code class="docutils literal"><span class="pre">(name</span> <span class="pre">:keyword)</span></code></p>
<p>Convert the given value to a string. Keyword special character will be
stripped. Strings will be used as is. Even objects with the <cite>__name__</cite>
magic will work.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span>=&gt; (name :foo)
u&#39;foo&#39;
</pre></div>
</div>
</div>
<div class="section" id="neg">
<span id="neg-fn"></span><h5>neg?<a class="headerlink" href="#neg" title="Permalink to this headline">¶</a></h5>
<p>Usage: <code class="docutils literal"><span class="pre">(neg?</span> <span class="pre">x)</span></code></p>
<p>Returns <code class="docutils literal"><span class="pre">True</span></code> if <em>x</em> is less than zero. Raises <code class="docutils literal"><span class="pre">TypeError</span></code> if
<code class="docutils literal"><span class="pre">(not</span> <span class="pre">(numeric?</span> <span class="pre">x))</span></code>.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">neg</span><span class="o">?</span> <span class="o">-</span><span class="mi">2</span><span class="o">)</span>
<span class="n">True</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">neg</span><span class="o">?</span> <span class="mi">3</span><span class="o">)</span>
<span class="n">False</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">neg</span><span class="o">?</span> <span class="mi">0</span><span class="o">)</span>
<span class="n">False</span>
</pre></div>
</div>
</div>
<div class="section" id="none">
<span id="none-fn"></span><h5>none?<a class="headerlink" href="#none" title="Permalink to this headline">¶</a></h5>
<p>Usage: <code class="docutils literal"><span class="pre">(none?</span> <span class="pre">x)</span></code></p>
<p>Returns <code class="docutils literal"><span class="pre">True</span></code> if <em>x</em> is <code class="docutils literal"><span class="pre">None</span></code>.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">none</span><span class="o">?</span> <span class="n">None</span><span class="o">)</span>
<span class="n">True</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">none</span><span class="o">?</span> <span class="mi">0</span><span class="o">)</span>
<span class="n">False</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">setv</span> <span class="n">x</span> <span class="n">None</span><span class="o">)</span>
<span class="o">=&gt;</span> <span class="o">(</span><span class="n">none</span><span class="o">?</span> <span class="n">x</span><span class="o">)</span>
<span class="n">True</span>

<span class="o">=&gt;</span> <span class="o">;;</span> <span class="n">list</span><span class="o">.</span><span class="na">append</span> <span class="n">always</span> <span class="n">returns</span> <span class="n">None</span>
<span class="o">=&gt;</span> <span class="o">(</span><span class="n">none</span><span class="o">?</span> <span class="o">(.</span><span class="n">append</span> <span class="o">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="o">]</span> <span class="mi">4</span><span class="o">))</span>
<span class="n">True</span>
</pre></div>
</div>
</div>
<div class="section" id="nth">
<span id="nth-fn"></span><h5>nth<a class="headerlink" href="#nth" title="Permalink to this headline">¶</a></h5>
<p>Usage: <code class="docutils literal"><span class="pre">(nth</span> <span class="pre">coll</span> <span class="pre">n</span> <span class="pre">&amp;optional</span> <span class="pre">[default</span> <span class="pre">None])</span></code></p>
<p>Returns the <em>n</em>-th item in a collection, counting from 0. Return the
default value, <code class="docutils literal"><span class="pre">None</span></code>, if out of bounds (unless specified otherwise).
Raises <code class="docutils literal"><span class="pre">ValueError</span></code> if <em>n</em> is negative.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span>=&gt; (nth [1 2 4 7] 1)
2

=&gt; (nth [1 2 4 7] 3)
7

=&gt; (none? (nth [1 2 4 7] 5))
True

=&gt; (nth [1 2 4 7] 5 &quot;default&quot;)
&#39;default&#39;

=&gt; (nth (take 3 (drop 2 [1 2 3 4 5 6])) 2))
5

=&gt; (nth [1 2 4 7] -1)
Traceback (most recent call last):
  ...
ValueError: Indices for islice() must be None or an integer: 0 &lt;= x &lt;= sys.maxsize.
</pre></div>
</div>
</div>
<div class="section" id="numeric">
<span id="numeric-fn"></span><h5>numeric?<a class="headerlink" href="#numeric" title="Permalink to this headline">¶</a></h5>
<p>Usage: <code class="docutils literal"><span class="pre">(numeric?</span> <span class="pre">x)</span></code></p>
<p>Returns <code class="docutils literal"><span class="pre">True</span></code> if <em>x</em> is a numeric, as defined in Python's
<code class="docutils literal"><span class="pre">numbers.Number</span></code> class.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">numeric</span><span class="o">?</span> <span class="o">-</span><span class="mi">2</span><span class="o">)</span>
<span class="n">True</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">numeric</span><span class="o">?</span> <span class="mf">3.2</span><span class="o">)</span>
<span class="n">True</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">numeric</span><span class="o">?</span> <span class="s">&quot;foo&quot;</span><span class="o">)</span>
<span class="n">False</span>
</pre></div>
</div>
</div>
<div class="section" id="odd">
<span id="odd-fn"></span><h5>odd?<a class="headerlink" href="#odd" title="Permalink to this headline">¶</a></h5>
<p>Usage: <code class="docutils literal"><span class="pre">(odd?</span> <span class="pre">x)</span></code></p>
<p>Returns <code class="docutils literal"><span class="pre">True</span></code> if <em>x</em> is odd. Raises <code class="docutils literal"><span class="pre">TypeError</span></code> if
<code class="docutils literal"><span class="pre">(not</span> <span class="pre">(numeric?</span> <span class="pre">x))</span></code>.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">odd</span><span class="o">?</span> <span class="mi">13</span><span class="o">)</span>
<span class="n">True</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">odd</span><span class="o">?</span> <span class="mi">2</span><span class="o">)</span>
<span class="n">False</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">odd</span><span class="o">?</span> <span class="mi">0</span><span class="o">)</span>
<span class="n">False</span>
</pre></div>
</div>
</div>
<div class="section" id="partition">
<span id="partition-fn"></span><h5>partition<a class="headerlink" href="#partition" title="Permalink to this headline">¶</a></h5>
<p>Usage: <code class="docutils literal"><span class="pre">(partition</span> <span class="pre">coll</span> <span class="pre">[n]</span> <span class="pre">[step]</span> <span class="pre">[fillvalue])</span></code></p>
<p>Chunks <em>coll</em> into <em>n</em>-tuples (pairs by default).</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">partition</span> <span class="o">(</span><span class="n">range</span> <span class="mi">10</span><span class="o">)))</span>  <span class="o">;</span> <span class="n">n</span><span class="o">=</span><span class="mi">2</span>
<span class="o">[(,</span> <span class="mi">0</span> <span class="mi">1</span><span class="o">)</span> <span class="o">(,</span> <span class="mi">2</span> <span class="mi">3</span><span class="o">)</span> <span class="o">(,</span> <span class="mi">4</span> <span class="mi">5</span><span class="o">)</span> <span class="o">(,</span> <span class="mi">6</span> <span class="mi">7</span><span class="o">)</span> <span class="o">(,</span> <span class="mi">8</span> <span class="mi">9</span><span class="o">)]</span>
</pre></div>
</div>
<p>The <em>step</em> defaults to <em>n</em>, but can be more to skip elements, or less for a sliding window with overlap.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">partition</span> <span class="o">(</span><span class="n">range</span> <span class="mi">10</span><span class="o">)</span> <span class="mi">2</span> <span class="mi">3</span><span class="o">))</span>
<span class="o">[(,</span> <span class="mi">0</span> <span class="mi">1</span><span class="o">)</span> <span class="o">(,</span> <span class="mi">3</span> <span class="mi">4</span><span class="o">)</span> <span class="o">(,</span> <span class="mi">6</span> <span class="mi">7</span><span class="o">)]</span>
<span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">partition</span> <span class="o">(</span><span class="n">range</span> <span class="mi">5</span><span class="o">)</span> <span class="mi">2</span> <span class="mi">1</span><span class="o">))</span>
<span class="o">[(,</span> <span class="mi">0</span> <span class="mi">1</span><span class="o">)</span> <span class="o">(,</span> <span class="mi">1</span> <span class="mi">2</span><span class="o">)</span> <span class="o">(,</span> <span class="mi">2</span> <span class="mi">3</span><span class="o">)</span> <span class="o">(,</span> <span class="mi">3</span> <span class="mi">4</span><span class="o">)])</span>
</pre></div>
</div>
<p>The remainder, if any, is not included unless a <em>fillvalue</em> is specified.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">partition</span> <span class="o">(</span><span class="n">range</span> <span class="mi">10</span><span class="o">)</span> <span class="mi">3</span><span class="o">))</span>
<span class="o">[(,</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span><span class="o">)</span> <span class="o">(,</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span><span class="o">)</span> <span class="o">(,</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span><span class="o">)]</span>
<span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">partition</span> <span class="o">(</span><span class="n">range</span> <span class="mi">10</span><span class="o">)</span> <span class="mi">3</span> <span class="o">:</span><span class="n">fillvalue</span> <span class="s">&quot;x&quot;</span><span class="o">))</span>
<span class="o">[(,</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span><span class="o">)</span> <span class="o">(,</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span><span class="o">)</span> <span class="o">(,</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span><span class="o">)</span> <span class="o">(,</span> <span class="mi">9</span> <span class="s">&quot;x&quot;</span> <span class="s">&quot;x&quot;</span><span class="o">)]</span>
</pre></div>
</div>
</div>
<div class="section" id="pos">
<span id="pos-fn"></span><h5>pos?<a class="headerlink" href="#pos" title="Permalink to this headline">¶</a></h5>
<p>Usage: <code class="docutils literal"><span class="pre">(pos?</span> <span class="pre">x)</span></code></p>
<p>Returns <code class="docutils literal"><span class="pre">True</span></code> if <em>x</em> is greater than zero. Raises <code class="docutils literal"><span class="pre">TypeError</span></code>
if <code class="docutils literal"><span class="pre">(not</span> <span class="pre">(numeric?</span> <span class="pre">x))</span></code>.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">pos</span><span class="o">?</span> <span class="mi">3</span><span class="o">)</span>
<span class="n">True</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">pos</span><span class="o">?</span> <span class="o">-</span><span class="mi">2</span><span class="o">)</span>
<span class="n">False</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">pos</span><span class="o">?</span> <span class="mi">0</span><span class="o">)</span>
<span class="n">False</span>
</pre></div>
</div>
</div>
<div class="section" id="second">
<span id="second-fn"></span><h5>second<a class="headerlink" href="#second" title="Permalink to this headline">¶</a></h5>
<p>Usage: <code class="docutils literal"><span class="pre">(second</span> <span class="pre">coll)</span></code></p>
<p>Returns the second member of <em>coll</em>. Equivalent to <code class="docutils literal"><span class="pre">(get</span> <span class="pre">coll</span> <span class="pre">1)</span></code>.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">second</span> <span class="o">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span><span class="o">])</span>
<span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="section" id="some">
<span id="some-fn"></span><h5>some<a class="headerlink" href="#some" title="Permalink to this headline">¶</a></h5>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.10.0.</span></p>
</div>
<p>Usage: <code class="docutils literal"><span class="pre">(some</span> <span class="pre">pred</span> <span class="pre">coll)</span></code></p>
<p>Returns the first logically-true value of <code class="docutils literal"><span class="pre">(pred</span> <span class="pre">x)</span></code> for any <code class="docutils literal"><span class="pre">x</span></code> in
<em>coll</em>, otherwise <code class="docutils literal"><span class="pre">None</span></code>. Return <code class="docutils literal"><span class="pre">None</span></code> if <em>coll</em> is empty.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span>=&gt; (some even? [2 4 6])
True

=&gt; (none? (some even? [1 3 5]))
True

=&gt; (none? (some identity [0 &quot;&quot; []]))
True

=&gt; (some identity [0 &quot;non-empty-string&quot; []])
&#39;non-empty-string&#39;

=&gt; (none? (some even? []))
True
</pre></div>
</div>
</div>
<div class="section" id="string">
<span id="string-fn"></span><h5>string?<a class="headerlink" href="#string" title="Permalink to this headline">¶</a></h5>
<p>Usage: <code class="docutils literal"><span class="pre">(string?</span> <span class="pre">x)</span></code></p>
<p>Returns <code class="docutils literal"><span class="pre">True</span></code> if <em>x</em> is a string.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">string</span><span class="o">?</span> <span class="s">&quot;foo&quot;</span><span class="o">)</span>
<span class="n">True</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">string</span><span class="o">?</span> <span class="o">-</span><span class="mi">2</span><span class="o">)</span>
<span class="n">False</span>
</pre></div>
</div>
</div>
<div class="section" id="symbol">
<span id="symbol-fn"></span><h5>symbol?<a class="headerlink" href="#symbol" title="Permalink to this headline">¶</a></h5>
<p>Usage: <code class="docutils literal"><span class="pre">(symbol?</span> <span class="pre">x)</span></code></p>
<p>Returns <code class="docutils literal"><span class="pre">True</span></code> if <em>x</em> is a symbol.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span>=&gt; (symbol? &#39;foo)
True

=&gt; (symbol? &#39;[a b c])
False
</pre></div>
</div>
</div>
<div class="section" id="zero">
<span id="zero-fn"></span><h5>zero?<a class="headerlink" href="#zero" title="Permalink to this headline">¶</a></h5>
<p>Usage: <code class="docutils literal"><span class="pre">(zero?</span> <span class="pre">x)</span></code></p>
<p>Returns <code class="docutils literal"><span class="pre">True</span></code> if <em>x</em> is zero.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">zero</span><span class="o">?</span> <span class="mi">3</span><span class="o">)</span>
<span class="n">False</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">zero</span><span class="o">?</span> <span class="o">-</span><span class="mi">2</span><span class="o">)</span>
<span class="n">False</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">zero</span><span class="o">?</span> <span class="mi">0</span><span class="o">)</span>
<span class="n">True</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="sequence-functions">
<h4>Sequence Functions<a class="headerlink" href="#sequence-functions" title="Permalink to this headline">¶</a></h4>
<p>Sequence functions can either create or operate on a potentially
infinite sequence without requiring the sequence be fully realized in
a list or similar container. They do this by returning a Python
iterator.</p>
<p>We can use the canonical infinite Fibonacci number generator
as an example of how to use some of these functions.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">(</span><span class="n">defn</span> <span class="n">fib</span> <span class="o">[]</span>
  <span class="o">(</span><span class="n">setv</span> <span class="n">a</span> <span class="mi">0</span><span class="o">)</span>
  <span class="o">(</span><span class="n">setv</span> <span class="n">b</span> <span class="mi">1</span><span class="o">)</span>
  <span class="o">(</span><span class="k">while</span> <span class="n">True</span>
    <span class="o">(</span><span class="n">yield</span> <span class="n">a</span><span class="o">)</span>
    <span class="o">(</span><span class="n">setv</span> <span class="o">(,</span> <span class="n">a</span> <span class="n">b</span><span class="o">)</span> <span class="o">(,</span> <span class="n">b</span> <span class="o">(+</span> <span class="n">a</span> <span class="n">b</span><span class="o">)))))</span>
</pre></div>
</div>
<p>Note the <code class="docutils literal"><span class="pre">(while</span> <span class="pre">True</span> <span class="pre">...)</span></code> loop. If we run this in the REPL,</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">fib</span><span class="o">)</span>
<span class="o">&lt;</span><span class="n">generator</span> <span class="n">object</span> <span class="n">fib</span> <span class="n">at</span> <span class="mh">0x101e642d0</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Calling the function only returns an iterator, but does no
work until we consume it. Trying something like this is not recommend as
the infinite loop will run until it consumes all available RAM, or
in this case until I killed it.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">fib</span><span class="o">))</span>
<span class="o">[</span><span class="mi">1</span><span class="o">]</span>    <span class="mi">91474</span> <span class="n">killed</span>     <span class="n">hy</span>
</pre></div>
</div>
<p>To get the first 10 Fibonacci numbers, use <a class="reference internal" href="#take-fn"><span class="std std-ref">take</span></a>. Note that
<a class="reference internal" href="#take-fn"><span class="std std-ref">take</span></a> also returns a generator, so I create a list from it.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">take</span> <span class="mi">10</span> <span class="o">(</span><span class="n">fib</span><span class="o">)))</span>
<span class="o">[</span><span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">8</span><span class="o">,</span> <span class="mi">13</span><span class="o">,</span> <span class="mi">21</span><span class="o">,</span> <span class="mi">34</span><span class="o">]</span>
</pre></div>
</div>
<p>To get the Fibonacci number at index 9, (starting from 0):</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">nth</span> <span class="o">(</span><span class="n">fib</span><span class="o">)</span> <span class="mi">9</span><span class="o">)</span>
<span class="mi">34</span>
</pre></div>
</div>
<div class="section" id="cycle">
<span id="cycle-fn"></span><h5>cycle<a class="headerlink" href="#cycle" title="Permalink to this headline">¶</a></h5>
<p>Usage: <code class="docutils literal"><span class="pre">(cycle</span> <span class="pre">coll)</span></code></p>
<p>Returns an infinite iterator of the members of coll.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">list </span><span class="p">(</span><span class="nb">take </span><span class="mi">7</span> <span class="p">(</span><span class="nb">cycle </span><span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">])))</span>
<span class="p">[</span><span class="mi">1</span>, <span class="mi">2</span>, <span class="mi">3</span>, <span class="mi">1</span>, <span class="mi">2</span>, <span class="mi">3</span>, <span class="mi">1</span><span class="p">]</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">list </span><span class="p">(</span><span class="nb">take </span><span class="mi">2</span> <span class="p">(</span><span class="nb">cycle </span><span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">])))</span>
<span class="p">[</span><span class="mi">1</span>, <span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="distinct">
<span id="distinct-fn"></span><h5>distinct<a class="headerlink" href="#distinct" title="Permalink to this headline">¶</a></h5>
<p>Usage: <code class="docutils literal"><span class="pre">(distinct</span> <span class="pre">coll)</span></code></p>
<p>Returns an iterator containing only the unique members in <em>coll</em>.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">distinct</span> <span class="o">[</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">3</span> <span class="mi">5</span> <span class="mi">2</span> <span class="o">]))</span>
<span class="o">[</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">]</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">distinct</span> <span class="o">[]))</span>
<span class="o">[]</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">distinct</span> <span class="o">(</span><span class="n">iter</span> <span class="o">[</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">3</span> <span class="mi">5</span> <span class="mi">2</span> <span class="o">])))</span>
<span class="o">[</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">]</span>
</pre></div>
</div>
</div>
<div class="section" id="drop">
<span id="drop-fn"></span><h5>drop<a class="headerlink" href="#drop" title="Permalink to this headline">¶</a></h5>
<p>Usage: <code class="docutils literal"><span class="pre">(drop</span> <span class="pre">n</span> <span class="pre">coll)</span></code></p>
<p>Returns an iterator, skipping the first <em>n</em> members of <em>coll</em>.
Raises <code class="docutils literal"><span class="pre">ValueError</span></code> if <em>n</em> is negative.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">drop</span> <span class="mi">2</span> <span class="o">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span><span class="o">]))</span>
<span class="o">[</span><span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">]</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">drop</span> <span class="mi">4</span> <span class="o">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span><span class="o">]))</span>
<span class="o">[</span><span class="mi">5</span><span class="o">]</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">drop</span> <span class="mi">0</span> <span class="o">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span><span class="o">]))</span>
<span class="o">[</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">]</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">drop</span> <span class="mi">6</span> <span class="o">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span><span class="o">]))</span>
<span class="o">[]</span>
</pre></div>
</div>
</div>
<div class="section" id="drop-last">
<span id="drop-last-fn"></span><h5>drop-last<a class="headerlink" href="#drop-last" title="Permalink to this headline">¶</a></h5>
<p>Usage: <code class="docutils literal"><span class="pre">(drop-last</span> <span class="pre">n</span> <span class="pre">coll)</span></code></p>
<p>Returns an iterator of all but the last <em>n</em> items in <em>coll</em>. Raises
<code class="docutils literal"><span class="pre">ValueError</span></code> if <em>n</em> is negative.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">drop</span><span class="o">-</span><span class="n">last</span> <span class="mi">5</span> <span class="o">(</span><span class="n">range</span> <span class="mi">10</span> <span class="mi">20</span><span class="o">)))</span>
<span class="o">[</span><span class="mi">10</span><span class="o">,</span> <span class="mi">11</span><span class="o">,</span> <span class="mi">12</span><span class="o">,</span> <span class="mi">13</span><span class="o">,</span> <span class="mi">14</span><span class="o">]</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">drop</span><span class="o">-</span><span class="n">last</span> <span class="mi">0</span> <span class="o">(</span><span class="n">range</span> <span class="mi">5</span><span class="o">)))</span>
<span class="o">[</span><span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">]</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">drop</span><span class="o">-</span><span class="n">last</span> <span class="mi">100</span> <span class="o">(</span><span class="n">range</span> <span class="mi">100</span><span class="o">)))</span>
<span class="o">[]</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">take</span> <span class="mi">5</span> <span class="o">(</span><span class="n">drop</span><span class="o">-</span><span class="n">last</span> <span class="mi">100</span> <span class="o">(</span><span class="n">count</span> <span class="mi">10</span><span class="o">))))</span>
<span class="o">[</span><span class="mi">10</span><span class="o">,</span> <span class="mi">11</span><span class="o">,</span> <span class="mi">12</span><span class="o">,</span> <span class="mi">13</span><span class="o">,</span> <span class="mi">14</span><span class="o">]</span>
</pre></div>
</div>
</div>
<div class="section" id="drop-while">
<span id="drop-while-fn"></span><h5>drop-while<a class="headerlink" href="#drop-while" title="Permalink to this headline">¶</a></h5>
<p>Usage: <code class="docutils literal"><span class="pre">(drop-while</span> <span class="pre">pred</span> <span class="pre">coll)</span></code></p>
<p>Returns an iterator, skipping members of <em>coll</em> until <em>pred</em> is <code class="docutils literal"><span class="pre">False</span></code>.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">drop</span><span class="o">-</span><span class="k">while</span> <span class="n">even</span><span class="o">?</span> <span class="o">[</span><span class="mi">2</span> <span class="mi">4</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="o">]))</span>
<span class="o">[</span><span class="mi">7</span><span class="o">,</span> <span class="mi">8</span><span class="o">,</span> <span class="mi">9</span><span class="o">]</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">drop</span><span class="o">-</span><span class="k">while</span> <span class="n">numeric</span><span class="o">?</span> <span class="o">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="n">None</span> <span class="s">&quot;a&quot;</span><span class="o">])))</span>
<span class="o">[</span><span class="n">None</span><span class="o">,</span> <span class="n">u</span><span class="sc">&#39;a&#39;</span><span class="o">]</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">drop</span><span class="o">-</span><span class="k">while</span> <span class="n">pos</span><span class="o">?</span> <span class="o">[</span><span class="mi">2</span> <span class="mi">4</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="o">]))</span>
<span class="o">[]</span>
</pre></div>
</div>
</div>
<div class="section" id="filter">
<span id="filter-fn"></span><h5>filter<a class="headerlink" href="#filter" title="Permalink to this headline">¶</a></h5>
<p>Usage: <code class="docutils literal"><span class="pre">(filter</span> <span class="pre">pred</span> <span class="pre">coll)</span></code></p>
<p>Returns an iterator for all items in <em>coll</em> that pass the predicate <em>pred</em>.</p>
<p>See also <a class="reference internal" href="#remove-fn"><span class="std std-ref">remove</span></a>.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">filter</span> <span class="n">pos</span><span class="o">?</span> <span class="o">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="o">-</span><span class="mi">4</span> <span class="mi">5</span> <span class="o">-</span><span class="mi">7</span><span class="o">]))</span>
<span class="o">[</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">5</span><span class="o">]</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">filter</span> <span class="n">even</span><span class="o">?</span> <span class="o">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="o">-</span><span class="mi">4</span> <span class="mi">5</span> <span class="o">-</span><span class="mi">7</span><span class="o">]))</span>
<span class="o">[</span><span class="mi">2</span><span class="o">,</span> <span class="o">-</span><span class="mi">4</span><span class="o">]</span>
</pre></div>
</div>
</div>
<div class="section" id="flatten">
<span id="flatten-fn"></span><h5>flatten<a class="headerlink" href="#flatten" title="Permalink to this headline">¶</a></h5>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.9.12.</span></p>
</div>
<p>Usage: <code class="docutils literal"><span class="pre">(flatten</span> <span class="pre">coll)</span></code></p>
<p>Returns a single list of all the items in <em>coll</em>, by flattening all
contained lists and/or tuples.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span>=&gt; (flatten [1 2 [3 4] 5])
[1, 2, 3, 4, 5]

=&gt; (flatten [&quot;foo&quot; (, 1 2) [1 [2 3] 4] &quot;bar&quot;])
[&#39;foo&#39;, 1, 2, 1, 2, 3, 4, &#39;bar&#39;]
</pre></div>
</div>
</div>
<div class="section" id="iterate">
<span id="iterate-fn"></span><h5>iterate<a class="headerlink" href="#iterate" title="Permalink to this headline">¶</a></h5>
<p>Usage: <code class="docutils literal"><span class="pre">(iterate</span> <span class="pre">fn</span> <span class="pre">x)</span></code></p>
<p>Returns an iterator of <em>x</em>, <em>fn(x)</em>, <em>fn(fn(x))</em>, etc.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">take</span> <span class="mi">5</span> <span class="o">(</span><span class="n">iterate</span> <span class="n">inc</span> <span class="mi">5</span><span class="o">)))</span>
<span class="o">[</span><span class="mi">5</span><span class="o">,</span> <span class="mi">6</span><span class="o">,</span> <span class="mi">7</span><span class="o">,</span> <span class="mi">8</span><span class="o">,</span> <span class="mi">9</span><span class="o">]</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">take</span> <span class="mi">5</span> <span class="o">(</span><span class="n">iterate</span> <span class="o">(</span><span class="n">fn</span> <span class="o">[</span><span class="n">x</span><span class="o">]</span> <span class="o">(*</span> <span class="n">x</span> <span class="n">x</span><span class="o">))</span> <span class="mi">5</span><span class="o">)))</span>
<span class="o">[</span><span class="mi">5</span><span class="o">,</span> <span class="mi">25</span><span class="o">,</span> <span class="mi">625</span><span class="o">,</span> <span class="mi">390625</span><span class="o">,</span> <span class="mi">152587890625</span><span class="o">]</span>
</pre></div>
</div>
</div>
<div class="section" id="read">
<span id="read-fn"></span><h5>read<a class="headerlink" href="#read" title="Permalink to this headline">¶</a></h5>
<p>Usage: <code class="docutils literal"><span class="pre">(read</span> <span class="pre">&amp;optional</span> <span class="pre">[from-file</span> <span class="pre">eof])</span></code></p>
<p>Reads the next Hy expression from <em>from-file</em> (defaulting to <code class="docutils literal"><span class="pre">sys.stdin</span></code>), and
can take a single byte as EOF (defaults to an empty string). Raises <code class="docutils literal"><span class="pre">EOFError</span></code>
if <em>from-file</em> ends before a complete expression can be parsed.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span>=&gt; (read)
(+ 2 2)
(&#39;+&#39; 2 2)
=&gt; (eval (read))
(+ 2 2)
4

=&gt; (import io)
=&gt; (def buffer (io.StringIO &quot;(+ 2 2)\n(- 2 1)&quot;))
=&gt; (eval (apply read [] {&quot;from_file&quot; buffer}))
4
=&gt; (eval (apply read [] {&quot;from_file&quot; buffer}))
1

=&gt; ; assuming &quot;example.hy&quot; contains:
=&gt; ;   (print &quot;hello&quot;)
=&gt; ;   (print &quot;hyfriends!&quot;)
=&gt; (with [f (open &quot;example.hy&quot;)]
...   (try
...     (while True
...            (setv exp (read f))
...            (print &quot;OHY&quot; exp)
...            (eval exp))
...     (except [e EOFError]
...            (print &quot;EOF!&quot;))))
OHY (&#39;print&#39; &#39;hello&#39;)
hello
OHY (&#39;print&#39; &#39;hyfriends!&#39;)
hyfriends!
EOF!
</pre></div>
</div>
</div>
<div class="section" id="read-str">
<h5>read-str<a class="headerlink" href="#read-str" title="Permalink to this headline">¶</a></h5>
<p>Usage: <code class="docutils literal"><span class="pre">(read-str</span> <span class="pre">&quot;string&quot;)</span></code></p>
<p>This is essentially a wrapper around <cite>read</cite> which reads expressions from a
string:</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span>=&gt; (read-str &quot;(print 1)&quot;)
(u&#39;print&#39; 1L)
=&gt; (eval (read-str &quot;(print 1)&quot;))
1
=&gt;
</pre></div>
</div>
</div>
<div class="section" id="remove">
<span id="remove-fn"></span><h5>remove<a class="headerlink" href="#remove" title="Permalink to this headline">¶</a></h5>
<p>Usage: <code class="docutils literal"><span class="pre">(remove</span> <span class="pre">pred</span> <span class="pre">coll)</span></code></p>
<p>Returns an iterator from <em>coll</em> with elements that pass the
predicate, <em>pred</em>, removed.</p>
<p>See also <a class="reference internal" href="#filter-fn"><span class="std std-ref">filter</span></a>.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="nb">remove</span> <span class="n">odd</span><span class="o">?</span> <span class="o">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span><span class="o">]))</span>
<span class="o">[</span><span class="mi">2</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">6</span><span class="o">]</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="nb">remove</span> <span class="n">pos</span><span class="o">?</span> <span class="o">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span><span class="o">]))</span>
<span class="o">[]</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="nb">remove</span> <span class="n">neg</span><span class="o">?</span> <span class="o">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span><span class="o">]))</span>
<span class="o">[</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">6</span><span class="o">,</span> <span class="mi">7</span><span class="o">]</span>
</pre></div>
</div>
</div>
<div class="section" id="repeat">
<span id="repeat-fn"></span><h5>repeat<a class="headerlink" href="#repeat" title="Permalink to this headline">¶</a></h5>
<p>Usage: <code class="docutils literal"><span class="pre">(repeat</span> <span class="pre">x)</span></code></p>
<p>Returns an iterator (infinite) of <code class="docutils literal"><span class="pre">x</span></code>.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">take</span> <span class="mi">6</span> <span class="o">(</span><span class="n">repeat</span> <span class="s">&quot;s&quot;</span><span class="o">)))</span>
<span class="o">[</span><span class="n">u</span><span class="sc">&#39;s&#39;</span><span class="o">,</span> <span class="n">u</span><span class="sc">&#39;s&#39;</span><span class="o">,</span> <span class="n">u</span><span class="sc">&#39;s&#39;</span><span class="o">,</span> <span class="n">u</span><span class="sc">&#39;s&#39;</span><span class="o">,</span> <span class="n">u</span><span class="sc">&#39;s&#39;</span><span class="o">,</span> <span class="n">u</span><span class="sc">&#39;s&#39;</span><span class="o">]</span>
</pre></div>
</div>
</div>
<div class="section" id="repeatedly">
<span id="repeatedly-fn"></span><h5>repeatedly<a class="headerlink" href="#repeatedly" title="Permalink to this headline">¶</a></h5>
<p>Usage: <code class="docutils literal"><span class="pre">(repeatedly</span> <span class="pre">fn)</span></code></p>
<p>Returns an iterator by calling <em>fn</em> repeatedly.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span>=&gt; (import [random [randint]])

=&gt; (list (take 5 (repeatedly (fn [] (randint 0 10)))))
[6, 2, 0, 6, 7]
</pre></div>
</div>
</div>
<div class="section" id="take">
<span id="take-fn"></span><h5>take<a class="headerlink" href="#take" title="Permalink to this headline">¶</a></h5>
<p>Usage: <code class="docutils literal"><span class="pre">(take</span> <span class="pre">n</span> <span class="pre">coll)</span></code></p>
<p>Returns an iterator containing the first <em>n</em> members of <em>coll</em>.
Raises <code class="docutils literal"><span class="pre">ValueError</span></code> if <em>n</em> is negative.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">take</span> <span class="mi">3</span> <span class="o">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span><span class="o">]))</span>
<span class="o">[</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">]</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">take</span> <span class="mi">4</span> <span class="o">(</span><span class="n">repeat</span> <span class="s">&quot;s&quot;</span><span class="o">)))</span>
<span class="o">[</span><span class="n">u</span><span class="sc">&#39;s&#39;</span><span class="o">,</span> <span class="n">u</span><span class="sc">&#39;s&#39;</span><span class="o">,</span> <span class="n">u</span><span class="sc">&#39;s&#39;</span><span class="o">,</span> <span class="n">u</span><span class="sc">&#39;s&#39;</span><span class="o">]</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">take</span> <span class="mi">0</span> <span class="o">(</span><span class="n">repeat</span> <span class="s">&quot;s&quot;</span><span class="o">)))</span>
<span class="o">[]</span>
</pre></div>
</div>
</div>
<div class="section" id="take-nth">
<span id="take-nth-fn"></span><h5>take-nth<a class="headerlink" href="#take-nth" title="Permalink to this headline">¶</a></h5>
<p>Usage: <code class="docutils literal"><span class="pre">(take-nth</span> <span class="pre">n</span> <span class="pre">coll)</span></code></p>
<p>Returns an iterator containing every <em>n</em>-th member of <em>coll</em>.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">take</span><span class="o">-</span><span class="n">nth</span> <span class="mi">2</span> <span class="o">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span><span class="o">]))</span>
<span class="o">[</span><span class="mi">1</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">7</span><span class="o">]</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">take</span><span class="o">-</span><span class="n">nth</span> <span class="mi">3</span> <span class="o">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span><span class="o">]))</span>
<span class="o">[</span><span class="mi">1</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">7</span><span class="o">]</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">take</span><span class="o">-</span><span class="n">nth</span> <span class="mi">4</span> <span class="o">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span><span class="o">]))</span>
<span class="o">[</span><span class="mi">1</span><span class="o">,</span> <span class="mi">5</span><span class="o">]</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">take</span><span class="o">-</span><span class="n">nth</span> <span class="mi">10</span> <span class="o">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span><span class="o">]))</span>
<span class="o">[</span><span class="mi">1</span><span class="o">]</span>
</pre></div>
</div>
</div>
<div class="section" id="take-while">
<span id="take-while-fn"></span><h5>take-while<a class="headerlink" href="#take-while" title="Permalink to this headline">¶</a></h5>
<p>Usage: <code class="docutils literal"><span class="pre">(take-while</span> <span class="pre">pred</span> <span class="pre">coll)</span></code></p>
<p>Returns an iterator from <em>coll</em> as long as <em>pred</em> returns <code class="docutils literal"><span class="pre">True</span></code>.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">take</span><span class="o">-</span><span class="k">while</span> <span class="n">pos</span><span class="o">?</span> <span class="o">[</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="o">-</span><span class="mi">4</span> <span class="mi">5</span><span class="o">]))</span>
<span class="o">[</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">]</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">take</span><span class="o">-</span><span class="k">while</span> <span class="n">neg</span><span class="o">?</span> <span class="o">[</span> <span class="o">-</span><span class="mi">4</span> <span class="o">-</span><span class="mi">3</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">5</span><span class="o">]))</span>
<span class="o">[-</span><span class="mi">4</span><span class="o">,</span> <span class="o">-</span><span class="mi">3</span><span class="o">]</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">take</span><span class="o">-</span><span class="k">while</span> <span class="n">neg</span><span class="o">?</span> <span class="o">[</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="o">-</span><span class="mi">4</span> <span class="mi">5</span><span class="o">]))</span>
<span class="o">[]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="included-itertools">
<h4>Included itertools<a class="headerlink" href="#included-itertools" title="Permalink to this headline">¶</a></h4>
<div class="section" id="count-cycle-repeat-accumulate-chain-compress-drop-while-remove-group-by-islice-map-take-while-tee-zip-longest-product-permutations-combinations-multicombinations">
<h5>count cycle repeat accumulate chain compress drop-while remove group-by islice <a href="#id7"><span class="problematic" id="id8">*</span></a>map take-while tee zip-longest product permutations combinations multicombinations<a class="headerlink" href="#count-cycle-repeat-accumulate-chain-compress-drop-while-remove-group-by-islice-map-take-while-tee-zip-longest-product-permutations-combinations-multicombinations" title="Permalink to this headline">¶</a></h5>
<p>All of Python's <a class="reference external" href="https://docs.python.org/3/library/itertools.html">itertools</a>
are available. Some of their names have been changed:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">starmap</span></code> has been changed to <code class="docutils literal"><span class="pre">*map</span></code></li>
<li><code class="docutils literal"><span class="pre">combinations_with_replacement</span></code> has been changed to <code class="docutils literal"><span class="pre">multicombinations</span></code></li>
<li><code class="docutils literal"><span class="pre">groupby</span></code> has been changed to <code class="docutils literal"><span class="pre">group-by</span></code></li>
<li><code class="docutils literal"><span class="pre">takewhile</span></code> has been changed to <code class="docutils literal"><span class="pre">take-while</span></code></li>
<li><code class="docutils literal"><span class="pre">dropwhile</span></code> has been changed to <code class="docutils literal"><span class="pre">drop-while</span></code></li>
<li><code class="docutils literal"><span class="pre">filterfalse</span></code> has been changed to <code class="docutils literal"><span class="pre">remove</span></code></li>
</ul>
</div></blockquote>
</div>
</div>
</div>
<span id="document-language/internals"></span><div class="section" id="internal-hy-documentation">
<h3>Internal Hy Documentation<a class="headerlink" href="#internal-hy-documentation" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">These bits are mostly useful for folks who hack on Hy itself,
but can also be used for those delving deeper in macro programming.</p>
</div>
<div class="section" id="hy-models">
<span id="models"></span><h4>Hy Models<a class="headerlink" href="#hy-models" title="Permalink to this headline">¶</a></h4>
<div class="section" id="introduction-to-hy-models">
<h5>Introduction to Hy Models<a class="headerlink" href="#introduction-to-hy-models" title="Permalink to this headline">¶</a></h5>
<p>Hy models are a very thin layer on top of regular Python objects,
representing Hy source code as data. Models only add source position
information, and a handful of methods to support clean manipulation of
Hy source code, for instance in macros. To achieve that goal, Hy models
are mixins of a base Python class and <a class="reference internal" href="#hyobject"><span class="std std-ref">HyObject</span></a>.</p>
<div class="section" id="hyobject">
<span id="id1"></span><h6>HyObject<a class="headerlink" href="#hyobject" title="Permalink to this headline">¶</a></h6>
<p><code class="docutils literal"><span class="pre">hy.models.HyObject</span></code> is the base class of Hy models. It only
implements one method, <code class="docutils literal"><span class="pre">replace</span></code>, which replaces the source position
of the current object with the one passed as argument. This allows us to
keep track of the original position of expressions that get modified by
macros, be that in the compiler or in pure hy macros.</p>
<p><code class="docutils literal"><span class="pre">HyObject</span></code> is not intended to be used directly to instantiate Hy
models, but only as a mixin for other classes.</p>
</div>
</div>
<div class="section" id="compound-models">
<h5>Compound Models<a class="headerlink" href="#compound-models" title="Permalink to this headline">¶</a></h5>
<p>Parenthesized and bracketed lists are parsed as compound models by the
Hy parser.</p>
<div class="section" id="hylist">
<span id="id2"></span><h6>HyList<a class="headerlink" href="#hylist" title="Permalink to this headline">¶</a></h6>
<p><code class="docutils literal"><span class="pre">hy.models.HyList</span></code> is the base class of &quot;iterable&quot; Hy models. Its
basic use is to represent bracketed <code class="docutils literal"><span class="pre">[]</span></code> lists, which, when used as a
top-level expression, translate to Python list literals in the
compilation phase.</p>
<p>Adding a HyList to another iterable object reuses the class of the
left-hand-side object, a useful behavior when you want to concatenate Hy
objects in a macro, for instance.</p>
</div>
<div class="section" id="hyexpression">
<span id="id3"></span><h6>HyExpression<a class="headerlink" href="#hyexpression" title="Permalink to this headline">¶</a></h6>
<p><code class="docutils literal"><span class="pre">hy.models.HyExpression</span></code> inherits <a class="reference internal" href="#hylist"><span class="std std-ref">HyList</span></a> for
parenthesized <code class="docutils literal"><span class="pre">()</span></code> expressions. The compilation result of those
expressions depends on the first element of the list: the compiler
dispatches expressions between compiler special-forms, user-defined
macros, and regular Python function calls.</p>
</div>
<div class="section" id="hydict">
<span id="id4"></span><h6>HyDict<a class="headerlink" href="#hydict" title="Permalink to this headline">¶</a></h6>
<p><code class="docutils literal"><span class="pre">hy.models.HyDict</span></code> inherits <a class="reference internal" href="#hylist"><span class="std std-ref">HyList</span></a> for curly-bracketed <code class="docutils literal"><span class="pre">{}</span></code>
expressions, which compile down to a Python dictionary literal.</p>
<p>The decision of using a list instead of a dict as the base class for
<code class="docutils literal"><span class="pre">HyDict</span></code> allows easier manipulation of dicts in macros, with the added
benefit of allowing compound expressions as dict keys (as, for instance,
the <a class="reference internal" href="#hyexpression"><span class="std std-ref">HyExpression</span></a> Python class isn't hashable).</p>
</div>
</div>
<div class="section" id="atomic-models">
<h5>Atomic Models<a class="headerlink" href="#atomic-models" title="Permalink to this headline">¶</a></h5>
<p>In the input stream, double-quoted strings, respecting the Python
notation for strings, are parsed as a single token, which is directly
parsed as a <a class="reference internal" href="#hystring"><span class="std std-ref">HyString</span></a>.</p>
<p>An uninterrupted string of characters, excluding spaces, brackets,
quotes, double-quotes and comments, is parsed as an identifier.</p>
<p>Identifiers are resolved to atomic models during the parsing phase in
the following order:</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="#hy-numeric-models"><span class="std std-ref">HyInteger</span></a></li>
<li><a class="reference internal" href="#hy-numeric-models"><span class="std std-ref">HyFloat</span></a></li>
<li><a class="reference internal" href="#hy-numeric-models"><span class="std std-ref">HyComplex</span></a> (if the atom isn't a bare <code class="docutils literal"><span class="pre">j</span></code>)</li>
<li><a class="reference internal" href="#hykeyword"><span class="std std-ref">HyKeyword</span></a> (if the atom starts with <code class="docutils literal"><span class="pre">:</span></code>)</li>
<li><a class="reference internal" href="#hysymbol"><span class="std std-ref">HySymbol</span></a></li>
</ul>
</div></blockquote>
<div class="section" id="hystring">
<span id="id5"></span><h6>HyString<a class="headerlink" href="#hystring" title="Permalink to this headline">¶</a></h6>
<p><code class="docutils literal"><span class="pre">hy.models.HyString</span></code> is the base class of string-equivalent Hy
models. It also represents double-quoted string literals, <code class="docutils literal"><span class="pre">&quot;&quot;</span></code>, which
compile down to unicode string literals in Python. <code class="docutils literal"><span class="pre">HyStrings</span></code> inherit
unicode objects in Python 2, and string objects in Python 3 (and are
therefore not encoding-dependent).</p>
<p><code class="docutils literal"><span class="pre">HyString</span></code> based models are immutable.</p>
<p>Hy literal strings can span multiple lines, and are considered by the
parser as a single unit, respecting the Python escapes for unicode
strings.</p>
</div>
<div class="section" id="hybytes">
<h6>HyBytes<a class="headerlink" href="#hybytes" title="Permalink to this headline">¶</a></h6>
<p><code class="docutils literal"><span class="pre">hy.models.HyBytes</span></code> is like <code class="docutils literal"><span class="pre">HyString</span></code>, but for sequences of bytes.
It inherits from <code class="docutils literal"><span class="pre">bytes</span></code> on Python 3 and <code class="docutils literal"><span class="pre">str</span></code> on Python 2.</p>
</div>
<div class="section" id="numeric-models">
<span id="hy-numeric-models"></span><h6>Numeric Models<a class="headerlink" href="#numeric-models" title="Permalink to this headline">¶</a></h6>
<p><code class="docutils literal"><span class="pre">hy.models.HyInteger</span></code> represents integer literals (using the
<code class="docutils literal"><span class="pre">long</span></code> type on Python 2, and <code class="docutils literal"><span class="pre">int</span></code> on Python 3).</p>
<p><code class="docutils literal"><span class="pre">hy.models.HyFloat</span></code> represents floating-point literals.</p>
<p><code class="docutils literal"><span class="pre">hy.models.HyComplex</span></code> represents complex literals.</p>
<p>Numeric models are parsed using the corresponding Python routine, and
valid numeric python literals will be turned into their Hy counterpart.</p>
</div>
<div class="section" id="hysymbol">
<span id="id6"></span><h6>HySymbol<a class="headerlink" href="#hysymbol" title="Permalink to this headline">¶</a></h6>
<p><code class="docutils literal"><span class="pre">hy.models.HySymbol</span></code> is the model used to represent symbols
in the Hy language. It inherits <a class="reference internal" href="#hystring"><span class="std std-ref">HyString</span></a>.</p>
<p><code class="docutils literal"><span class="pre">HySymbol</span></code> objects are mangled in the parsing phase, to help Python
interoperability:</p>
<blockquote>
<div><ul class="simple">
<li>Symbols surrounded by asterisks (<code class="docutils literal"><span class="pre">*</span></code>) are turned into uppercase;</li>
<li>Dashes (<code class="docutils literal"><span class="pre">-</span></code>) are turned into underscores (<code class="docutils literal"><span class="pre">_</span></code>);</li>
<li>One trailing question mark (<code class="docutils literal"><span class="pre">?</span></code>) is turned into a leading <code class="docutils literal"><span class="pre">is_</span></code>.</li>
</ul>
</div></blockquote>
<p>Caveat: as the mangling is done during the parsing phase, it is possible
to programmatically generate HySymbols that can't be generated with Hy
source code. Such a mechanism is used by <a class="reference internal" href="index.html#gensym"><span class="std std-ref">gensym</span></a> to generate
&quot;uninterned&quot; symbols.</p>
</div>
<div class="section" id="hykeyword">
<span id="id7"></span><h6>HyKeyword<a class="headerlink" href="#hykeyword" title="Permalink to this headline">¶</a></h6>
<p><code class="docutils literal"><span class="pre">hy.models.HyKeyword</span></code> represents keywords in Hy. Keywords are
symbols starting with a <code class="docutils literal"><span class="pre">:</span></code>. See <a class="reference internal" href="index.html#syntax-keywords"><span class="std std-ref">keywords</span></a>.</p>
</div>
</div>
</div>
<div class="section" id="cons-cells">
<span id="hycons"></span><h4>Cons Cells<a class="headerlink" href="#cons-cells" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal"><span class="pre">hy.models.HyCons</span></code> is a representation of Python-friendly <a class="reference external" href="https://en.wikipedia.org/wiki/Cons">cons
cells</a>.  Cons cells are especially useful to mimic features of &quot;usual&quot;
LISP variants such as Scheme or Common Lisp.</p>
<p>A cons cell is a 2-item object, containing a <code class="docutils literal"><span class="pre">car</span></code> (head) and a
<code class="docutils literal"><span class="pre">cdr</span></code> (tail). In some Lisp variants, the cons cell is the fundamental
building block, and S-expressions are actually represented as linked
lists of cons cells. This is not the case in Hy, as the usual
expressions are made of Python lists wrapped in a
<code class="docutils literal"><span class="pre">HyExpression</span></code>. However, the <code class="docutils literal"><span class="pre">HyCons</span></code> mimics the behavior of
&quot;usual&quot; Lisp variants thusly:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">(cons</span> <span class="pre">something</span> <span class="pre">None)</span></code> is <code class="docutils literal"><span class="pre">(HyExpression</span> <span class="pre">[something])</span></code></li>
<li><code class="docutils literal"><span class="pre">(cons</span> <span class="pre">something</span> <span class="pre">some-list)</span></code> is <code class="docutils literal"><span class="pre">((type</span> <span class="pre">some-list)</span> <span class="pre">(+</span> <span class="pre">[something]</span>
<span class="pre">some-list))</span></code> (if <code class="docutils literal"><span class="pre">some-list</span></code> inherits from <code class="docutils literal"><span class="pre">list</span></code>).</li>
<li><code class="docutils literal"><span class="pre">(get</span> <span class="pre">(cons</span> <span class="pre">a</span> <span class="pre">b)</span> <span class="pre">0)</span></code> is <code class="docutils literal"><span class="pre">a</span></code></li>
<li><code class="docutils literal"><span class="pre">(cut</span> <span class="pre">(cons</span> <span class="pre">a</span> <span class="pre">b)</span> <span class="pre">1)</span></code> is <code class="docutils literal"><span class="pre">b</span></code></li>
</ul>
</div></blockquote>
<p>Hy supports a dotted-list syntax, where <code class="docutils literal"><span class="pre">'(a</span> <span class="pre">.</span> <span class="pre">b)</span></code> means <code class="docutils literal"><span class="pre">(cons</span> <span class="pre">'a</span>
<span class="pre">'b)</span></code> and <code class="docutils literal"><span class="pre">'(a</span> <span class="pre">b</span> <span class="pre">.</span> <span class="pre">c)</span></code> means <code class="docutils literal"><span class="pre">(cons</span> <span class="pre">'a</span> <span class="pre">(cons</span> <span class="pre">'b</span> <span class="pre">'c))</span></code>. If the
compiler encounters a cons cell at the top level, it raises a
compilation error.</p>
<p><code class="docutils literal"><span class="pre">HyCons</span></code> wraps the passed arguments (car and cdr) in Hy types, to ease
the manipulation of cons cells in a macro context.</p>
</div>
<div class="section" id="hy-internal-theory">
<h4>Hy Internal Theory<a class="headerlink" href="#hy-internal-theory" title="Permalink to this headline">¶</a></h4>
<div class="section" id="overview">
<span id="id9"></span><h5>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h5>
<p>The Hy internals work by acting as a front-end to Python bytecode, so
that Hy itself compiles down to Python Bytecode, allowing an unmodified
Python runtime to run Hy code, without even noticing it.</p>
<p>The way we do this is by translating Hy into an internal Python AST
datastructure, and building that AST down into Python bytecode using
modules from the Python standard library, so that we don't have to
duplicate all the work of the Python internals for every single Python
release.</p>
<p>Hy works in four stages. The following sections will cover each step of Hy
from source to runtime.</p>
</div>
<div class="section" id="steps-1-and-2-tokenizing-and-parsing">
<span id="lexing"></span><h5>Steps 1 and 2: Tokenizing and Parsing<a class="headerlink" href="#steps-1-and-2-tokenizing-and-parsing" title="Permalink to this headline">¶</a></h5>
<p>The first stage of compiling Hy is to lex the source into tokens that we can
deal with. We use a project called rply, which is a really nice (and fast)
parser, written in a subset of Python called rpython.</p>
<p>The lexing code is all defined in <code class="docutils literal"><span class="pre">hy.lex.lexer</span></code>. This code is mostly just
defining the Hy grammar, and all the actual hard parts are taken care of by
rply -- we just define &quot;callbacks&quot; for rply in <code class="docutils literal"><span class="pre">hy.lex.parser</span></code>, which takes
the tokens generated, and returns the Hy models.</p>
<p>You can think of the Hy models as the &quot;AST&quot; for Hy, it's what Macros operate
on (directly), and it's what the compiler uses when it compiles Hy down.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">Section <a class="reference internal" href="#models"><span class="std std-ref">Hy Models</span></a> for more information on Hy models and what they mean.</p>
</div>
</div>
<div class="section" id="step-3-hy-compilation-to-python-ast">
<span id="compiling"></span><h5>Step 3: Hy Compilation to Python AST<a class="headerlink" href="#step-3-hy-compilation-to-python-ast" title="Permalink to this headline">¶</a></h5>
<p>This is where most of the magic in Hy happens. This is where we take Hy AST
(the models), and compile them into Python AST. A couple of funky things happen
here to work past a few problems in AST, and working in the compiler is some
of the most important work we do have.</p>
<p>The compiler is a bit complex, so don't feel bad if you don't grok it on the
first shot, it may take a bit of time to get right.</p>
<p>The main entry-point to the Compiler is <code class="docutils literal"><span class="pre">HyASTCompiler.compile</span></code>. This method
is invoked, and the only real &quot;public&quot; method on the class (that is to say,
we don't really promise the API beyond that method).</p>
<p>In fact, even internally, we don't recurse directly hardly ever, we almost
always force the Hy tree through <code class="docutils literal"><span class="pre">compile</span></code>, and will often do this with
sub-elements of an expression that we have. It's up to the Type-based dispatcher
to properly dispatch sub-elements.</p>
<p>All methods that preform a compilation are marked with the <code class="docutils literal"><span class="pre">&#64;builds()</span></code>
decorator. You can either pass the class of the Hy model that it compiles,
or you can use a string for expressions. I'll clear this up in a second.</p>
<div class="section" id="first-stage-type-dispatch">
<h6>First Stage Type-Dispatch<a class="headerlink" href="#first-stage-type-dispatch" title="Permalink to this headline">¶</a></h6>
<p>Let's start in the <code class="docutils literal"><span class="pre">compile</span></code> method. The first thing we do is check the
Type of the thing we're building. We look up to see if we have a method that
can build the <code class="docutils literal"><span class="pre">type()</span></code> that we have, and dispatch to the method that can
handle it. If we don't have any methods that can build that type, we raise
an internal <code class="docutils literal"><span class="pre">Exception</span></code>.</p>
<p>For instance, if we have a <code class="docutils literal"><span class="pre">HyString</span></code>, we have an almost 1-to-1 mapping of
Hy AST to Python AST. The <code class="docutils literal"><span class="pre">compile_string</span></code> method takes the <code class="docutils literal"><span class="pre">HyString</span></code>, and
returns an <code class="docutils literal"><span class="pre">ast.Str()</span></code> that's populated with the correct line-numbers and
content.</p>
</div>
<div class="section" id="macro-expand">
<h6>Macro-Expand<a class="headerlink" href="#macro-expand" title="Permalink to this headline">¶</a></h6>
<p>If we get a <code class="docutils literal"><span class="pre">HyExpression</span></code>, we'll attempt to see if this is a known
Macro, and push to have it expanded by invoking <code class="docutils literal"><span class="pre">hy.macros.macroexpand</span></code>, then
push the result back into <code class="docutils literal"><span class="pre">HyASTCompiler.compile</span></code>.</p>
</div>
<div class="section" id="second-stage-expression-dispatch">
<h6>Second Stage Expression-Dispatch<a class="headerlink" href="#second-stage-expression-dispatch" title="Permalink to this headline">¶</a></h6>
<p>The only special case is the <code class="docutils literal"><span class="pre">HyExpression</span></code>, since we need to create different
AST depending on the special form in question. For instance, when we hit an
<code class="docutils literal"><span class="pre">(if</span> <span class="pre">True</span> <span class="pre">True</span> <span class="pre">False)</span></code>, we need to generate a <code class="docutils literal"><span class="pre">ast.If</span></code>, and properly
compile the sub-nodes. This is where the <code class="docutils literal"><span class="pre">&#64;builds()</span></code> with a String as an
argument comes in.</p>
<p>For the <code class="docutils literal"><span class="pre">compile_expression</span></code> (which is defined with an
<code class="docutils literal"><span class="pre">&#64;builds(HyExpression)</span></code>) will dispatch based on the string of the first
argument. If, for some reason, the first argument is not a string, it will
properly handle that case as well (most likely by raising an <code class="docutils literal"><span class="pre">Exception</span></code>).</p>
<p>If the String isn't known to Hy, it will default to create an <code class="docutils literal"><span class="pre">ast.Call</span></code>,
which will try to do a runtime call (in Python, something like <code class="docutils literal"><span class="pre">foo()</span></code>).</p>
</div>
<div class="section" id="issues-hit-with-python-ast">
<h6>Issues Hit with Python AST<a class="headerlink" href="#issues-hit-with-python-ast" title="Permalink to this headline">¶</a></h6>
<p>Python AST is great; it's what's enabled us to write such a powerful project
on top of Python without having to fight Python too hard. Like anything, we've
had our fair share of issues, and here's a short list of the common ones you
might run into.</p>
<p><em>Python differentiates between Statements and Expressions</em>.</p>
<p>This might not sound like a big deal -- in fact, to most Python programmers,
this will shortly become a &quot;Well, yeah&quot; moment.</p>
<p>In Python, doing something like:</p>
<p><code class="docutils literal"><span class="pre">print</span> <span class="pre">for</span> <span class="pre">x</span> <span class="pre">in</span> <span class="pre">range(10):</span> <span class="pre">pass</span></code>, because <code class="docutils literal"><span class="pre">print</span></code> prints expressions, and
<code class="docutils literal"><span class="pre">for</span></code> isn't an expression, it's a control flow statement. Things like
<code class="docutils literal"><span class="pre">1</span> <span class="pre">+</span> <span class="pre">1</span></code> are Expressions, as is <code class="docutils literal"><span class="pre">lambda</span> <span class="pre">x:</span> <span class="pre">1</span> <span class="pre">+</span> <span class="pre">x</span></code>, but other language
features, such as <code class="docutils literal"><span class="pre">if</span></code>, <code class="docutils literal"><span class="pre">for</span></code>, or <code class="docutils literal"><span class="pre">while</span></code> are statements.</p>
<p>Since they have no &quot;value&quot; to Python, this makes working in Hy hard, since
doing something like <code class="docutils literal"><span class="pre">(print</span> <span class="pre">(if</span> <span class="pre">True</span> <span class="pre">True</span> <span class="pre">False))</span></code> is not just common, it's
expected.</p>
<p>As a result, we auto-mangle things using a <code class="docutils literal"><span class="pre">Result</span></code> object, where we offer
up any <code class="docutils literal"><span class="pre">ast.stmt</span></code> that need to get run, and a single <code class="docutils literal"><span class="pre">ast.expr</span></code> that can
be used to get the value of whatever was just run. Hy does this by forcing
assignment to things while running.</p>
<p>As example, the Hy:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">(</span><span class="nb">print</span> <span class="p">(</span><span class="k">if</span> <span class="kc">True</span> <span class="kc">True</span> <span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
<p>Will turn into:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">_mangled_name_here</span> <span class="o">=</span> <span class="kc">True</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">_mangled_name_here</span> <span class="o">=</span> <span class="kc">False</span>

<span class="nb">print</span> <span class="n">_mangled_name_here</span>
</pre></div>
</div>
<p>OK, that was a bit of a lie, since we actually turn that statement
into:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="nb">print</span> <span class="kc">True</span> <span class="k">if</span> <span class="kc">True</span> <span class="k">else</span> <span class="kc">False</span>
</pre></div>
</div>
<p>By forcing things into an <code class="docutils literal"><span class="pre">ast.expr</span></code> if we can, but the general idea holds.</p>
</div>
</div>
<div class="section" id="step-4-python-bytecode-output-and-runtime">
<h5>Step 4: Python Bytecode Output and Runtime<a class="headerlink" href="#step-4-python-bytecode-output-and-runtime" title="Permalink to this headline">¶</a></h5>
<p>After we have a Python AST tree that's complete, we can try and compile it to
Python bytecode by pushing it through <code class="docutils literal"><span class="pre">eval</span></code>. From here on out, we're no
longer in control, and Python is taking care of everything. This is why things
like Python tracebacks, pdb and django apps work.</p>
</div>
</div>
<div class="section" id="hy-macros">
<h4>Hy Macros<a class="headerlink" href="#hy-macros" title="Permalink to this headline">¶</a></h4>
<div class="section" id="using-gensym-for-safer-macros">
<span id="using-gensym"></span><h5>Using gensym for Safer Macros<a class="headerlink" href="#using-gensym-for-safer-macros" title="Permalink to this headline">¶</a></h5>
<p>When writing macros, one must be careful to avoid capturing external variables
or using variable names that might conflict with user code.</p>
<p>We will use an example macro <code class="docutils literal"><span class="pre">nif</span></code> (see <a class="reference external" href="http://letoverlambda.com/index.cl/guest/chap3.html#sec_5">http://letoverlambda.com/index.cl/guest/chap3.html#sec_5</a>
for a more complete description.) <code class="docutils literal"><span class="pre">nif</span></code> is an example, something like a numeric <code class="docutils literal"><span class="pre">if</span></code>,
where based on the expression, one of the 3 forms is called depending on if the
expression is positive, zero or negative.</p>
<p>A first pass might be something like:</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span>(defmacro nif [expr pos-form zero-form neg-form]
  `(do
    (setv obscure-name ~expr)
    (cond [(pos? obscure-name) ~pos-form]
          [(zero? obscure-name) ~zero-form]
          [(neg? obscure-name) ~neg-form])))
</pre></div>
</div>
<p>where <code class="docutils literal"><span class="pre">obscure-name</span></code> is an attempt to pick some variable name as not to
conflict with other code. But of course, while well-intentioned,
this is no guarantee.</p>
<p>The method <a class="reference internal" href="index.html#gensym"><span class="std std-ref">gensym</span></a> is designed to generate a new, unique symbol for just
such an occasion. A much better version of <code class="docutils literal"><span class="pre">nif</span></code> would be:</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span>(defmacro nif [expr pos-form zero-form neg-form]
  (setv g (gensym))
  `(do
     (setv ~g ~expr)
     (cond [(pos? ~g) ~pos-form]
           [(zero? ~g) ~zero-form]
           [(neg? ~g) ~neg-form])))
</pre></div>
</div>
<p>This is an easy case, since there is only one symbol. But if there is
a need for several gensym's there is a second macro <a class="reference internal" href="index.html#with-gensyms"><span class="std std-ref">with-gensyms</span></a> that
basically expands to a <code class="docutils literal"><span class="pre">setv</span></code> form:</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">(</span><span class="n">with</span><span class="o">-</span><span class="n">gensyms</span> <span class="o">[</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span><span class="o">]</span>
  <span class="o">...)</span>
</pre></div>
</div>
<p>expands to:</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">(</span><span class="k">do</span>
  <span class="o">(</span><span class="n">setv</span> <span class="n">a</span> <span class="o">(</span><span class="n">gensym</span><span class="o">)</span>
        <span class="n">b</span> <span class="o">(</span><span class="n">gensym</span><span class="o">)</span>
        <span class="n">c</span> <span class="o">(</span><span class="n">gensym</span><span class="o">))</span>
  <span class="o">...)</span>
</pre></div>
</div>
<p>so our re-written <code class="docutils literal"><span class="pre">nif</span></code> would look like:</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span>(defmacro nif [expr pos-form zero-form neg-form]
  (with-gensyms [g]
    `(setv [~g ~expr])
    `(cond [(pos? ~g) ~pos-form]
           [(zero? ~g) ~zero-form]
           [(neg? ~g) ~neg-form])))
</pre></div>
</div>
<p>Finally, though we can make a new macro that does all this for us. <a class="reference internal" href="index.html#defmacro-g"><span class="std std-ref">defmacro/g!</span></a>
will take all symbols that begin with <code class="docutils literal"><span class="pre">g!</span></code> and automatically call <code class="docutils literal"><span class="pre">gensym</span></code> with the
remainder of the symbol. So <code class="docutils literal"><span class="pre">g!a</span></code> would become <code class="docutils literal"><span class="pre">(gensym</span> <span class="pre">&quot;a&quot;)</span></code>.</p>
<p>Our final version of <code class="docutils literal"><span class="pre">nif</span></code>, built with <code class="docutils literal"><span class="pre">defmacro/g!</span></code> becomes:</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span>(defmacro/g! nif [expr pos-form zero-form neg-form]
  `(do
     (setv ~g!res ~expr)
     (cond [(pos? ~g!res) ~pos-form]
           [(zero? ~g!res) ~zero-form]
           [(neg? ~g!res) ~neg-form])))
</pre></div>
</div>
</div>
<div class="section" id="checking-macro-arguments-and-raising-exceptions">
<h5>Checking Macro Arguments and Raising Exceptions<a class="headerlink" href="#checking-macro-arguments-and-raising-exceptions" title="Permalink to this headline">¶</a></h5>
</div>
</div>
<div class="section" id="hy-compiler-built-ins">
<h4>Hy Compiler Built-Ins<a class="headerlink" href="#hy-compiler-built-ins" title="Permalink to this headline">¶</a></h4>
</div>
</div>
</div>
</div>
<span id="document-extra/index"></span><div class="section" id="extra-modules-index">
<h2>Extra Modules Index<a class="headerlink" href="#extra-modules-index" title="Permalink to this headline">¶</a></h2>
<p>These modules are considered no less stable than Hy's built-in
functions and macros, but they need to be loaded with <code class="docutils literal"><span class="pre">(import</span>
<span class="pre">...)</span></code> or <code class="docutils literal"><span class="pre">(require</span> <span class="pre">...)</span></code>.</p>
<p>Contents:</p>
<div class="toctree-wrapper compound">
<span id="document-extra/anaphoric"></span><div class="section" id="anaphoric-macros">
<h3>Anaphoric Macros<a class="headerlink" href="#anaphoric-macros" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.9.12.</span></p>
</div>
<p>The anaphoric macros module makes functional programming in Hy very
concise and easy to read.</p>
<blockquote>
<div><p>An anaphoric macro is a type of programming macro that
deliberately captures some form supplied to the macro which may be
referred to by an anaphor (an expression referring to another).</p>
<p class="attribution">&mdash;Wikipedia (<a class="reference external" href="https://en.wikipedia.org/wiki/Anaphoric_macro">https://en.wikipedia.org/wiki/Anaphoric_macro</a>)</p>
</div></blockquote>
<p>To use these macros you need to require the <code class="docutils literal"><span class="pre">hy.extra.anaphoric</span></code> module like so:</p>
<p><code class="docutils literal"><span class="pre">(require</span> <span class="pre">[hy.extra.anaphoric</span> <span class="pre">[*]])</span></code></p>
<div class="section" id="ap-if">
<span id="id1"></span><h4>ap-if<a class="headerlink" href="#ap-if" title="Permalink to this headline">¶</a></h4>
<p>Usage: <code class="docutils literal"><span class="pre">(ap-if</span> <span class="pre">(foo)</span> <span class="pre">(print</span> <span class="pre">it))</span></code></p>
<p>Evaluates the first form for truthiness, and bind it to <code class="docutils literal"><span class="pre">it</span></code> in both the
true and false branches.</p>
</div>
<div class="section" id="ap-each">
<span id="id2"></span><h4>ap-each<a class="headerlink" href="#ap-each" title="Permalink to this headline">¶</a></h4>
<p>Usage: <code class="docutils literal"><span class="pre">(ap-each</span> <span class="pre">[1</span> <span class="pre">2</span> <span class="pre">3</span> <span class="pre">4</span> <span class="pre">5]</span> <span class="pre">(print</span> <span class="pre">it))</span></code></p>
<p>Evaluate the form for each element in the list for side-effects.</p>
</div>
<div class="section" id="ap-each-while">
<span id="id3"></span><h4>ap-each-while<a class="headerlink" href="#ap-each-while" title="Permalink to this headline">¶</a></h4>
<p>Usage: <code class="docutils literal"><span class="pre">(ap-each-while</span> <span class="pre">list</span> <span class="pre">pred</span> <span class="pre">body)</span></code></p>
<p>Evaluate the form for each element where the predicate form returns
<code class="docutils literal"><span class="pre">True</span></code>.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">ap</span><span class="o">-</span><span class="n">each</span><span class="o">-</span><span class="k">while</span> <span class="o">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span><span class="o">]</span> <span class="o">(&lt;</span> <span class="n">it</span> <span class="mi">4</span><span class="o">)</span> <span class="o">(</span><span class="nb">print</span> <span class="n">it</span><span class="o">))</span>
<span class="mi">1</span>
<span class="mi">2</span>
<span class="mi">3</span>
</pre></div>
</div>
</div>
<div class="section" id="ap-map">
<span id="id4"></span><h4>ap-map<a class="headerlink" href="#ap-map" title="Permalink to this headline">¶</a></h4>
<p>Usage: <code class="docutils literal"><span class="pre">(ap-map</span> <span class="pre">form</span> <span class="pre">list)</span></code></p>
<p>The anaphoric form of map works just like regular map except that
instead of a function object it takes a Hy form. The special name
<code class="docutils literal"><span class="pre">it</span></code> is bound to the current object from the list in the iteration.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">ap</span><span class="o">-</span><span class="n">map</span> <span class="o">(*</span> <span class="n">it</span> <span class="mi">2</span><span class="o">)</span> <span class="o">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="o">]))</span>
<span class="o">[</span><span class="mi">2</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">6</span><span class="o">]</span>
</pre></div>
</div>
</div>
<div class="section" id="ap-map-when">
<span id="id5"></span><h4>ap-map-when<a class="headerlink" href="#ap-map-when" title="Permalink to this headline">¶</a></h4>
<p>Usage: <code class="docutils literal"><span class="pre">(ap-map-when</span> <span class="pre">predfn</span> <span class="pre">rep</span> <span class="pre">list)</span></code></p>
<p>Evaluate a mapping over the list using a predicate function to
determin when to apply the form.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">ap</span><span class="o">-</span><span class="n">map</span><span class="o">-</span><span class="n">when</span> <span class="n">odd</span><span class="o">?</span> <span class="o">(*</span> <span class="n">it</span> <span class="mi">2</span><span class="o">)</span> <span class="o">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span><span class="o">]))</span>
<span class="o">[</span><span class="mi">2</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">6</span><span class="o">,</span> <span class="mi">4</span><span class="o">]</span>

<span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">ap</span><span class="o">-</span><span class="n">map</span><span class="o">-</span><span class="n">when</span> <span class="n">even</span><span class="o">?</span> <span class="o">(*</span> <span class="n">it</span> <span class="mi">2</span><span class="o">)</span> <span class="o">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span><span class="o">]))</span>
<span class="o">[</span><span class="mi">1</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">8</span><span class="o">]</span>
</pre></div>
</div>
</div>
<div class="section" id="ap-filter">
<span id="id6"></span><h4>ap-filter<a class="headerlink" href="#ap-filter" title="Permalink to this headline">¶</a></h4>
<p>Usage: <code class="docutils literal"><span class="pre">(ap-filter</span> <span class="pre">form</span> <span class="pre">list)</span></code></p>
<p>As with <code class="docutils literal"><span class="pre">ap-map</span></code> we take a special form instead of a function to
filter the elements of the list. The special name <code class="docutils literal"><span class="pre">it</span></code> is bound to
the current element in the iteration.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">ap</span><span class="o">-</span><span class="n">filter</span> <span class="o">(&gt;</span> <span class="o">(*</span> <span class="n">it</span> <span class="mi">2</span><span class="o">)</span> <span class="mi">6</span><span class="o">)</span> <span class="o">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span><span class="o">]))</span>
<span class="o">[</span><span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">]</span>
</pre></div>
</div>
</div>
<div class="section" id="ap-reject">
<span id="id7"></span><h4>ap-reject<a class="headerlink" href="#ap-reject" title="Permalink to this headline">¶</a></h4>
<p>Usage: <code class="docutils literal"><span class="pre">(ap-reject</span> <span class="pre">form</span> <span class="pre">list)</span></code></p>
<p>This function does the opposite of <code class="docutils literal"><span class="pre">ap-filter</span></code>, it rejects the
elements passing the predicate . The special name <code class="docutils literal"><span class="pre">it</span></code> is bound to
the current element in the iteration.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">ap</span><span class="o">-</span><span class="n">reject</span> <span class="o">(&gt;</span> <span class="o">(*</span> <span class="n">it</span> <span class="mi">2</span><span class="o">)</span> <span class="mi">6</span><span class="o">)</span> <span class="o">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span><span class="o">]))</span>
<span class="o">[</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">]</span>
</pre></div>
</div>
</div>
<div class="section" id="ap-dotimes">
<span id="id8"></span><h4>ap-dotimes<a class="headerlink" href="#ap-dotimes" title="Permalink to this headline">¶</a></h4>
<p>Usage <code class="docutils literal"><span class="pre">(ap-dotimes</span> <span class="pre">n</span> <span class="pre">body)</span></code></p>
<p>This function evaluates the body <em>n</em> times, with the special
variable <code class="docutils literal"><span class="pre">it</span></code> bound from <em>0</em> to <em>1-n</em>. It is useful for side-effects.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span> <span class="o">=&gt;</span> <span class="o">(</span><span class="n">setv</span> <span class="n">n</span> <span class="o">[])</span>
 <span class="o">=&gt;</span> <span class="o">(</span><span class="n">ap</span><span class="o">-</span><span class="n">dotimes</span> <span class="mi">3</span> <span class="o">(.</span><span class="n">append</span> <span class="n">n</span> <span class="n">it</span><span class="o">))</span>
 <span class="o">=&gt;</span> <span class="n">n</span>
<span class="o">[</span><span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">]</span>
</pre></div>
</div>
</div>
<div class="section" id="ap-first">
<span id="id9"></span><h4>ap-first<a class="headerlink" href="#ap-first" title="Permalink to this headline">¶</a></h4>
<p>Usage <code class="docutils literal"><span class="pre">(ap-first</span> <span class="pre">predfn</span> <span class="pre">list)</span></code></p>
<p>This function returns the first element that passes the predicate or
<code class="docutils literal"><span class="pre">None</span></code>, with the special variable <code class="docutils literal"><span class="pre">it</span></code> bound to the current element in
iteration.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;(</span><span class="n">ap</span><span class="o">-</span><span class="n">first</span> <span class="o">(&gt;</span> <span class="n">it</span> <span class="mi">5</span><span class="o">)</span> <span class="o">(</span><span class="n">range</span> <span class="mi">10</span><span class="o">))</span>
<span class="mi">6</span>
</pre></div>
</div>
</div>
<div class="section" id="ap-last">
<span id="id10"></span><h4>ap-last<a class="headerlink" href="#ap-last" title="Permalink to this headline">¶</a></h4>
<p>Usage <code class="docutils literal"><span class="pre">(ap-last</span> <span class="pre">predfn</span> <span class="pre">list)</span></code></p>
<p>This function returns the last element that passes the predicate or
<code class="docutils literal"><span class="pre">None</span></code>, with the special variable <code class="docutils literal"><span class="pre">it</span></code> bound to the current element in
iteration.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;(</span><span class="n">ap</span><span class="o">-</span><span class="n">last</span> <span class="o">(&gt;</span> <span class="n">it</span> <span class="mi">5</span><span class="o">)</span> <span class="o">(</span><span class="n">range</span> <span class="mi">10</span><span class="o">))</span>
<span class="mi">9</span>
</pre></div>
</div>
</div>
<div class="section" id="ap-reduce">
<span id="id11"></span><h4>ap-reduce<a class="headerlink" href="#ap-reduce" title="Permalink to this headline">¶</a></h4>
<p>Usage <code class="docutils literal"><span class="pre">(ap-reduce</span> <span class="pre">form</span> <span class="pre">list</span> <span class="pre">&amp;optional</span> <span class="pre">initial-value)</span></code></p>
<p>This function returns the result of applying form to the first 2
elements in the body and applying the result and the 3rd element
etc. until the list is exhausted. Optionally an initial value can be
supplied so the function will be applied to initial value and the
first element instead. This exposes the element being iterated as
<code class="docutils literal"><span class="pre">it</span></code> and the current accumulated value as <code class="docutils literal"><span class="pre">acc</span></code>.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;(</span><span class="n">ap</span><span class="o">-</span><span class="n">reduce</span> <span class="o">(+</span> <span class="n">it</span> <span class="n">acc</span><span class="o">)</span> <span class="o">(</span><span class="n">range</span> <span class="mi">10</span><span class="o">))</span>
<span class="mi">45</span>
</pre></div>
</div>
</div>
<div class="section" id="ap-pipe">
<span id="id12"></span><h4>ap-pipe<a class="headerlink" href="#ap-pipe" title="Permalink to this headline">¶</a></h4>
<p>Usage <code class="docutils literal"><span class="pre">(ap-pipe</span> <span class="pre">value</span> <span class="pre">form1</span> <span class="pre">form2</span> <span class="pre">...)</span></code></p>
<p>Applies several forms in series to a value from left to right. The special variable <code class="docutils literal"><span class="pre">ìt</span></code> in each form is replaced by the result of the previous form.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">ap</span><span class="o">-</span><span class="n">pipe</span> <span class="mi">3</span> <span class="o">(+</span> <span class="n">it</span> <span class="mi">1</span><span class="o">)</span> <span class="o">(/</span> <span class="mi">5</span> <span class="n">it</span><span class="o">))</span>
<span class="mf">1.25</span>
<span class="o">=&gt;</span> <span class="o">(</span><span class="n">ap</span><span class="o">-</span><span class="n">pipe</span> <span class="o">[</span><span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span><span class="o">]</span> <span class="o">(</span><span class="n">list</span> <span class="o">(</span><span class="n">rest</span> <span class="n">it</span><span class="o">))</span> <span class="o">(</span><span class="n">len</span> <span class="n">it</span><span class="o">))</span>
<span class="mi">3</span>
</pre></div>
</div>
</div>
<div class="section" id="ap-compose">
<span id="id13"></span><h4>ap-compose<a class="headerlink" href="#ap-compose" title="Permalink to this headline">¶</a></h4>
<p>Usage <code class="docutils literal"><span class="pre">(ap-compose</span> <span class="pre">form1</span> <span class="pre">form2</span> <span class="pre">...)</span></code></p>
<p>Returns a function which applies several forms in series from left to right. The special variable <code class="docutils literal"><span class="pre">ìt</span></code> in each form is replaced by the result of the previous form.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="n">def</span> <span class="n">op</span> <span class="o">(</span><span class="n">ap</span><span class="o">-</span><span class="n">compose</span> <span class="o">(+</span> <span class="n">it</span> <span class="mi">1</span><span class="o">)</span> <span class="o">(*</span> <span class="n">it</span> <span class="mi">3</span><span class="o">)))</span>
<span class="o">=&gt;</span> <span class="o">(</span><span class="n">op</span> <span class="mi">2</span><span class="o">)</span>
<span class="mi">9</span>
</pre></div>
</div>
</div>
<div class="section" id="xi">
<h4>xi<a class="headerlink" href="#xi" title="Permalink to this headline">¶</a></h4>
<p>Usage <code class="docutils literal"><span class="pre">(xi</span> <span class="pre">body</span> <span class="pre">...)</span></code></p>
<p>Returns a function with parameters implicitly determined by the presence in the body of xi parameters. An xi symbol designates the ith parameter (1-based, e.g. x1, x2, x3, etc.), or all remaining parameters for xi itself. This is not a replacement for fn. The xi forms cannot be nested.</p>
<p>This is similar to Clojure's anonymous function literals (<code class="docutils literal"><span class="pre">#()</span></code>).</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">((</span><span class="n">xi</span> <span class="n">identity</span> <span class="o">[</span><span class="n">x1</span> <span class="n">x5</span> <span class="o">[</span><span class="n">x2</span> <span class="n">x3</span><span class="o">]</span> <span class="n">xi</span> <span class="n">x4</span><span class="o">])</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span><span class="o">)</span>
<span class="o">[</span><span class="mi">1</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="o">[</span><span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,]</span> <span class="o">(</span><span class="mi">6</span><span class="o">,</span> <span class="mi">7</span><span class="o">,</span> <span class="mi">8</span><span class="o">),</span> <span class="mi">4</span><span class="o">]</span>
<span class="o">=&gt;</span> <span class="o">(</span><span class="n">def</span> <span class="n">add</span><span class="o">-</span><span class="mi">10</span> <span class="o">(</span><span class="n">xi</span> <span class="o">+</span> <span class="mi">10</span> <span class="n">x1</span><span class="o">))</span>
<span class="o">=&gt;</span> <span class="o">(</span><span class="n">add</span><span class="o">-</span><span class="mi">10</span> <span class="mi">6</span><span class="o">)</span>
<span class="mi">16</span>
</pre></div>
</div>
</div>
</div>
<span id="document-extra/reserved"></span><div class="section" id="reserved-names">
<h3>Reserved Names<a class="headerlink" href="#reserved-names" title="Permalink to this headline">¶</a></h3>
<div class="section" id="names">
<h4>names<a class="headerlink" href="#names" title="Permalink to this headline">¶</a></h4>
<p>Usage: <code class="docutils literal"><span class="pre">(names)</span></code></p>
<p>This function can be used to get a list (actually, a <code class="docutils literal"><span class="pre">frozenset</span></code>) of the
names of Hy's built-in functions, macros, and special forms. The output
also includes all Python reserved words. All names are in unmangled form
(e.g., <code class="docutils literal"><span class="pre">list-comp</span></code> rather than <code class="docutils literal"><span class="pre">list_comp</span></code>).</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">=&gt;</span> <span class="o">(</span><span class="kn">import</span> <span class="nn">hy.extra.reserved</span><span class="o">)</span>
<span class="o">=&gt;</span> <span class="o">(</span><span class="n">in</span> <span class="s">&quot;defclass&quot;</span> <span class="o">(</span><span class="n">hy</span><span class="o">.</span><span class="na">extra</span><span class="o">.</span><span class="na">reserved</span><span class="o">.</span><span class="na">names</span><span class="o">))</span>
<span class="n">True</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<span id="document-contrib/index"></span><div class="section" id="contributor-modules-index">
<h2>Contributor Modules Index<a class="headerlink" href="#contributor-modules-index" title="Permalink to this headline">¶</a></h2>
<p>These modules are experimental additions to Hy. Once deemed mature,
they will be moved to the <code class="docutils literal"><span class="pre">hy.extra</span></code> namespace or loaded by
default.</p>
<p>Contents:</p>
<div class="toctree-wrapper compound">
<span id="document-contrib/loop"></span><div class="section" id="loop-recur">
<h3>loop/recur<a class="headerlink" href="#loop-recur" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.10.0.</span></p>
</div>
<p>The <code class="docutils literal"><span class="pre">loop</span></code> / <code class="docutils literal"><span class="pre">recur</span></code> macro gives programmers a simple way to use
tail-call optimization (TCO) in their Hy code.</p>
<blockquote>
<div><p>A tail call is a subroutine call that happens inside another
procedure as its final action; it may produce a return value which
is then immediately returned by the calling procedure. If any call
that a subroutine performs, such that it might eventually lead to
this same subroutine being called again down the call chain, is in
tail position, such a subroutine is said to be tail-recursive,
which is a special case of recursion. Tail calls are significant
because they can be implemented without adding a new stack frame
to the call stack. Most of the frame of the current procedure is
not needed any more, and it can be replaced by the frame of the
tail call. The program can then jump to the called
subroutine. Producing such code instead of a standard call
sequence is called tail call elimination, or tail call
optimization. Tail call elimination allows procedure calls in tail
position to be implemented as efficiently as goto statements, thus
allowing efficient structured programming.</p>
<p class="attribution">&mdash;Wikipedia (<a class="reference external" href="https://en.wikipedia.org/wiki/Tail_call">https://en.wikipedia.org/wiki/Tail_call</a>)</p>
</div></blockquote>
<div class="section" id="macros">
<h4>Macros<a class="headerlink" href="#macros" title="Permalink to this headline">¶</a></h4>
<div class="section" id="loop">
<span id="id1"></span><h5>loop<a class="headerlink" href="#loop" title="Permalink to this headline">¶</a></h5>
<p><code class="docutils literal"><span class="pre">loop</span></code> establishes a recursion point. With <code class="docutils literal"><span class="pre">loop</span></code>, <code class="docutils literal"><span class="pre">recur</span></code>
rebinds the variables set in the recursion point and sends code
execution back to that recursion point. If <code class="docutils literal"><span class="pre">recur</span></code> is used in a
non-tail position, an exception is raised.</p>
<p>Usage: <code class="docutils literal"><span class="pre">(loop</span> <span class="pre">bindings</span> <span class="pre">&amp;rest</span> <span class="pre">body)</span></code></p>
<p>Example:</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">(</span><span class="n">require</span> <span class="o">[</span><span class="n">hy</span><span class="o">.</span><span class="na">contrib</span><span class="o">.</span><span class="na">loop</span> <span class="o">[</span><span class="n">loop</span><span class="o">]])</span>

<span class="o">(</span><span class="n">defn</span> <span class="n">factorial</span> <span class="o">[</span><span class="n">n</span><span class="o">]</span>
  <span class="o">(</span><span class="n">loop</span> <span class="o">[[</span><span class="n">i</span> <span class="n">n</span><span class="o">]</span> <span class="o">[</span><span class="n">acc</span> <span class="mi">1</span><span class="o">]]</span>
    <span class="o">(</span><span class="k">if</span> <span class="o">(</span><span class="n">zero</span><span class="o">?</span> <span class="n">i</span><span class="o">)</span>
      <span class="n">acc</span>
      <span class="o">(</span><span class="n">recur</span> <span class="o">(</span><span class="n">dec</span> <span class="n">i</span><span class="o">)</span> <span class="o">(*</span> <span class="n">acc</span> <span class="n">i</span><span class="o">)))))</span>

<span class="o">(</span><span class="n">factorial</span> <span class="mi">1000</span><span class="o">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<span id="document-contrib/multi"></span><div class="section" id="defmulti">
<h3>defmulti<a class="headerlink" href="#defmulti" title="Permalink to this headline">¶</a></h3>
<div class="section" id="defn">
<h4>defn<a class="headerlink" href="#defn" title="Permalink to this headline">¶</a></h4>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.10.0.</span></p>
</div>
<p><code class="docutils literal"><span class="pre">defn</span></code> lets you arity-overload a function by the given number of
args and/or kwargs. This version of <code class="docutils literal"><span class="pre">defn</span></code> works with regular syntax and
with the arity overloaded one. Inspired by Clojures take on <code class="docutils literal"><span class="pre">defn</span></code>.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">require</span> <span class="p">[</span><span class="nv">hy.contrib.multi</span> <span class="p">[</span><span class="nv">defn</span><span class="p">]])</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="kd">defn </span><span class="nv">fun</span>
<span class="nv">...</span>  <span class="p">([</span><span class="nv">a</span><span class="p">]</span> <span class="s">&quot;a&quot;</span><span class="p">)</span>
<span class="nv">...</span>  <span class="p">([</span><span class="nv">a</span> <span class="nv">b</span><span class="p">]</span> <span class="s">&quot;a b&quot;</span><span class="p">)</span>
<span class="nv">...</span>  <span class="p">([</span><span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span><span class="p">]</span> <span class="s">&quot;a b c&quot;</span><span class="p">))</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">fun</span> <span class="mi">1</span><span class="p">)</span>
<span class="s">&quot;a&quot;</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">fun</span> <span class="mi">1</span> <span class="mi">2</span><span class="p">)</span>
<span class="s">&quot;a b&quot;</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">fun</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">)</span>
<span class="s">&quot;a b c&quot;</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="kd">defn </span><span class="nv">add</span> <span class="p">[</span><span class="nv">a</span> <span class="nv">b</span><span class="p">]</span>
<span class="nv">...</span>  <span class="p">(</span><span class="nb">+ </span><span class="nv">a</span> <span class="nv">b</span><span class="p">))</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">add</span> <span class="mi">1</span> <span class="mi">2</span><span class="p">)</span>
<span class="mi">3</span>
</pre></div>
</div>
</div>
<div class="section" id="id1">
<h4>defmulti<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.12.0.</span></p>
</div>
<p><code class="docutils literal"><span class="pre">defmulti</span></code>, <code class="docutils literal"><span class="pre">defmethod</span></code> and <code class="docutils literal"><span class="pre">default-method</span></code> lets you define
multimethods where a dispatching function is used to select between different
implementations of the function. Inspired by Clojure's multimethod and based
on the code by <a class="reference external" href="https://adambard.com/blog/implementing-multimethods-in-python/">Adam Bard</a>.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">require</span> <span class="p">[</span><span class="nv">hy.contrib.multi</span> <span class="p">[</span><span class="kd">defmulti defmethod </span><span class="nv">default-method</span><span class="p">]])</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="kd">defmulti </span><span class="nv">area</span> <span class="p">[</span><span class="nv">shape</span><span class="p">]</span>
<span class="nv">...</span>  <span class="s">&quot;calculate area of a shape&quot;</span>
<span class="nv">...</span>  <span class="p">(</span><span class="ss">:type</span> <span class="nv">shape</span><span class="p">))</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="kd">defmethod </span><span class="nv">area</span> <span class="s">&quot;square&quot;</span> <span class="p">[</span><span class="nv">square</span><span class="p">]</span>
<span class="nv">...</span>  <span class="p">(</span><span class="nb">* </span><span class="p">(</span><span class="ss">:width</span> <span class="nv">square</span><span class="p">)</span>
<span class="nv">...</span>     <span class="p">(</span><span class="ss">:height</span> <span class="nv">square</span><span class="p">)))</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="kd">defmethod </span><span class="nv">area</span> <span class="s">&quot;circle&quot;</span> <span class="p">[</span><span class="nv">circle</span><span class="p">]</span>
<span class="nv">...</span>  <span class="p">(</span><span class="nb">* </span><span class="p">(</span><span class="nf">**</span> <span class="p">(</span><span class="ss">:radius</span> <span class="nv">circle</span><span class="p">)</span> <span class="mi">2</span><span class="p">)</span>
<span class="nv">...</span>     <span class="mf">3.14</span><span class="p">))</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">default-method</span> <span class="nv">area</span> <span class="p">[</span><span class="nv">shape</span><span class="p">]</span>
<span class="nv">...</span>  <span class="mi">0</span><span class="p">)</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">area</span> <span class="p">{</span><span class="ss">:type</span> <span class="s">&quot;circle&quot;</span> <span class="ss">:radius</span> <span class="mf">0.5</span><span class="p">})</span>
<span class="mf">0.785</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">area</span> <span class="p">{</span><span class="ss">:type</span> <span class="s">&quot;square&quot;</span> <span class="ss">:width</span> <span class="mi">2</span> <span class="ss">:height</span> <span class="mi">2</span><span class="p">})</span>
<span class="mi">4</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">area</span> <span class="p">{</span><span class="ss">:type</span> <span class="s">&quot;non-euclid rhomboid&quot;</span><span class="p">})</span>
<span class="mi">0</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">defmulti</span></code> is used to define the initial multimethod with name, signature
and code that selects between different implementations. In the example,
multimethod expects a single input that is type of dictionary and contains
at least key :type. The value that corresponds to this key is returned and
is used to selected between different implementations.</p>
<p><code class="docutils literal"><span class="pre">defmethod</span></code> defines a possible implementation for multimethod. It works
otherwise in the same way as <code class="docutils literal"><span class="pre">defn</span></code>, but has an extra parameters
for specifying multimethod and which calls are routed to this specific
implementation. In the example, shapes with &quot;square&quot; as :type are routed to
first function and shapes with &quot;circle&quot; as :type are routed to second
function.</p>
<p><code class="docutils literal"><span class="pre">default-method</span></code> specifies default implementation for multimethod that is
called when no other implementation matches.</p>
<p>Interfaces of multimethod and different implementation don't have to be
exactly identical, as long as they're compatible enough. In practice this
means that multimethod should accept the broadest range of parameters and
different implementations can narrow them down.</p>
<div class="highlight-clj"><div class="highlight"><pre><span></span><span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">require</span> <span class="p">[</span><span class="nv">hy.contrib.multi</span> <span class="p">[</span><span class="kd">defmulti </span><span class="nv">defmethod</span><span class="p">]])</span>
<span class="nv">=&gt;</span> <span class="p">(</span><span class="kd">defmulti </span><span class="nv">fun</span> <span class="p">[</span><span class="o">&amp;</span><span class="nb">rest </span><span class="nv">args</span><span class="p">]</span>
<span class="nv">...</span>  <span class="p">(</span><span class="nf">len</span> <span class="nv">args</span><span class="p">))</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="kd">defmethod </span><span class="nv">fun</span> <span class="mi">1</span> <span class="p">[</span><span class="nv">a</span><span class="p">]</span>
<span class="nv">...</span>  <span class="nv">a</span><span class="p">)</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="kd">defmethod </span><span class="nv">fun</span> <span class="mi">2</span> <span class="p">[</span><span class="nv">a</span> <span class="nv">b</span><span class="p">]</span>
<span class="nv">...</span>  <span class="p">(</span><span class="nb">+ </span><span class="nv">a</span> <span class="nv">b</span><span class="p">))</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">fun</span> <span class="mi">1</span><span class="p">)</span>
<span class="mi">1</span>

<span class="nv">=&gt;</span> <span class="p">(</span><span class="nf">fun</span> <span class="mi">1</span> <span class="mi">2</span><span class="p">)</span>
<span class="mi">3</span>
</pre></div>
</div>
</div>
</div>
<span id="document-contrib/profile"></span><div class="section" id="profile">
<h3>Profile<a class="headerlink" href="#profile" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.10.0.</span></p>
</div>
<p>The <code class="docutils literal"><span class="pre">profile</span></code> macros make it easier to find bottlenecks.</p>
<div class="section" id="macros">
<h4>Macros<a class="headerlink" href="#macros" title="Permalink to this headline">¶</a></h4>
<div class="section" id="profile-cpu">
<span id="profile-calls"></span><span id="id1"></span><h5>profile/calls<a class="headerlink" href="#profile-cpu" title="Permalink to this headline">¶</a></h5>
<p><code class="docutils literal"><span class="pre">profile/calls</span></code> allows you to create a call graph visualization.
<strong>Note:</strong> You must have <a class="reference external" href="http://www.graphviz.org/Home.php">Graphviz</a>
installed for this to work.</p>
<p>Usage: <cite>(profile/calls (body))</cite></p>
<p>Example:</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">(</span><span class="n">require</span> <span class="o">[</span><span class="n">hy</span><span class="o">.</span><span class="na">contrib</span><span class="o">.</span><span class="na">profile</span> <span class="o">[</span><span class="n">profile</span><span class="o">/</span><span class="n">calls</span><span class="o">]])</span>
<span class="o">(</span><span class="n">profile</span><span class="o">/</span><span class="n">calls</span> <span class="o">(</span><span class="nb">print</span> <span class="s">&quot;hey there&quot;</span><span class="o">))</span>
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h5>profile/cpu<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h5>
<p><code class="docutils literal"><span class="pre">profile/cpu</span></code> allows you to profile a bit of code.</p>
<p>Usage: <cite>(profile/cpu (body))</cite></p>
<p>Example:</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">(</span><span class="n">require</span> <span class="o">[</span><span class="n">hy</span><span class="o">.</span><span class="na">contrib</span><span class="o">.</span><span class="na">profile</span> <span class="o">[</span><span class="n">profile</span><span class="o">/</span><span class="n">cpu</span><span class="o">]])</span>
<span class="o">(</span><span class="n">profile</span><span class="o">/</span><span class="n">cpu</span> <span class="o">(</span><span class="nb">print</span> <span class="s">&quot;hey there&quot;</span><span class="o">))</span>
</pre></div>
</div>
<div class="highlight-bash"><div class="highlight"><pre><span></span>hey there
&lt;pstats.Stats instance at 0x14ff320&gt;
         <span class="m">2</span> <span class="k">function</span> calls in <span class="m">0</span>.000 seconds

 Random listing order was used

 ncalls  tottime  percall  cumtime  percall filename:lineno<span class="o">(</span><span class="k">function</span><span class="o">)</span>        <span class="m">1</span>    <span class="m">0</span>.000    <span class="m">0</span>.000    <span class="m">0</span>.000    <span class="m">0</span>.000 <span class="o">{</span>method <span class="s1">&#39;disable&#39;</span> of <span class="s1">&#39;_lsprof.Profiler&#39;</span> objects<span class="o">}</span>
     <span class="m">1</span>    <span class="m">0</span>.000    <span class="m">0</span>.000    <span class="m">0</span>.000    <span class="m">0</span>.000 <span class="o">{</span>print<span class="o">}</span>
</pre></div>
</div>
</div>
</div>
</div>
<span id="document-contrib/sequences"></span><div class="section" id="lazy-sequences">
<h3>Lazy sequences<a class="headerlink" href="#lazy-sequences" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.12.0.</span></p>
</div>
<p>The sequences module contains a few macros for declaring sequences that are
evaluated only as much as the client code requires. Unlike generators, they
allow accessing the same element multiple times. They cache calculated values,
and the implementation allows for recursive definition of sequences without
resulting in recursive computation.</p>
<p>To use these macros, you need to require them and import some other names like
so:</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span>(require [hy.contrib.sequences [defseq seq]])
(import [hy.contrib.sequences [Sequence end-sequence]])
</pre></div>
</div>
<p>The simplest sequence can be defined as <code class="docutils literal"><span class="pre">(seq</span> <span class="pre">[n]</span> <span class="pre">n)</span></code>. This defines a sequence
that starts as <code class="docutils literal"><span class="pre">[0</span> <span class="pre">1</span> <span class="pre">2</span> <span class="pre">3</span> <span class="pre">...]</span></code> and continues forever. In order to define a
finite sequence, you need to call <code class="docutils literal"><span class="pre">end-sequence</span></code> to signal the end of the
sequence:</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">(</span><span class="n">seq</span> <span class="o">[</span><span class="n">n</span><span class="o">]</span>
     <span class="s">&quot;sequence of 5 integers&quot;</span>
     <span class="o">(</span><span class="n">cond</span> <span class="o">[(&lt;</span> <span class="n">n</span> <span class="mi">5</span><span class="o">)</span> <span class="n">n</span><span class="o">]</span>
           <span class="o">[</span><span class="n">True</span> <span class="o">(</span><span class="n">end</span><span class="o">-</span><span class="n">sequence</span><span class="o">)]))</span>
</pre></div>
</div>
<p>This creates the following sequence: <code class="docutils literal"><span class="pre">[0</span> <span class="pre">1</span> <span class="pre">2</span> <span class="pre">3</span> <span class="pre">4]</span></code>. For such a sequence,
<code class="docutils literal"><span class="pre">len</span></code> returns the amount of items in the sequence and negative indexing is
supported. Because both of these require evaluating the whole sequence, calling
one on an infinite sequence would take forever (or at least until available
memory has been exhausted).</p>
<p>Sequences can be defined recursively. For example, the Fibonacci sequence could
be defined as:</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span><span class="o">(</span><span class="n">defseq</span> <span class="n">fibonacci</span> <span class="o">[</span><span class="n">n</span><span class="o">]</span>
  <span class="s">&quot;infinite sequence of fibonacci numbers&quot;</span>
  <span class="o">(</span><span class="n">cond</span> <span class="o">[(=</span> <span class="n">n</span> <span class="mi">0</span><span class="o">)</span> <span class="mi">0</span><span class="o">]</span>
        <span class="o">[(=</span> <span class="n">n</span> <span class="mi">1</span><span class="o">)</span> <span class="mi">1</span><span class="o">]</span>
        <span class="o">[</span><span class="n">True</span> <span class="o">(+</span> <span class="o">(</span><span class="n">get</span> <span class="n">fibonacci</span> <span class="o">(-</span> <span class="n">n</span> <span class="mi">1</span><span class="o">))</span>
                 <span class="o">(</span><span class="n">get</span> <span class="n">fibonacci</span> <span class="o">(-</span> <span class="n">n</span> <span class="mi">2</span><span class="o">)))]))</span>
</pre></div>
</div>
<p>This results in the sequence <code class="docutils literal"><span class="pre">[0</span> <span class="pre">1</span> <span class="pre">1</span> <span class="pre">2</span> <span class="pre">3</span> <span class="pre">5</span> <span class="pre">8</span> <span class="pre">13</span> <span class="pre">21</span> <span class="pre">34</span> <span class="pre">...]</span></code>.</p>
<div class="section" id="seq">
<span id="id1"></span><h4>seq<a class="headerlink" href="#seq" title="Permalink to this headline">¶</a></h4>
<p>Usage: <code class="docutils literal"><span class="pre">(seq</span> <span class="pre">[n]</span> <span class="pre">(*</span> <span class="pre">n</span> <span class="pre">n)</span></code></p>
<p>Creates a sequence defined in terms of <code class="docutils literal"><span class="pre">n</span></code>.</p>
</div>
<div class="section" id="defseq">
<span id="id2"></span><h4>defseq<a class="headerlink" href="#defseq" title="Permalink to this headline">¶</a></h4>
<p>Usage: <code class="docutils literal"><span class="pre">(defseq</span> <span class="pre">numbers</span> <span class="pre">[n]</span> <span class="pre">n)</span></code></p>
<p>Creates a sequence defined in terms of <code class="docutils literal"><span class="pre">n</span></code> and assigns it to a given name.</p>
</div>
<div class="section" id="end-sequence">
<span id="id3"></span><h4>end-sequence<a class="headerlink" href="#end-sequence" title="Permalink to this headline">¶</a></h4>
<p>Usage: <code class="docutils literal"><span class="pre">(seq</span> <span class="pre">[n]</span> <span class="pre">(if</span> <span class="pre">(&lt;</span> <span class="pre">n</span> <span class="pre">5)</span> <span class="pre">n</span> <span class="pre">(end-sequence)))</span></code></p>
<p>Signals the end of a sequence when an iterator reaches the given
point of the sequence. Internally, this is done by raising
<code class="docutils literal"><span class="pre">IndexError</span></code>, catching that in the iterator, and raising
<code class="docutils literal"><span class="pre">StopIteration</span></code>.</p>
</div>
</div>
<span id="document-contrib/walk"></span><div class="section" id="walk">
<h3>walk<a class="headerlink" href="#walk" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.11.0.</span></p>
</div>
<div class="section" id="functions">
<h4>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h4>
<div class="section" id="id1">
<span id="id2"></span><h5>walk<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h5>
<p>Usage: <cite>(walk inner outer form)</cite></p>
<p><code class="docutils literal"><span class="pre">walk</span></code> traverses <code class="docutils literal"><span class="pre">form</span></code>, an arbitrary data structure. Applies
<code class="docutils literal"><span class="pre">inner</span></code> to each element of form, building up a data structure of the
same type.  Applies <code class="docutils literal"><span class="pre">outer</span></code> to the result.</p>
<p>Example:</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span>=&gt; (import [hy.contrib.walk [walk]])
=&gt; (setv a &#39;(a b c d e f))
=&gt; (walk ord identity a)
(97 98 99 100 101 102)
=&gt; (walk ord first a)
97
</pre></div>
</div>
</div>
<div class="section" id="postwalk">
<h5>postwalk<a class="headerlink" href="#postwalk" title="Permalink to this headline">¶</a></h5>
<p id="id3">Usage: <cite>(postwalk f form)</cite></p>
<p>Performs depth-first, post-order traversal of <code class="docutils literal"><span class="pre">form</span></code>. Calls <code class="docutils literal"><span class="pre">f</span></code> on
each sub-form, uses <code class="docutils literal"><span class="pre">f</span></code> 's return value in place of the original.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span>=&gt; (import [hy.contrib.walk [postwalk]])
=&gt; (def trail &#39;([1 2 3] [4 [5 6 [7]]]))
=&gt; (defn walking [x]
     (print &quot;Walking:&quot; x)
     x )
=&gt; (postwalk walking trail)
Walking: 1
Walking: 2
Walking: 3
Walking: (1 2 3)
Walking: 4
Walking: 5
Walking: 6
Walking: 7
Walking: (7)
Walking: (5 6 [7])
Walking: (4 [5 6 [7]])
Walking: ([1 2 3] [4 [5 6 [7]]])
([1 2 3] [4 [5 6 [7]]])
</pre></div>
</div>
</div>
<div class="section" id="prewalk">
<h5>prewalk<a class="headerlink" href="#prewalk" title="Permalink to this headline">¶</a></h5>
<p id="id4">Usage: <cite>(prewalk f form)</cite></p>
<p>Performs depth-first, pre-order traversal of <code class="docutils literal"><span class="pre">form</span></code>. Calls <code class="docutils literal"><span class="pre">f</span></code> on
each sub-form, uses <code class="docutils literal"><span class="pre">f</span></code> 's return value in place of the original.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span>=&gt; (import [hy.contrib.walk [prewalk]])
=&gt; (def trail &#39;([1 2 3] [4 [5 6 [7]]]))
=&gt; (defn walking [x]
     (print &quot;Walking:&quot; x)
     x )
=&gt; (prewalk walking trail)
Walking: ([1 2 3] [4 [5 6 [7]]])
Walking: [1 2 3]
Walking: 1
Walking: 2
Walking: 3
Walking: [4 [5 6 [7]]]
Walking: 4
Walking: [5 6 [7]]
Walking: 5
Walking: 6
Walking: [7]
Walking: 7
([1 2 3] [4 [5 6 [7]]])
</pre></div>
</div>
</div>
</div>
</div>
<span id="document-contrib/hy_repr"></span><div class="section" id="hy-representations">
<h3>Hy representations<a class="headerlink" href="#hy-representations" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.13.0.</span></p>
</div>
<p><code class="docutils literal"><span class="pre">hy.contrib.hy-repr</span></code> is a module containing a single function.
To import it, say:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">(</span><span class="kn">import</span> <span class="p">[</span><span class="n">hy</span><span class="o">.</span><span class="n">contrib</span><span class="o">.</span><span class="n">hy</span><span class="o">-</span><span class="nb">repr</span> <span class="p">[</span><span class="n">hy</span><span class="o">-</span><span class="nb">repr</span><span class="p">]])</span>
</pre></div>
</div>
<p>To make the Hy REPL use it for output, invoke Hy like so:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ hy --repl-output-fn=hy.contrib.hy-repr.hy-repr
</pre></div>
</div>
<div class="section" id="hy-repr">
<span id="hy-repr-fn"></span><h4>hy-repr<a class="headerlink" href="#hy-repr" title="Permalink to this headline">¶</a></h4>
<p>Usage: <code class="docutils literal"><span class="pre">(hy-repr</span> <span class="pre">x)</span></code></p>
<p>This function is Hy's equivalent of Python's built-in <code class="docutils literal"><span class="pre">repr</span></code>.
It returns a string representing the input object in Hy syntax.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span>=&gt; (hy-repr [1 2 3])
&#39;[1 2 3]&#39;
=&gt; (repr [1 2 3])
&#39;[1, 2, 3]&#39;
</pre></div>
</div>
<p>If the input object has a method <code class="docutils literal"><span class="pre">__hy-repr__</span></code>, it will be called
instead of doing anything else.</p>
<div class="highlight-hy"><div class="highlight"><pre><span></span>=&gt; (defclass C [list] [__hy-repr__ (fn [self] &quot;cuddles&quot;)])
=&gt; (hy-repr (C))
&#39;cuddles&#39;
</pre></div>
</div>
<p>When <code class="docutils literal"><span class="pre">hy-repr</span></code> doesn't know how to handle its input, it falls back
on <code class="docutils literal"><span class="pre">repr</span></code>.</p>
<p>Like <code class="docutils literal"><span class="pre">repr</span></code> in Python, <code class="docutils literal"><span class="pre">hy-repr</span></code> can round-trip many kinds of
values. Round-tripping implies that given an object <code class="docutils literal"><span class="pre">x</span></code>,
<code class="docutils literal"><span class="pre">(eval</span> <span class="pre">(read-str</span> <span class="pre">(hy-repr</span> <span class="pre">x)))</span></code> returns <code class="docutils literal"><span class="pre">x</span></code>, or at least a value
that's equal to <code class="docutils literal"><span class="pre">x</span></code>.</p>
</div>
</div>
</div>
</div>
<span id="document-hacking"></span><div class="section" id="hacking-on-hy">
<h2>Hacking on Hy<a class="headerlink" href="#hacking-on-hy" title="Permalink to this headline">¶</a></h2>
<div class="section" id="join-our-hyve">
<h3>Join our Hyve!<a class="headerlink" href="#join-our-hyve" title="Permalink to this headline">¶</a></h3>
<p>Please come hack on Hy!</p>
<p>Please come hang out with us on <code class="docutils literal"><span class="pre">#hy</span></code> on <code class="docutils literal"><span class="pre">irc.freenode.net</span></code>!</p>
<p>Please talk about it on Twitter with the <code class="docutils literal"><span class="pre">#hy</span></code> hashtag!</p>
<p>Please blog about it!</p>
<p>Please don't spraypaint it on your neighbor's fence (without asking nicely)!</p>
</div>
<div class="section" id="hack">
<h3>Hack!<a class="headerlink" href="#hack" title="Permalink to this headline">¶</a></h3>
<p>Do this:</p>
<ol class="arabic">
<li><p class="first">Create a <a class="reference external" href="https://pypi.python.org/pypi/virtualenv">virtual environment</a>:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ virtualenv venv
</pre></div>
</div>
<p>and activate it:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ . venv/bin/activate
</pre></div>
</div>
<p>or use <a class="reference external" href="https://virtualenvwrapper.readthedocs.io/en/latest/#introduction">virtualenvwrapper</a>
to create and manage your virtual environment:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ mkvirtualenv hy
$ workon hy
</pre></div>
</div>
</li>
<li><p class="first">Get the source code:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ git clone https://github.com/hylang/hy.git
</pre></div>
</div>
<p>or use your fork:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ git clone git@github.com:&lt;YOUR_USERNAME&gt;/hy.git
</pre></div>
</div>
</li>
<li><p class="first">Install for hacking:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> hy/
$ pip install -e .
</pre></div>
</div>
</li>
<li><p class="first">Install other develop-y requirements:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ pip install -r requirements-dev.txt
</pre></div>
</div>
</li>
<li><p class="first">Do awesome things; make someone shriek in delight/disgust at what
you have wrought.</p>
</li>
</ol>
</div>
<div class="section" id="test">
<h3>Test!<a class="headerlink" href="#test" title="Permalink to this headline">¶</a></h3>
<p>Tests are located in <code class="docutils literal"><span class="pre">tests/</span></code>. We use <a class="reference external" href="http://pytest.org">pytest</a>.</p>
<p>To run the tests:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ pytest
</pre></div>
</div>
<p>Write tests---tests are good!</p>
<p>Also, it is good to run the tests for all the platforms supported and for
PEP 8 compliant code. You can do so by running tox:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ tox
</pre></div>
</div>
</div>
<div class="section" id="document">
<h3>Document!<a class="headerlink" href="#document" title="Permalink to this headline">¶</a></h3>
<p>Documentation is located in <code class="docutils literal"><span class="pre">docs/</span></code>. We use <a class="reference external" href="http://sphinx-doc.org/">Sphinx</a>.</p>
<p>To build the docs in HTML:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> docs
$ make html
</pre></div>
</div>
<p>Write docs---docs are good! Even this doc!</p>
</div>
<div class="section" id="contributor-guidelines">
<h3>Contributor Guidelines<a class="headerlink" href="#contributor-guidelines" title="Permalink to this headline">¶</a></h3>
<p>Contributions are welcome and greatly appreciated. Every little bit
helps in making Hy better. Potential contributions include:</p>
<ul class="simple">
<li>Reporting and fixing bugs.</li>
<li>Requesting features.</li>
<li>Adding features.</li>
<li>Writing tests for outstanding bugs or untested features.
- You can mark tests that Hy can't pass yet as <a class="reference external" href="https://docs.pytest.org/en/latest/skipping.html#mark-a-test-function-as-expected-to-fail">xfail</a>.</li>
<li>Cleaning up the code.</li>
<li>Improving the documentation.</li>
<li>Answering questions on <a class="reference external" href="irc://freenode.net/hy">the IRC channel</a>, <a class="reference external" href="https://groups.google.com/forum/#!forum/hylang-discuss">the mailing list</a>, or
<a class="reference external" href="https://stackoverflow.com/questions/tagged/hy">Stack Overflow</a>.</li>
<li>Evangelizing for Hy in your organization, user group, conference, or
bus stop.</li>
</ul>
<div class="section" id="issues">
<h4>Issues<a class="headerlink" href="#issues" title="Permalink to this headline">¶</a></h4>
<p>In order to report bugs or request features, search the <a class="reference external" href="https://github.com/hylang/hy/issues">issue tracker</a> to
check for a duplicate. (If you're reporting a bug, make sure you can
reproduce it with the very latest, bleeding-edge version of Hy from
the <code class="docutils literal"><span class="pre">master</span></code> branch on GitHub. Bugs in stable versions of Hy are
fixed on <code class="docutils literal"><span class="pre">master</span></code> before the fix makes it into a new stable
release.) If there aren't any duplicates, then you can make a new issue.</p>
<p>It's totally acceptable to create an issue when you're unsure whether
something is a bug or not. We'll help you figure it out.</p>
<p>Use the same issue tracker to report problems with the documentation.</p>
</div>
<div class="section" id="pull-requests">
<h4>Pull requests<a class="headerlink" href="#pull-requests" title="Permalink to this headline">¶</a></h4>
<p>Submit proposed changes to the code or documentation as pull requests
(PRs) on <a class="reference external" href="https://github.com/hylang/hy">GitHub</a>. Git can be intimidating and confusing to the
uninitiated. <a class="reference external" href="http://rogerdudler.github.io/git-guide/">This getting-started guide</a> may be helpful. However, if
you're overwhelmed by Git, GitHub, or the rules below, don't sweat
it. We want to keep the barrier to contribution low, so we're happy to
help you with these finicky things or do them for you if necessary.</p>
<div class="section" id="deciding-what-to-do">
<h5>Deciding what to do<a class="headerlink" href="#deciding-what-to-do" title="Permalink to this headline">¶</a></h5>
<p>Issues tagged <a class="reference external" href="https://github.com/hylang/hy/issues?q=is%3Aissue+is%3Aopen+label%3Agood-first-bug">good-first-bug</a> are expected to be relatively easy to
fix, so they may be good targets for your first PR for Hy.</p>
<p>If you're proposing a major change to the Hy language, or you're
unsure of the proposed change, create an issue to discuss it before
you write any code. This will allow others to give feedback on your
idea, and it can avoid wasted work.</p>
</div>
<div class="section" id="file-headers">
<h5>File headers<a class="headerlink" href="#file-headers" title="Permalink to this headline">¶</a></h5>
<p>Every Python or Hy file in the source tree that is potentially
copyrightable should have the following header (but with <code class="docutils literal"><span class="pre">;;</span></code> in
place of <code class="docutils literal"><span class="pre">#</span></code> for Hy files):</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="c1"># Copyright [current year] the authors.</span>
<span class="c1"># This file is part of Hy, which is free software licensed under the Expat</span>
<span class="c1"># license. See the LICENSE.</span>
</pre></div>
</div>
<p>As a rule of thumb, a file can be considered potentially copyrightable
if it includes at least 10 lines that contain something other than
comments or whitespace. If in doubt, include the header.</p>
</div>
<div class="section" id="commit-formatting">
<h5>Commit formatting<a class="headerlink" href="#commit-formatting" title="Permalink to this headline">¶</a></h5>
<p>Many PRs are small enough that only one commit is necessary, but
bigger ones should be organized into logical units as separate
commits. PRs should be free of merge commits and commits that fix or
revert other commits in the same PR (<code class="docutils literal"><span class="pre">git</span> <span class="pre">rebase</span></code> is your friend).</p>
<p>Avoid committing spurious whitespace changes.</p>
<p>The first line of a commit message should describe the overall change in 50
characters or less. If you wish to add more information, separate it from the
first line with a blank line.</p>
</div>
<div class="section" id="testing">
<h5>Testing<a class="headerlink" href="#testing" title="Permalink to this headline">¶</a></h5>
<p>New features and bug fixes should be tested. If you've caused an
<a class="reference external" href="https://docs.pytest.org/en/latest/skipping.html#mark-a-test-function-as-expected-to-fail">xfail</a> test to start passing, remove the xfail mark. If you're
testing a bug that has a GitHub issue, include a comment with the URL
of the issue.</p>
<p>No PR may be merged if it causes any tests to fail. You can run the
test suite and check the style of your code with <code class="docutils literal"><span class="pre">make</span> <span class="pre">d</span></code>. The byte-compiled
versions of the test files can be purged using <code class="docutils literal"><span class="pre">git</span> <span class="pre">clean</span> <span class="pre">-dfx</span> <span class="pre">tests/</span></code>.
If you want to run the tests while skipping the slow ones in <code class="docutils literal"><span class="pre">test_bin.py</span></code>,
use <code class="docutils literal"><span class="pre">pytest</span> <span class="pre">--ignore=tests/test_bin.py</span></code>.</p>
</div>
<div class="section" id="news-and-authors">
<h5>NEWS and AUTHORS<a class="headerlink" href="#news-and-authors" title="Permalink to this headline">¶</a></h5>
<p>If you're making user-visible changes to the code, add one or more
items describing it to the NEWS file.</p>
<p>Finally, add yourself to the AUTHORS file (as a separate commit): you
deserve it. :)</p>
</div>
<div class="section" id="the-pr-itself">
<h5>The PR itself<a class="headerlink" href="#the-pr-itself" title="Permalink to this headline">¶</a></h5>
<p>PRs should ask to merge a new branch that you created for the PR into
hylang/hy's <code class="docutils literal"><span class="pre">master</span></code> branch, and they should have as their origin
the most recent commit possible.</p>
<p>If the PR fulfills one or more issues, then the body text of the PR
(or the commit message for any of its commits) should say &quot;Fixes
#123&quot; or &quot;Closes #123&quot; for each affected issue number. Use this exact
(case-insensitive) wording, because when a PR containing such text is
merged, GitHub automatically closes the mentioned issues, which is
handy. Conversely, avoid this exact language if you want to mention
an issue without closing it (because e.g. you've partly but not
entirely fixed a bug).</p>
<p>Before any PR is merged, it must be approved by members of Hy's core team
other than the PR's author. Changes to the documentation, or trivial changes
to code, need to be approved by <strong>one</strong> member; all other PRs need to be
approved by <strong>two</strong> members.</p>
<p>Anybody on the team may perform the merge. Merging should create a merge commit
(don't squash unnecessarily, because that would remove separation between
logically separate commits, and don't fast-forward, because that would throw
away the history of the commits as a separate branch), which should
include the PR number in the commit message.</p>
</div>
</div>
</div>
<div class="section" id="contributor-code-of-conduct">
<h3>Contributor Code of Conduct<a class="headerlink" href="#contributor-code-of-conduct" title="Permalink to this headline">¶</a></h3>
<p>As contributors and maintainers of this project, we pledge to respect
all people who contribute through reporting issues, posting feature
requests, updating documentation, submitting pull requests or patches,
and other activities.</p>
<p>We are committed to making participation in this project a
harassment-free experience for everyone, regardless of level of
experience, gender, gender identity and expression, sexual
orientation, disability, personal appearance, body size, race,
ethnicity, age, or religion.</p>
<p>Examples of unacceptable behavior by participants include the use of
sexual language or imagery, derogatory comments or personal attacks,
trolling, public or private harassment, insults, or other
unprofessional conduct.</p>
<p>Project maintainers have the right and responsibility to remove, edit,
or reject comments, commits, code, wiki edits, issues, and other
contributions that are not aligned to this Code of Conduct. Project
maintainers who do not follow the Code of Conduct may be removed from
the project team.</p>
<p>This code of conduct applies both within project spaces and in public
spaces when an individual is representing the project or its
community.</p>
<p>Instances of abusive, harassing, or otherwise unacceptable behavior
may be reported by opening an issue or contacting one or more of the
project maintainers.</p>
<p>This Code of Conduct is adapted from the <a class="reference external" href="http://contributor-covenant.org">Contributor Covenant</a>,
version 1.1.0, available at
<a class="reference external" href="http://contributor-covenant.org/version/1/1/0/">http://contributor-covenant.org/version/1/1/0/</a>.</p>
</div>
<div class="section" id="core-team">
<h3>Core Team<a class="headerlink" href="#core-team" title="Permalink to this headline">¶</a></h3>
<p>The core development team of Hy consists of following developers:</p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/jd">Julien Danjou</a></li>
<li><a class="reference external" href="https://github.com/Foxboron">Morten Linderud</a></li>
<li><a class="reference external" href="https://github.com/agentultra">J Kenneth King</a></li>
<li><a class="reference external" href="https://github.com/algernon">Gergely Nagy</a></li>
<li><a class="reference external" href="https://github.com/tuturto">Tuukka Turto</a></li>
<li><a class="reference external" href="https://github.com/aldeka">Karen Rustad</a></li>
<li><a class="reference external" href="https://github.com/theanalyst">Abhishek L</a></li>
<li><a class="reference external" href="https://github.com/cwebber">Christopher Allan Webber</a></li>
<li><a class="reference external" href="https://github.com/khinsen">Konrad Hinsen</a></li>
<li><a class="reference external" href="https://github.com/willkg">Will Kahn-Greene</a></li>
<li><a class="reference external" href="https://github.com/paultag">Paul Tagliamonte</a></li>
<li><a class="reference external" href="https://github.com/olasd">Nicolas Dandrimont</a></li>
<li><a class="reference external" href="https://github.com/berkerpeksag">Berker Peksag</a></li>
<li><a class="reference external" href="https://github.com/cndreisbach">Clinton N. Dreisbach</a></li>
<li><a class="reference external" href="https://github.com/microamp">han semaj</a></li>
<li><a class="reference external" href="https://github.com/zackmdavis">Zack M. Davis</a></li>
<li><a class="reference external" href="https://github.com/Kodiologist">Kodi Arfer</a></li>
</ul>
</div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017 the authors.
      
        <span class="commit">
          Revision <code>49fd49e7</code>.
        </span>
      

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Read the Docs</span>
      v: stable
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Versions</dt>
        
          <dd><a href="/en/latest/">latest</a></dd>
        
          <dd><a href="/en/stable/">stable</a></dd>
        
          <dd><a href="/en/master/">master</a></dd>
        
      </dl>
      <dl>
        <dt>Downloads</dt>
        
          <dd><a href="//readthedocs.org/projects/hy/downloads/htmlzip/stable/">htmlzip</a></dd>
        
      </dl>
      <dl>
        <dt>On Read the Docs</dt>
          <dd>
            <a href="//readthedocs.org/projects/hy/?fromdocs=hy">Project Home</a>
          </dd>
          <dd>
            <a href="//readthedocs.org/builds/hy/?fromdocs=hy">Builds</a>
          </dd>
      </dl>
      <hr/>
      Free document hosting provided by <a href="http://www.readthedocs.org">Read the Docs</a>.

    </div>
  </div>



  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.13.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>